(define (read-file input-port)
  (let ((a (read input-port)))
    (if (eof-object? a)
	'()
	(cons a (read-file input-port)))))

(define input-port (open-input-file input-file-name))
(define file (read-file input-port))
(close-input-port input-port)

(define program (cons 'begin file))
(define compiled-program (compile program 'val 'next))

(define output-port (open-output-file output-file-name))
(display "; Generated by the compiler" output-port)
(newline output-port)

(write compiled-program output-port)
(close-output-port output-port)
(exit)
