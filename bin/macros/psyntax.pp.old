;;; psyntax.pp
;;; automatically generated from psyntax.ss
;;; Tue Jun 4 08:23:04 EST 2002
;;; see copyright notice in psyntax.ss

((lambda ()
   (letrec ((noexpand62 '"noexpand")
            (annotation?126 (lambda (x901) '#f))
            (top-level-eval-hook127
             (lambda (x1942) (eval (list noexpand62 x1942))))
            (local-eval-hook128
             (lambda (x902) (eval (list noexpand62 x902))))
            (error-hook129
             (lambda (who1941 why1939 what1940)
               (error who1941 '"~a ~s" why1939 what1940)))
            (put-global-definition-hook134
             (lambda (symbol904 val903) ($sc-put-cte symbol904 val903)))
            (get-global-definition-hook135
             (lambda (symbol1938) (getprop symbol1938 '*sc-expander*)))
            (get-import-binding136
             (lambda (symbol906 token905) (getprop symbol906 token905)))
            (generate-id137
             ((lambda (digits1924)
                ((lambda (base1926 session-key1925)
                   (letrec ((make-digit1927
                             (lambda (x1937)
                               (string-ref digits1924 x1937)))
                            (fmt1928
                             (lambda (n1931)
                               ((letrec ((fmt1932
                                          (lambda (n1934 a1933)
                                            (if (< n1934 base1926)
                                                (list->string
                                                  (cons (make-digit1927
                                                          n1934)
                                                        a1933))
                                                ((lambda (r1936 rest1935)
                                                   (fmt1932
                                                     rest1935
                                                     (cons (make-digit1927
                                                             r1936)
                                                           a1933)))
                                                 (modulo n1934 base1926)
                                                 (quotient
                                                   n1934
                                                   base1926))))))
                                  fmt1932)
                                n1931
                                '()))))
                     ((lambda (n1929)
                        (lambda (name1930)
                          (begin (set! n1929 (+ n1929 '1))
                                 (string->symbol
                                   (string-append
                                     session-key1925
                                     (fmt1928 n1929))))))
                      '-1)))
                 (string-length digits1924)
                 '"_"))
              '"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!$%&*/:<=>?~_^.+-"))
            (build-sequence236
             (lambda (src908 exps907)
               (if (null? (cdr exps907))
                   (car exps907)
                   (cons 'begin exps907))))
            (build-letrec237
             (lambda (src1923 vars1920 val-exps1922 body-exp1921)
               (if (null? vars1920)
                   body-exp1921
                   (list 'letrec
                         (map list vars1920 val-exps1922)
                         body-exp1921))))
            (build-body238
             (lambda (src912 vars909 val-exps911 body-exp910)
               (build-letrec237 src912 vars909 val-exps911 body-exp910)))
            (make-syntax-object250
             (lambda (expression1919 wrap1918)
               (vector 'syntax-object expression1919 wrap1918)))
            (syntax-object?251
             (lambda (x913)
               (if (vector? x913)
                   (if (= (vector-length x913) '3)
                       (eq? (vector-ref x913 '0) 'syntax-object)
                       '#f)
                   '#f)))
            (syntax-object-expression252
             (lambda (x1917) (vector-ref x1917 '1)))
            (syntax-object-wrap253 (lambda (x914) (vector-ref x914 '2)))
            (set-syntax-object-expression!254
             (lambda (x1916 update1915)
               (vector-set! x1916 '1 update1915)))
            (set-syntax-object-wrap!255
             (lambda (x916 update915) (vector-set! x916 '2 update915)))
            (source-annotation270
             (lambda (x1914)
               (if (annotation?126 x1914)
                   (annotation-source x1914)
                   (if (syntax-object?251 x1914)
                       (source-annotation270
                         (syntax-object-expression252 x1914))
                       '#f))))
            (make-binding278 (lambda (x918 y917) (cons x918 y917)))
            (binding-type279 car)
            (binding-value280 cdr)
            (set-binding-type!281 set-car!)
            (set-binding-value!282 set-cdr!)
            (binding?283
             (lambda (x1913)
               (if (pair? x1913) (symbol? (car x1913)) '#f)))
            (extend-env293
             (lambda (label921 binding919 r920)
               (cons (cons label921 binding919) r920)))
            (extend-env*294
             (lambda (labels1912 bindings1910 r1911)
               (if (null? labels1912)
                   r1911
                   (extend-env*294
                     (cdr labels1912)
                     (cdr bindings1910)
                     (extend-env293
                       (car labels1912)
                       (car bindings1910)
                       r1911)))))
            (extend-var-env*295
             (lambda (labels924 vars922 r923)
               (if (null? labels924)
                   r923
                   (extend-var-env*295
                     (cdr labels924)
                     (cdr vars922)
                     (extend-env293
                       (car labels924)
                       (make-binding278 'lexical (car vars922))
                       r923)))))
            (transformer-env296
             (lambda (r1908)
               (if (null? r1908)
                   '()
                   ((lambda (a1909)
                      (if (eq? (cadr a1909) 'lexical)
                          (transformer-env296 (cdr r1908))
                          (cons a1909 (transformer-env296 (cdr r1908)))))
                    (car r1908)))))
            (displaced-lexical-error297
             (lambda (id925)
               (syntax-error
                 id925
                 (if (id-var-name396 id925 '(()))
                     '"identifier out of context"
                     '"identifier not visible"))))
            (lookup*298
             (lambda (x1905 r1904)
               ((lambda (t1906)
                  (if t1906
                      (cdr t1906)
                      (if (symbol? x1905)
                          ((lambda (t1907)
                             (if t1907
                                 t1907
                                 (make-binding278 'global x1905)))
                           (get-global-definition-hook135 x1905))
                          (make-binding278 'displaced-lexical '#f))))
                (assq x1905 r1904))))
            (sanitize-binding299
             (lambda (b926)
               (if (procedure? b926)
                   (make-binding278 'macro b926)
                   (if (binding?283 b926)
                       ((lambda (t927)
                          (if (memv t927 '(core macro macro!))
                              (if (procedure? (binding-value280 b926))
                                  b926
                                  '#f)
                              (if (memv t927 '(module))
                                  (if (interface?414
                                        (binding-value280 b926))
                                      b926
                                      '#f)
                                  b926)))
                        (binding-type279 b926))
                       '#f))))
            (lookup300
             (lambda (x1895 r1894)
               (letrec ((whack-binding!1896
                         (lambda (b1903 *b1902)
                           (begin (set-binding-type!281
                                    b1903
                                    (binding-type279 *b1902))
                                  (set-binding-value!282
                                    b1903
                                    (binding-value280 *b1902))))))
                 ((lambda (b1897)
                    ((lambda (t1898)
                       (if (memv t1898 '(deferred))
                           (begin (whack-binding!1896
                                    b1897
                                    ((lambda (*b1899)
                                       ((lambda (t1900)
                                          (if t1900
                                              t1900
                                              (syntax-error
                                                *b1899
                                                '"invalid transformer")))
                                        (sanitize-binding299 *b1899)))
                                     (local-eval-hook128
                                       (binding-value280 b1897))))
                                  ((lambda (t1901) b1897)
                                   (binding-type279 b1897)))
                           b1897))
                     (binding-type279 b1897)))
                  (lookup*298 x1895 r1894)))))
            (global-extend301
             (lambda (type930 sym928 val929)
               (put-global-definition-hook134
                 sym928
                 (make-binding278 type930 val929))))
            (nonsymbol-id?302
             (lambda (x1892)
               (if (syntax-object?251 x1892)
                   (symbol?
                     ((lambda (e1893)
                        (if (annotation?126 e1893)
                            (annotation-expression e1893)
                            e1893))
                      (syntax-object-expression252 x1892)))
                   '#f)))
            (id?303
             (lambda (x931)
               (if (symbol? x931)
                   '#t
                   (if (syntax-object?251 x931)
                       (symbol?
                         ((lambda (e932)
                            (if (annotation?126 e932)
                                (annotation-expression e932)
                                e932))
                          (syntax-object-expression252 x931)))
                       (if (annotation?126 x931)
                           (symbol? (annotation-expression x931))
                           '#f)))))
            (id-sym-name&marks309
             (lambda (x1889 w1888)
               (if (syntax-object?251 x1889)
                   (values
                     ((lambda (e1890)
                        (if (annotation?126 e1890)
                            (annotation-expression e1890)
                            e1890))
                      (syntax-object-expression252 x1889))
                     (join-marks391
                       (wrap-marks311 w1888)
                       (wrap-marks311 (syntax-object-wrap253 x1889))))
                   (values
                     ((lambda (e1891)
                        (if (annotation?126 e1891)
                            (annotation-expression e1891)
                            e1891))
                      x1889)
                     (wrap-marks311 w1888)))))
            (make-wrap310 cons)
            (wrap-marks311 car)
            (wrap-subst312 cdr)
            (set-indirect-label!347
             (lambda (x1887 v1886)
               (set-indirect-label-label!344 x1887 v1886)))
            (get-indirect-label346
             (lambda (x933) (indirect-label-label343 x933)))
            (gen-indirect-label345
             (lambda () (make-indirect-label341 (gen-label348))))
            (set-indirect-label-label!344
             (lambda (x935 update934) (vector-set! x935 '1 update934)))
            (indirect-label-label343
             (lambda (x1885) (vector-ref x1885 '1)))
            (indirect-label?342
             (lambda (x936)
               (if (vector? x936)
                   (if (= (vector-length x936) '2)
                       (eq? (vector-ref x936 '0) 'indirect-label)
                       '#f)
                   '#f)))
            (make-indirect-label341
             (lambda (label1884) (vector 'indirect-label label1884)))
            (gen-label348 (lambda () (string '#\i)))
            (label?349
             (lambda (x1881)
               ((lambda (t1882)
                  (if t1882
                      t1882
                      ((lambda (t1883)
                         (if t1883 t1883 (indirect-label?342 x1881)))
                       (symbol? x1881))))
                (string? x1881))))
            (gen-labels350
             (lambda (ls937)
               (if (null? ls937)
                   '()
                   (cons (gen-label348) (gen-labels350 (cdr ls937))))))
            (make-ribcage351
             (lambda (symnames1880 marks1878 labels1879)
               (vector 'ribcage symnames1880 marks1878 labels1879)))
            (ribcage?352
             (lambda (x938)
               (if (vector? x938)
                   (if (= (vector-length x938) '4)
                       (eq? (vector-ref x938 '0) 'ribcage)
                       '#f)
                   '#f)))
            (ribcage-symnames353 (lambda (x1877) (vector-ref x1877 '1)))
            (ribcage-marks354 (lambda (x939) (vector-ref x939 '2)))
            (ribcage-labels355 (lambda (x1876) (vector-ref x1876 '3)))
            (set-ribcage-symnames!356
             (lambda (x941 update940) (vector-set! x941 '1 update940)))
            (set-ribcage-marks!357
             (lambda (x1875 update1874)
               (vector-set! x1875 '2 update1874)))
            (set-ribcage-labels!358
             (lambda (x943 update942) (vector-set! x943 '3 update942)))
            (anti-mark368
             (lambda (w1873)
               (make-wrap310
                 (cons '#f (wrap-marks311 w1873))
                 (cons 'shift (wrap-subst312 w1873)))))
            (barrier-marker373 '#f)
            (make-import-token374
             (lambda (key1872) (vector 'import-token key1872)))
            (import-token?375
             (lambda (x944)
               (if (vector? x944)
                   (if (= (vector-length x944) '2)
                       (eq? (vector-ref x944 '0) 'import-token)
                       '#f)
                   '#f)))
            (import-token-key376 (lambda (x1871) (vector-ref x1871 '1)))
            (set-import-token-key!377
             (lambda (x946 update945) (vector-set! x946 '1 update945)))
            (extend-ribcage!382
             (lambda (ribcage1869 id1867 label1868)
               (begin (set-ribcage-symnames!356
                        ribcage1869
                        (cons ((lambda (e1870)
                                 (if (annotation?126 e1870)
                                     (annotation-expression e1870)
                                     e1870))
                               (syntax-object-expression252 id1867))
                              (ribcage-symnames353 ribcage1869)))
                      (set-ribcage-marks!357
                        ribcage1869
                        (cons (wrap-marks311
                                (syntax-object-wrap253 id1867))
                              (ribcage-marks354 ribcage1869)))
                      (set-ribcage-labels!358
                        ribcage1869
                        (cons label1868
                              (ribcage-labels355 ribcage1869))))))
            (extend-ribcage-barrier!383
             (lambda (ribcage948 killer-id947)
               (extend-ribcage-barrier-help!384
                 ribcage948
                 (syntax-object-wrap253 killer-id947))))
            (extend-ribcage-barrier-help!384
             (lambda (ribcage1866 wrap1865)
               (begin (set-ribcage-symnames!356
                        ribcage1866
                        (cons barrier-marker373
                              (ribcage-symnames353 ribcage1866)))
                      (set-ribcage-marks!357
                        ribcage1866
                        (cons (wrap-marks311 wrap1865)
                              (ribcage-marks354 ribcage1866))))))
            (extend-ribcage-subst!385
             (lambda (ribcage950 token949)
               (set-ribcage-symnames!356
                 ribcage950
                 (cons (make-import-token374 token949)
                       (ribcage-symnames353 ribcage950)))))
            (lookup-import-binding-name386
             (lambda (sym1860 key1858 marks1859)
               ((lambda (new1861)
                  (if new1861
                      ((letrec ((f1862
                                 (lambda (new1863)
                                   (if (pair? new1863)
                                       ((lambda (t1864)
                                          (if t1864
                                              t1864
                                              (f1862 (cdr new1863))))
                                        (f1862 (car new1863)))
                                       (if (symbol? new1863)
                                           (if (same-marks?392
                                                 marks1859
                                                 (wrap-marks311 '((top))))
                                               new1863
                                               '#f)
                                           (if (same-marks?392
                                                 marks1859
                                                 (wrap-marks311
                                                   (syntax-object-wrap253
                                                     new1863)))
                                               new1863
                                               '#f))))))
                         f1862)
                       new1861)
                      '#f))
                (get-import-binding136 sym1860 key1858))))
            (make-binding-wrap387
             (lambda (ids953 labels951 w952)
               (if (null? ids953)
                   w952
                   (make-wrap310
                     (wrap-marks311 w952)
                     (cons ((lambda (labelvec954)
                              ((lambda (n955)
                                 ((lambda (symnamevec957 marksvec956)
                                    (begin ((letrec ((f958
                                                      (lambda (ids960 i959)
                                                        (if (not (null?
                                                                   ids960))
                                                            (call-with-values
                                                              (lambda ()
                                                                (id-sym-name&marks309
                                                                  (car ids960)
                                                                  w952))
                                                              (lambda (symname962
                                                                       marks961)
                                                                (begin (vector-set!
                                                                         symnamevec957
                                                                         i959
                                                                         symname962)
                                                                       (vector-set!
                                                                         marksvec956
                                                                         i959
                                                                         marks961)
                                                                       (f958 (cdr ids960)
                                                                             (+ i959
                                                                                '1)))))
                                                            (void)))))
                                              f958)
                                            ids953
                                            '0)
                                           (make-ribcage351
                                             symnamevec957
                                             marksvec956
                                             labelvec954)))
                                  (make-vector n955)
                                  (make-vector n955)))
                               (vector-length labelvec954)))
                            (list->vector labels951))
                           (wrap-subst312 w952))))))
            (make-trimmed-syntax-object388
             (lambda (id1852)
               (call-with-values
                 (lambda () (id-var-name&marks394 id1852 '(())))
                 (lambda (tosym1854 marks1853)
                   (begin (if (not tosym1854)
                              (syntax-error
                                id1852
                                '"identifier not visible for export")
                              (void))
                          ((lambda (fromsym1855)
                             (make-syntax-object250
                               fromsym1855
                               (make-wrap310
                                 marks1853
                                 (list (make-ribcage351
                                         (vector fromsym1855)
                                         (vector marks1853)
                                         (vector tosym1854))))))
                           ((lambda (x1856)
                              ((lambda (e1857)
                                 (if (annotation?126 e1857)
                                     (annotation-expression e1857)
                                     e1857))
                               (if (syntax-object?251 x1856)
                                   (syntax-object-expression252 x1856)
                                   x1856)))
                            id1852)))))))
            (smart-append389
             (lambda (m1964 m2963)
               (if (null? m2963) m1964 (append m1964 m2963))))
            (join-wraps390
             (lambda (w11849 w21848)
               ((lambda (m11851 s11850)
                  (if (null? m11851)
                      (if (null? s11850)
                          w21848
                          (make-wrap310
                            (wrap-marks311 w21848)
                            (smart-append389
                              s11850
                              (wrap-subst312 w21848))))
                      (make-wrap310
                        (smart-append389 m11851 (wrap-marks311 w21848))
                        (smart-append389 s11850 (wrap-subst312 w21848)))))
                (wrap-marks311 w11849)
                (wrap-subst312 w11849))))
            (join-marks391
             (lambda (m1966 m2965) (smart-append389 m1966 m2965)))
            (same-marks?392
             (lambda (x1846 y1845)
               ((lambda (t1847)
                  (if t1847
                      t1847
                      (if (not (null? x1846))
                          (if (not (null? y1845))
                              (if (eq? (car x1846) (car y1845))
                                  (same-marks?392 (cdr x1846) (cdr y1845))
                                  '#f)
                              '#f)
                          '#f)))
                (eq? x1846 y1845))))
            (id-var-name-loc&marks393
             (lambda (id968 w967)
               (letrec ((search969
                         (lambda (sym999 subst997 marks998)
                           (if (null? subst997)
                               (values sym999 marks998)
                               ((lambda (fst1000)
                                  (if (eq? fst1000 'shift)
                                      (search969
                                        sym999
                                        (cdr subst997)
                                        (cdr marks998))
                                      ((lambda (symnames1001)
                                         (if (vector? symnames1001)
                                             (search-vector-rib971
                                               sym999
                                               subst997
                                               marks998
                                               symnames1001
                                               fst1000)
                                             (search-list-rib970
                                               sym999
                                               subst997
                                               marks998
                                               symnames1001
                                               fst1000)))
                                       (ribcage-symnames353 fst1000))))
                                (car subst997)))))
                        (search-list-rib970
                         (lambda (sym983
                                  subst979
                                  marks982
                                  symnames980
                                  ribcage981)
                           ((letrec ((f984
                                      (lambda (symnames986 i985)
                                        (if (null? symnames986)
                                            (search969
                                              sym983
                                              (cdr subst979)
                                              marks982)
                                            (if (if (eq? (car symnames986)
                                                         sym983)
                                                    (same-marks?392
                                                      marks982
                                                      (list-ref
                                                        (ribcage-marks354
                                                          ribcage981)
                                                        i985))
                                                    '#f)
                                                (values
                                                  (list-ref
                                                    (ribcage-labels355
                                                      ribcage981)
                                                    i985)
                                                  marks982)
                                                (if (import-token?375
                                                      (car symnames986))
                                                    ((lambda (t987)
                                                       (if t987
                                                           ((lambda (id988)
                                                              (if (symbol?
                                                                    id988)
                                                                  (values
                                                                    id988
                                                                    marks982)
                                                                  (id-var-name&marks394
                                                                    id988
                                                                    '(()))))
                                                            t987)
                                                           (f984 (cdr symnames986)
                                                                 i985)))
                                                     (lookup-import-binding-name386
                                                       sym983
                                                       (import-token-key376
                                                         (car symnames986))
                                                       marks982))
                                                    (if (if (eq? (car symnames986)
                                                                 barrier-marker373)
                                                            (same-marks?392
                                                              marks982
                                                              (list-ref
                                                                (ribcage-marks354
                                                                  ribcage981)
                                                                i985))
                                                            '#f)
                                                        (values
                                                          '#f
                                                          marks982)
                                                        (f984 (cdr symnames986)
                                                              (+ i985
                                                                 '1)))))))))
                              f984)
                            symnames980
                            '0)))
                        (search-vector-rib971
                         (lambda (sym993
                                  subst989
                                  marks992
                                  symnames990
                                  ribcage991)
                           ((lambda (n994)
                              ((letrec ((f995
                                         (lambda (i996)
                                           (if (= i996 n994)
                                               (search969
                                                 sym993
                                                 (cdr subst989)
                                                 marks992)
                                               (if (if (eq? (vector-ref
                                                              symnames990
                                                              i996)
                                                            sym993)
                                                       (same-marks?392
                                                         marks992
                                                         (vector-ref
                                                           (ribcage-marks354
                                                             ribcage991)
                                                           i996))
                                                       '#f)
                                                   (values
                                                     (vector-ref
                                                       (ribcage-labels355
                                                         ribcage991)
                                                       i996)
                                                     marks992)
                                                   (f995 (+ i996 '1)))))))
                                 f995)
                               '0))
                            (vector-length symnames990)))))
                 (if (symbol? id968)
                     (search969
                       id968
                       (wrap-subst312 w967)
                       (wrap-marks311 w967))
                     (if (syntax-object?251 id968)
                         ((lambda (sym973 w1972)
                            ((lambda (marks974)
                               (call-with-values
                                 (lambda ()
                                   (search969
                                     sym973
                                     (wrap-subst312 w967)
                                     marks974))
                                 (lambda (new-id976 marks975)
                                   (if (eq? new-id976 sym973)
                                       (search969
                                         sym973
                                         (wrap-subst312 w1972)
                                         marks975)
                                       (values new-id976 marks975)))))
                             (join-marks391
                               (wrap-marks311 w967)
                               (wrap-marks311 w1972))))
                          ((lambda (e977)
                             (if (annotation?126 e977)
                                 (annotation-expression e977)
                                 e977))
                           (syntax-object-expression252 id968))
                          (syntax-object-wrap253 id968))
                         (if (annotation?126 id968)
                             (search969
                               ((lambda (e978)
                                  (if (annotation?126 e978)
                                      (annotation-expression e978)
                                      e978))
                                id968)
                               (wrap-subst312 w967)
                               (wrap-marks311 w967))
                             (error-hook129
                               'id-var-name
                               '"invalid id"
                               id968)))))))
            (id-var-name&marks394
             (lambda (id1842 w1841)
               (call-with-values
                 (lambda () (id-var-name-loc&marks393 id1842 w1841))
                 (lambda (label1844 marks1843)
                   (values
                     (if (indirect-label?342 label1844)
                         (get-indirect-label346 label1844)
                         label1844)
                     marks1843)))))
            (id-var-name-loc395
             (lambda (id1003 w1002)
               (call-with-values
                 (lambda () (id-var-name-loc&marks393 id1003 w1002))
                 (lambda (label1005 marks1004) label1005))))
            (id-var-name396
             (lambda (id1838 w1837)
               (call-with-values
                 (lambda () (id-var-name-loc&marks393 id1838 w1837))
                 (lambda (label1840 marks1839)
                   (if (indirect-label?342 label1840)
                       (get-indirect-label346 label1840)
                       label1840)))))
            (free-id=?397
             (lambda (i1007 j1006)
               (if (eq? ((lambda (x1010)
                           ((lambda (e1011)
                              (if (annotation?126 e1011)
                                  (annotation-expression e1011)
                                  e1011))
                            (if (syntax-object?251 x1010)
                                (syntax-object-expression252 x1010)
                                x1010)))
                         i1007)
                        ((lambda (x1008)
                           ((lambda (e1009)
                              (if (annotation?126 e1009)
                                  (annotation-expression e1009)
                                  e1009))
                            (if (syntax-object?251 x1008)
                                (syntax-object-expression252 x1008)
                                x1008)))
                         j1006))
                   (eq? (id-var-name396 i1007 '(()))
                        (id-var-name396 j1006 '(())))
                   '#f)))
            (literal-id=?398
             (lambda (id1827 literal1826)
               (if (eq? ((lambda (x1830)
                           ((lambda (e1831)
                              (if (annotation?126 e1831)
                                  (annotation-expression e1831)
                                  e1831))
                            (if (syntax-object?251 x1830)
                                (syntax-object-expression252 x1830)
                                x1830)))
                         id1827)
                        ((lambda (x1828)
                           ((lambda (e1829)
                              (if (annotation?126 e1829)
                                  (annotation-expression e1829)
                                  e1829))
                            (if (syntax-object?251 x1828)
                                (syntax-object-expression252 x1828)
                                x1828)))
                         literal1826))
                   ((lambda (n-id1833 n-literal1832)
                      ((lambda (t1834)
                         (if t1834
                             t1834
                             (if ((lambda (t1835)
                                    (if t1835 t1835 (symbol? n-id1833)))
                                  (not n-id1833))
                                 ((lambda (t1836)
                                    (if t1836
                                        t1836
                                        (symbol? n-literal1832)))
                                  (not n-literal1832))
                                 '#f)))
                       (eq? n-id1833 n-literal1832)))
                    (id-var-name396 id1827 '(()))
                    (id-var-name396 literal1826 '(())))
                   '#f)))
            (bound-id=?399
             (lambda (i1013 j1012)
               (if (if (syntax-object?251 i1013)
                       (syntax-object?251 j1012)
                       '#f)
                   (if (eq? ((lambda (e1015)
                               (if (annotation?126 e1015)
                                   (annotation-expression e1015)
                                   e1015))
                             (syntax-object-expression252 i1013))
                            ((lambda (e1014)
                               (if (annotation?126 e1014)
                                   (annotation-expression e1014)
                                   e1014))
                             (syntax-object-expression252 j1012)))
                       (same-marks?392
                         (wrap-marks311 (syntax-object-wrap253 i1013))
                         (wrap-marks311 (syntax-object-wrap253 j1012)))
                       '#f)
                   (eq? ((lambda (e1017)
                           (if (annotation?126 e1017)
                               (annotation-expression e1017)
                               e1017))
                         i1013)
                        ((lambda (e1016)
                           (if (annotation?126 e1016)
                               (annotation-expression e1016)
                               e1016))
                         j1012)))))
            (valid-bound-ids?400
             (lambda (ids1822)
               (if ((letrec ((all-ids?1823
                              (lambda (ids1824)
                                ((lambda (t1825)
                                   (if t1825
                                       t1825
                                       (if (id?303 (car ids1824))
                                           (all-ids?1823 (cdr ids1824))
                                           '#f)))
                                 (null? ids1824)))))
                      all-ids?1823)
                    ids1822)
                   (distinct-bound-ids?401 ids1822)
                   '#f)))
            (distinct-bound-ids?401
             (lambda (ids1018)
               ((letrec ((distinct?1019
                          (lambda (ids1020)
                            ((lambda (t1021)
                               (if t1021
                                   t1021
                                   (if (not (bound-id-member?403
                                              (car ids1020)
                                              (cdr ids1020)))
                                       (distinct?1019 (cdr ids1020))
                                       '#f)))
                             (null? ids1020)))))
                  distinct?1019)
                ids1018)))
            (invalid-ids-error402
             (lambda (ids1818 exp1816 class1817)
               ((letrec ((find1819
                          (lambda (ids1821 gooduns1820)
                            (if (null? ids1821)
                                (syntax-error exp1816)
                                (if (id?303 (car ids1821))
                                    (if (bound-id-member?403
                                          (car ids1821)
                                          gooduns1820)
                                        (syntax-error
                                          (car ids1821)
                                          '"duplicate "
                                          class1817)
                                        (find1819
                                          (cdr ids1821)
                                          (cons (car ids1821)
                                                gooduns1820)))
                                    (syntax-error
                                      (car ids1821)
                                      '"invalid "
                                      class1817))))))
                  find1819)
                ids1818
                '())))
            (bound-id-member?403
             (lambda (x1023 list1022)
               (if (not (null? list1022))
                   ((lambda (t1024)
                      (if t1024
                          t1024
                          (bound-id-member?403 x1023 (cdr list1022))))
                    (bound-id=?399 x1023 (car list1022)))
                   '#f)))
            (wrap404
             (lambda (x1815 w1814)
               (if (if (null? (wrap-marks311 w1814))
                       (null? (wrap-subst312 w1814))
                       '#f)
                   x1815
                   (if (syntax-object?251 x1815)
                       (make-syntax-object250
                         (syntax-object-expression252 x1815)
                         (join-wraps390
                           w1814
                           (syntax-object-wrap253 x1815)))
                       (if (null? x1815)
                           x1815
                           (make-syntax-object250 x1815 w1814))))))
            (source-wrap405
             (lambda (x1027 w1025 s1026)
               (wrap404
                 (if s1026 (make-annotation x1027 s1026 '#f) x1027)
                 w1025)))
            (chi-sequence406
             (lambda (body1808 r1805 w1807 s1806)
               (build-sequence236
                 s1806
                 ((letrec ((dobody1809
                            (lambda (body1812 r1810 w1811)
                              (if (null? body1812)
                                  '()
                                  ((lambda (first1813)
                                     (cons first1813
                                           (dobody1809
                                             (cdr body1812)
                                             r1810
                                             w1811)))
                                   (chi446 (car body1812) r1810 w1811))))))
                    dobody1809)
                  body1808
                  r1805
                  w1807))))
            (chi-top-sequence407
             (lambda (body1034
                      r1028
                      w1033
                      s1029
                      ctem1032
                      rtem1030
                      ribcage1031)
               (build-sequence236
                 s1029
                 ((letrec ((dobody1035
                            (lambda (body1040
                                     r1036
                                     w1039
                                     ctem1037
                                     rtem1038)
                              (if (null? body1040)
                                  '()
                                  ((lambda (first1041)
                                     (cons first1041
                                           (dobody1035
                                             (cdr body1040)
                                             r1036
                                             w1039
                                             ctem1037
                                             rtem1038)))
                                   (chi-top411
                                     (car body1040)
                                     r1036
                                     w1039
                                     ctem1037
                                     rtem1038
                                     ribcage1031))))))
                    dobody1035)
                  body1034
                  r1028
                  w1033
                  ctem1032
                  rtem1030))))
            (chi-when-list408
             (lambda (when-list1803 w1802)
               (map (lambda (x1804)
                      (if (literal-id=?398
                            x1804
                            '#(syntax-object compile ((top) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(when-list w) #((top) (top)) #("i" "i")) #(ribcage (lambda-var-list gen-var strip strip* strip-annotation ellipsis? chi-void chi-local-syntax chi-lambda-clause parse-define-syntax parse-define parse-import parse-module do-import! chi-internal chi-body chi-macro chi-set! chi-application chi-expr chi ct-eval/residualize rt-eval/residualize initial-mode-set update-mode-set do-top-import vfor-each vmap chi-external check-defined-ids check-module-exports extend-store! id-set-diff chi-top-module set-module-binding-val! set-module-binding-imps! set-module-binding-label! set-module-binding-id! set-module-binding-type! module-binding-val module-binding-imps module-binding-label module-binding-id module-binding-type module-binding? make-module-binding make-resolved-interface make-trimmed-interface set-interface-token! set-interface-exports! interface-token interface-exports interface? make-interface flatten-exports chi-top chi-top-expr syntax-type chi-when-list chi-top-sequence chi-sequence source-wrap wrap bound-id-member? invalid-ids-error distinct-bound-ids? valid-bound-ids? bound-id=? literal-id=? free-id=? id-var-name id-var-name-loc id-var-name&marks id-var-name-loc&marks same-marks? join-marks join-wraps smart-append make-trimmed-syntax-object make-binding-wrap lookup-import-binding-name extend-ribcage-subst! extend-ribcage-barrier-help! extend-ribcage-barrier! extend-ribcage! make-empty-ribcage set-import-token-key! import-token-key import-token? make-import-token barrier-marker new-mark anti-mark the-anti-mark set-ribcage-labels! set-ribcage-marks! set-ribcage-symnames! ribcage-labels ribcage-marks ribcage-symnames ribcage? make-ribcage gen-labels label? gen-label set-indirect-label! get-indirect-label indirect-label? gen-indirect-label only-top-marked? top-marked? top-wrap empty-wrap wrap-subst wrap-marks make-wrap id-sym-name&marks id-sym-name id? nonsymbol-id? global-extend lookup sanitize-binding lookup* displaced-lexical-error transformer-env extend-var-env* extend-env* extend-env null-env binding? set-binding-value! set-binding-type! binding-value binding-type make-binding arg-check source-annotation no-source unannotate set-syntax-object-wrap! set-syntax-object-expression! syntax-object-wrap syntax-object-expression syntax-object? make-syntax-object self-evaluating? build-lexical-var build-body build-letrec build-sequence build-data build-primref build-lambda build-revisit-only build-visit-only build-cte-install build-module-definition build-global-definition build-global-assignment build-global-reference build-lexical-assignment build-lexical-reference build-conditional build-application generate-id get-import-binding get-global-definition-hook put-global-definition-hook gensym-hook error-hook local-eval-hook top-level-eval-hook annotation? fx>= fx<= fx> fx< fx= fx- fx+ noexpand let-values define-structure unless when) ((top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top)) ("i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()) #(ribcage (#(import-token *top*)) () ()))))
                          'compile
                          (if (literal-id=?398
                                x1804
                                '#(syntax-object load ((top) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(when-list w) #((top) (top)) #("i" "i")) #(ribcage (lambda-var-list gen-var strip strip* strip-annotation ellipsis? chi-void chi-local-syntax chi-lambda-clause parse-define-syntax parse-define parse-import parse-module do-import! chi-internal chi-body chi-macro chi-set! chi-application chi-expr chi ct-eval/residualize rt-eval/residualize initial-mode-set update-mode-set do-top-import vfor-each vmap chi-external check-defined-ids check-module-exports extend-store! id-set-diff chi-top-module set-module-binding-val! set-module-binding-imps! set-module-binding-label! set-module-binding-id! set-module-binding-type! module-binding-val module-binding-imps module-binding-label module-binding-id module-binding-type module-binding? make-module-binding make-resolved-interface make-trimmed-interface set-interface-token! set-interface-exports! interface-token interface-exports interface? make-interface flatten-exports chi-top chi-top-expr syntax-type chi-when-list chi-top-sequence chi-sequence source-wrap wrap bound-id-member? invalid-ids-error distinct-bound-ids? valid-bound-ids? bound-id=? literal-id=? free-id=? id-var-name id-var-name-loc id-var-name&marks id-var-name-loc&marks same-marks? join-marks join-wraps smart-append make-trimmed-syntax-object make-binding-wrap lookup-import-binding-name extend-ribcage-subst! extend-ribcage-barrier-help! extend-ribcage-barrier! extend-ribcage! make-empty-ribcage set-import-token-key! import-token-key import-token? make-import-token barrier-marker new-mark anti-mark the-anti-mark set-ribcage-labels! set-ribcage-marks! set-ribcage-symnames! ribcage-labels ribcage-marks ribcage-symnames ribcage? make-ribcage gen-labels label? gen-label set-indirect-label! get-indirect-label indirect-label? gen-indirect-label only-top-marked? top-marked? top-wrap empty-wrap wrap-subst wrap-marks make-wrap id-sym-name&marks id-sym-name id? nonsymbol-id? global-extend lookup sanitize-binding lookup* displaced-lexical-error transformer-env extend-var-env* extend-env* extend-env null-env binding? set-binding-value! set-binding-type! binding-value binding-type make-binding arg-check source-annotation no-source unannotate set-syntax-object-wrap! set-syntax-object-expression! syntax-object-wrap syntax-object-expression syntax-object? make-syntax-object self-evaluating? build-lexical-var build-body build-letrec build-sequence build-data build-primref build-lambda build-revisit-only build-visit-only build-cte-install build-module-definition build-global-definition build-global-assignment build-global-reference build-lexical-assignment build-lexical-reference build-conditional build-application generate-id get-import-binding get-global-definition-hook put-global-definition-hook gensym-hook error-hook local-eval-hook top-level-eval-hook annotation? fx>= fx<= fx> fx< fx= fx- fx+ noexpand let-values define-structure unless when) ((top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top)) ("i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()) #(ribcage (#(import-token *top*)) () ()))))
                              'load
                              (if (literal-id=?398
                                    x1804
                                    '#(syntax-object visit ((top) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(when-list w) #((top) (top)) #("i" "i")) #(ribcage (lambda-var-list gen-var strip strip* strip-annotation ellipsis? chi-void chi-local-syntax chi-lambda-clause parse-define-syntax parse-define parse-import parse-module do-import! chi-internal chi-body chi-macro chi-set! chi-application chi-expr chi ct-eval/residualize rt-eval/residualize initial-mode-set update-mode-set do-top-import vfor-each vmap chi-external check-defined-ids check-module-exports extend-store! id-set-diff chi-top-module set-module-binding-val! set-module-binding-imps! set-module-binding-label! set-module-binding-id! set-module-binding-type! module-binding-val module-binding-imps module-binding-label module-binding-id module-binding-type module-binding? make-module-binding make-resolved-interface make-trimmed-interface set-interface-token! set-interface-exports! interface-token interface-exports interface? make-interface flatten-exports chi-top chi-top-expr syntax-type chi-when-list chi-top-sequence chi-sequence source-wrap wrap bound-id-member? invalid-ids-error distinct-bound-ids? valid-bound-ids? bound-id=? literal-id=? free-id=? id-var-name id-var-name-loc id-var-name&marks id-var-name-loc&marks same-marks? join-marks join-wraps smart-append make-trimmed-syntax-object make-binding-wrap lookup-import-binding-name extend-ribcage-subst! extend-ribcage-barrier-help! extend-ribcage-barrier! extend-ribcage! make-empty-ribcage set-import-token-key! import-token-key import-token? make-import-token barrier-marker new-mark anti-mark the-anti-mark set-ribcage-labels! set-ribcage-marks! set-ribcage-symnames! ribcage-labels ribcage-marks ribcage-symnames ribcage? make-ribcage gen-labels label? gen-label set-indirect-label! get-indirect-label indirect-label? gen-indirect-label only-top-marked? top-marked? top-wrap empty-wrap wrap-subst wrap-marks make-wrap id-sym-name&marks id-sym-name id? nonsymbol-id? global-extend lookup sanitize-binding lookup* displaced-lexical-error transformer-env extend-var-env* extend-env* extend-env null-env binding? set-binding-value! set-binding-type! binding-value binding-type make-binding arg-check source-annotation no-source unannotate set-syntax-object-wrap! set-syntax-object-expression! syntax-object-wrap syntax-object-expression syntax-object? make-syntax-object self-evaluating? build-lexical-var build-body build-letrec build-sequence build-data build-primref build-lambda build-revisit-only build-visit-only build-cte-install build-module-definition build-global-definition build-global-assignment build-global-reference build-lexical-assignment build-lexical-reference build-conditional build-application generate-id get-import-binding get-global-definition-hook put-global-definition-hook gensym-hook error-hook local-eval-hook top-level-eval-hook annotation? fx>= fx<= fx> fx< fx= fx- fx+ noexpand let-values define-structure unless when) ((top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top)) ("i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()) #(ribcage (#(import-token *top*)) () ()))))
                                  'visit
                                  (if (literal-id=?398
                                        x1804
                                        '#(syntax-object revisit ((top) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(when-list w) #((top) (top)) #("i" "i")) #(ribcage (lambda-var-list gen-var strip strip* strip-annotation ellipsis? chi-void chi-local-syntax chi-lambda-clause parse-define-syntax parse-define parse-import parse-module do-import! chi-internal chi-body chi-macro chi-set! chi-application chi-expr chi ct-eval/residualize rt-eval/residualize initial-mode-set update-mode-set do-top-import vfor-each vmap chi-external check-defined-ids check-module-exports extend-store! id-set-diff chi-top-module set-module-binding-val! set-module-binding-imps! set-module-binding-label! set-module-binding-id! set-module-binding-type! module-binding-val module-binding-imps module-binding-label module-binding-id module-binding-type module-binding? make-module-binding make-resolved-interface make-trimmed-interface set-interface-token! set-interface-exports! interface-token interface-exports interface? make-interface flatten-exports chi-top chi-top-expr syntax-type chi-when-list chi-top-sequence chi-sequence source-wrap wrap bound-id-member? invalid-ids-error distinct-bound-ids? valid-bound-ids? bound-id=? literal-id=? free-id=? id-var-name id-var-name-loc id-var-name&marks id-var-name-loc&marks same-marks? join-marks join-wraps smart-append make-trimmed-syntax-object make-binding-wrap lookup-import-binding-name extend-ribcage-subst! extend-ribcage-barrier-help! extend-ribcage-barrier! extend-ribcage! make-empty-ribcage set-import-token-key! import-token-key import-token? make-import-token barrier-marker new-mark anti-mark the-anti-mark set-ribcage-labels! set-ribcage-marks! set-ribcage-symnames! ribcage-labels ribcage-marks ribcage-symnames ribcage? make-ribcage gen-labels label? gen-label set-indirect-label! get-indirect-label indirect-label? gen-indirect-label only-top-marked? top-marked? top-wrap empty-wrap wrap-subst wrap-marks make-wrap id-sym-name&marks id-sym-name id? nonsymbol-id? global-extend lookup sanitize-binding lookup* displaced-lexical-error transformer-env extend-var-env* extend-env* extend-env null-env binding? set-binding-value! set-binding-type! binding-value binding-type make-binding arg-check source-annotation no-source unannotate set-syntax-object-wrap! set-syntax-object-expression! syntax-object-wrap syntax-object-expression syntax-object? make-syntax-object self-evaluating? build-lexical-var build-body build-letrec build-sequence build-data build-primref build-lambda build-revisit-only build-visit-only build-cte-install build-module-definition build-global-definition build-global-assignment build-global-reference build-lexical-assignment build-lexical-reference build-conditional build-application generate-id get-import-binding get-global-definition-hook put-global-definition-hook gensym-hook error-hook local-eval-hook top-level-eval-hook annotation? fx>= fx<= fx> fx< fx= fx- fx+ noexpand let-values define-structure unless when) ((top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top)) ("i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()) #(ribcage (#(import-token *top*)) () ()))))
                                      'revisit
                                      (if (literal-id=?398
                                            x1804
                                            '#(syntax-object eval ((top) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(when-list w) #((top) (top)) #("i" "i")) #(ribcage (lambda-var-list gen-var strip strip* strip-annotation ellipsis? chi-void chi-local-syntax chi-lambda-clause parse-define-syntax parse-define parse-import parse-module do-import! chi-internal chi-body chi-macro chi-set! chi-application chi-expr chi ct-eval/residualize rt-eval/residualize initial-mode-set update-mode-set do-top-import vfor-each vmap chi-external check-defined-ids check-module-exports extend-store! id-set-diff chi-top-module set-module-binding-val! set-module-binding-imps! set-module-binding-label! set-module-binding-id! set-module-binding-type! module-binding-val module-binding-imps module-binding-label module-binding-id module-binding-type module-binding? make-module-binding make-resolved-interface make-trimmed-interface set-interface-token! set-interface-exports! interface-token interface-exports interface? make-interface flatten-exports chi-top chi-top-expr syntax-type chi-when-list chi-top-sequence chi-sequence source-wrap wrap bound-id-member? invalid-ids-error distinct-bound-ids? valid-bound-ids? bound-id=? literal-id=? free-id=? id-var-name id-var-name-loc id-var-name&marks id-var-name-loc&marks same-marks? join-marks join-wraps smart-append make-trimmed-syntax-object make-binding-wrap lookup-import-binding-name extend-ribcage-subst! extend-ribcage-barrier-help! extend-ribcage-barrier! extend-ribcage! make-empty-ribcage set-import-token-key! import-token-key import-token? make-import-token barrier-marker new-mark anti-mark the-anti-mark set-ribcage-labels! set-ribcage-marks! set-ribcage-symnames! ribcage-labels ribcage-marks ribcage-symnames ribcage? make-ribcage gen-labels label? gen-label set-indirect-label! get-indirect-label indirect-label? gen-indirect-label only-top-marked? top-marked? top-wrap empty-wrap wrap-subst wrap-marks make-wrap id-sym-name&marks id-sym-name id? nonsymbol-id? global-extend lookup sanitize-binding lookup* displaced-lexical-error transformer-env extend-var-env* extend-env* extend-env null-env binding? set-binding-value! set-binding-type! binding-value binding-type make-binding arg-check source-annotation no-source unannotate set-syntax-object-wrap! set-syntax-object-expression! syntax-object-wrap syntax-object-expression syntax-object? make-syntax-object self-evaluating? build-lexical-var build-body build-letrec build-sequence build-data build-primref build-lambda build-revisit-only build-visit-only build-cte-install build-module-definition build-global-definition build-global-assignment build-global-reference build-lexical-assignment build-lexical-reference build-conditional build-application generate-id get-import-binding get-global-definition-hook put-global-definition-hook gensym-hook error-hook local-eval-hook top-level-eval-hook annotation? fx>= fx<= fx> fx< fx= fx- fx+ noexpand let-values define-structure unless when) ((top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top)) ("i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()) #(ribcage (#(import-token *top*)) () ()))))
                                          'eval
                                          (syntax-error
                                            (wrap404 x1804 w1802)
                                            '"invalid eval-when situation")))))))
                    when-list1803)))
            (syntax-type409
             (lambda (e1046 r1042 w1045 s1043 rib1044)
               (if (symbol? e1046)
                   ((lambda (n1047)
                      ((lambda (b1048)
                         ((lambda (type1049)
                            ((lambda ()
                               ((lambda (t1050)
                                  (if (memv t1050 '(lexical))
                                      (values
                                        type1049
                                        (binding-value280 b1048)
                                        e1046
                                        w1045
                                        s1043)
                                      (if (memv t1050 '(global))
                                          (values
                                            type1049
                                            (binding-value280 b1048)
                                            e1046
                                            w1045
                                            s1043)
                                          (if (memv t1050 '(macro macro!))
                                              (syntax-type409
                                                (chi-macro450
                                                  (binding-value280 b1048)
                                                  e1046
                                                  r1042
                                                  w1045
                                                  s1043
                                                  rib1044)
                                                r1042
                                                '(())
                                                '#f
                                                rib1044)
                                              (values
                                                type1049
                                                (binding-value280 b1048)
                                                e1046
                                                w1045
                                                s1043)))))
                                type1049))))
                          (binding-type279 b1048)))
                       (lookup300 n1047 r1042)))
                    (id-var-name396 e1046 w1045))
                   (if (pair? e1046)
                       ((lambda (first1051)
                          (if (id?303 first1051)
                              ((lambda (n1052)
                                 ((lambda (b1053)
                                    ((lambda (type1054)
                                       ((lambda ()
                                          ((lambda (t1055)
                                             (if (memv t1055 '(lexical))
                                                 (values
                                                   'lexical-call
                                                   (binding-value280 b1053)
                                                   e1046
                                                   w1045
                                                   s1043)
                                                 (if (memv t1055
                                                           '(macro macro!))
                                                     (syntax-type409
                                                       (chi-macro450
                                                         (binding-value280
                                                           b1053)
                                                         e1046
                                                         r1042
                                                         w1045
                                                         s1043
                                                         rib1044)
                                                       r1042
                                                       '(())
                                                       '#f
                                                       rib1044)
                                                     (if (memv t1055
                                                               '(core))
                                                         (values
                                                           type1054
                                                           (binding-value280
                                                             b1053)
                                                           e1046
                                                           w1045
                                                           s1043)
                                                         (if (memv t1055
                                                                   '(local-syntax))
                                                             (values
                                                               'local-syntax-form
                                                               (binding-value280
                                                                 b1053)
                                                               e1046
                                                               w1045
                                                               s1043)
                                                             (if (memv t1055
                                                                       '(begin))
                                                                 (values
                                                                   'begin-form
                                                                   '#f
                                                                   e1046
                                                                   w1045
                                                                   s1043)
                                                                 (if (memv t1055
                                                                           '(eval-when))
                                                                     (values
                                                                       'eval-when-form
                                                                       '#f
                                                                       e1046
                                                                       w1045
                                                                       s1043)
                                                                     (if (memv t1055
                                                                               '(define))
                                                                         (values
                                                                           'define-form
                                                                           '#f
                                                                           e1046
                                                                           w1045
                                                                           s1043)
                                                                         (if (memv t1055
                                                                                   '(define-syntax))
                                                                             (values
                                                                               'define-syntax-form
                                                                               '#f
                                                                               e1046
                                                                               w1045
                                                                               s1043)
                                                                             (if (memv t1055
                                                                                       '(module-key))
                                                                                 (values
                                                                                   'module-form
                                                                                   '#f
                                                                                   e1046
                                                                                   w1045
                                                                                   s1043)
                                                                                 (if (memv t1055
                                                                                           '(import))
                                                                                     (values
                                                                                       'import-form
                                                                                       (if (binding-value280
                                                                                             b1053)
                                                                                           (wrap404
                                                                                             first1051
                                                                                             w1045)
                                                                                           '#f)
                                                                                       e1046
                                                                                       w1045
                                                                                       s1043)
                                                                                     (if (memv t1055
                                                                                               '(set!))
                                                                                         (chi-set!449
                                                                                           e1046
                                                                                           r1042
                                                                                           w1045
                                                                                           s1043
                                                                                           rib1044)
                                                                                         (values
                                                                                           'call
                                                                                           '#f
                                                                                           e1046
                                                                                           w1045
                                                                                           s1043)))))))))))))
                                           type1054))))
                                     (binding-type279 b1053)))
                                  (lookup300 n1052 r1042)))
                               (id-var-name396 first1051 w1045))
                              (values 'call '#f e1046 w1045 s1043)))
                        (car e1046))
                       (if (syntax-object?251 e1046)
                           (syntax-type409
                             (syntax-object-expression252 e1046)
                             r1042
                             (join-wraps390
                               w1045
                               (syntax-object-wrap253 e1046))
                             '#f
                             rib1044)
                           (if (annotation?126 e1046)
                               (syntax-type409
                                 (annotation-expression e1046)
                                 r1042
                                 w1045
                                 (annotation-source e1046)
                                 rib1044)
                               (if ((lambda (x1056)
                                      ((lambda (t1057)
                                         (if t1057
                                             t1057
                                             ((lambda (t1058)
                                                (if t1058
                                                    t1058
                                                    ((lambda (t1059)
                                                       (if t1059
                                                           t1059
                                                           ((lambda (t1060)
                                                              (if t1060
                                                                  t1060
                                                                  (null?
                                                                    x1056)))
                                                            (char?
                                                              x1056))))
                                                     (string? x1056))))
                                              (number? x1056))))
                                       (boolean? x1056)))
                                    e1046)
                                   (values 'constant '#f e1046 w1045 s1043)
                                   (values
                                     'other
                                     '#f
                                     e1046
                                     w1045
                                     s1043))))))))
            (chi-top-expr410
             (lambda (e1796 r1793 w1795 top-ribcage1794)
               (call-with-values
                 (lambda ()
                   (syntax-type409 e1796 r1793 w1795 '#f top-ribcage1794))
                 (lambda (type1801 value1797 e1800 w1798 s1799)
                   (chi-expr447
                     type1801
                     value1797
                     e1800
                     r1793
                     w1798
                     s1799)))))
            (chi-top411
             (lambda (e1066
                      r1061
                      w1065
                      ctem1062
                      rtem1064
                      top-ribcage1063)
               (call-with-values
                 (lambda ()
                   (syntax-type409 e1066 r1061 w1065 '#f top-ribcage1063))
                 (lambda (type1071 value1067 e1070 w1068 s1069)
                   ((lambda (t1072)
                      (if (memv t1072 '(begin-form))
                          ((lambda (tmp1073)
                             ((lambda (tmp1074)
                                (if tmp1074
                                    (apply
                                      (lambda (_1075) (chi-void460))
                                      tmp1074)
                                    ((lambda (tmp1076)
                                       (if tmp1076
                                           (apply
                                             (lambda (_1079 e11077 e21078)
                                               (chi-top-sequence407
                                                 (cons e11077 e21078)
                                                 r1061
                                                 w1068
                                                 s1069
                                                 ctem1062
                                                 rtem1064
                                                 top-ribcage1063))
                                             tmp1076)
                                           (syntax-error tmp1073)))
                                     ($syntax-dispatch
                                       tmp1073
                                       '(any any . each-any)))))
                              ($syntax-dispatch tmp1073 '(any))))
                           e1070)
                          (if (memv t1072 '(local-syntax-form))
                              (chi-local-syntax459
                                value1067
                                e1070
                                r1061
                                w1068
                                s1069
                                (lambda (body1084 r1081 w1083 s1082)
                                  (chi-top-sequence407
                                    body1084
                                    r1081
                                    w1083
                                    s1082
                                    ctem1062
                                    rtem1064
                                    top-ribcage1063)))
                              (if (memv t1072 '(eval-when-form))
                                  ((lambda (tmp1085)
                                     ((lambda (tmp1086)
                                        (if tmp1086
                                            (apply
                                              (lambda (_1090
                                                       x1087
                                                       e11089
                                                       e21088)
                                                ((lambda (when-list1092
                                                          body1091)
                                                   ((lambda (ctem1094
                                                             rtem1093)
                                                      (if (if (null?
                                                                ctem1094)
                                                              (null?
                                                                rtem1093)
                                                              '#f)
                                                          (chi-void460)
                                                          (chi-top-sequence407
                                                            body1091
                                                            r1061
                                                            w1068
                                                            s1069
                                                            ctem1094
                                                            rtem1093
                                                            top-ribcage1063)))
                                                    (update-mode-set442
                                                      when-list1092
                                                      ctem1062)
                                                    (update-mode-set442
                                                      when-list1092
                                                      rtem1064)))
                                                 (chi-when-list408
                                                   x1087
                                                   w1068)
                                                 (cons e11089 e21088)))
                                              tmp1086)
                                            (syntax-error tmp1085)))
                                      ($syntax-dispatch
                                        tmp1085
                                        '(any each-any any . each-any))))
                                   e1070)
                                  (if (memv t1072 '(define-syntax-form))
                                      (parse-define-syntax457
                                        e1070
                                        w1068
                                        s1069
                                        (lambda (id1099 rhs1097 w1098)
                                          ((lambda (id1100)
                                             (begin ((lambda (n1105)
                                                       ((lambda (b1106)
                                                          ((lambda (t1107)
                                                             (if (memv t1107
                                                                       '(displaced-lexical))
                                                                 (displaced-lexical-error297
                                                                   id1100)
                                                                 (void)))
                                                           (binding-type279
                                                             b1106)))
                                                        (lookup300
                                                          n1105
                                                          r1061)))
                                                     (id-var-name396
                                                       id1100
                                                       '(())))
                                                    (ct-eval/residualize445
                                                      ctem1062
                                                      (lambda ()
                                                        (list '$sc-put-cte
                                                              (list 'quote
                                                                    ((lambda (sym1101)
                                                                       (if (same-marks?392
                                                                             (wrap-marks311
                                                                               (syntax-object-wrap253
                                                                                 id1100))
                                                                             (wrap-marks311
                                                                               '((top))))
                                                                           sym1101
                                                                           ((lambda (marks1102)
                                                                              (make-syntax-object250
                                                                                sym1101
                                                                                (make-wrap310
                                                                                  marks1102
                                                                                  (list (make-ribcage351
                                                                                          (vector
                                                                                            sym1101)
                                                                                          (vector
                                                                                            marks1102)
                                                                                          (vector
                                                                                            (generate-id137
                                                                                              sym1101)))))))
                                                                            (wrap-marks311
                                                                              (syntax-object-wrap253
                                                                                id1100)))))
                                                                     ((lambda (x1103)
                                                                        ((lambda (e1104)
                                                                           (if (annotation?126
                                                                                 e1104)
                                                                               (annotation-expression
                                                                                 e1104)
                                                                               e1104))
                                                                         (if (syntax-object?251
                                                                               x1103)
                                                                             (syntax-object-expression252
                                                                               x1103)
                                                                             x1103)))
                                                                      id1100)))
                                                              (chi446
                                                                rhs1097
                                                                (transformer-env296
                                                                  r1061)
                                                                w1098))))))
                                           (wrap404 id1099 w1098))))
                                      (if (memv t1072 '(define-form))
                                          (parse-define456
                                            e1070
                                            w1068
                                            s1069
                                            (lambda (id1110 rhs1108 w1109)
                                              ((lambda (id1111)
                                                 (begin ((lambda (n1117)
                                                           ((lambda (b1118)
                                                              ((lambda (t1119)
                                                                 (if (memv t1119
                                                                           '(displaced-lexical))
                                                                     (displaced-lexical-error297
                                                                       id1111)
                                                                     (void)))
                                                               (binding-type279
                                                                 b1118)))
                                                            (lookup300
                                                              n1117
                                                              r1061)))
                                                         (id-var-name396
                                                           id1111
                                                           '(())))
                                                        ((lambda (sym1112)
                                                           ((lambda (valsym1113)
                                                              (build-sequence236
                                                                '#f
                                                                (list (ct-eval/residualize445
                                                                        ctem1062
                                                                        (lambda ()
                                                                          (list '$sc-put-cte
                                                                                (list 'quote
                                                                                      (if (eq? sym1112
                                                                                               valsym1113)
                                                                                          sym1112
                                                                                          ((lambda (marks1114)
                                                                                             (make-syntax-object250
                                                                                               sym1112
                                                                                               (make-wrap310
                                                                                                 marks1114
                                                                                                 (list (make-ribcage351
                                                                                                         (vector
                                                                                                           sym1112)
                                                                                                         (vector
                                                                                                           marks1114)
                                                                                                         (vector
                                                                                                           valsym1113))))))
                                                                                           (wrap-marks311
                                                                                             (syntax-object-wrap253
                                                                                               id1111)))))
                                                                                (list 'quote
                                                                                      (make-binding278
                                                                                        'global
                                                                                        valsym1113)))))
                                                                      (rt-eval/residualize444
                                                                        rtem1064
                                                                        (lambda ()
                                                                          (list 'define
                                                                                valsym1113
                                                                                (chi446
                                                                                  rhs1108
                                                                                  r1061
                                                                                  w1109)))))))
                                                            (if (same-marks?392
                                                                  (wrap-marks311
                                                                    (syntax-object-wrap253
                                                                      id1111))
                                                                  (wrap-marks311
                                                                    '((top))))
                                                                sym1112
                                                                (generate-id137
                                                                  sym1112))))
                                                         ((lambda (x1115)
                                                            ((lambda (e1116)
                                                               (if (annotation?126
                                                                     e1116)
                                                                   (annotation-expression
                                                                     e1116)
                                                                   e1116))
                                                             (if (syntax-object?251
                                                                   x1115)
                                                                 (syntax-object-expression252
                                                                   x1115)
                                                                 x1115)))
                                                          id1111))))
                                               (wrap404 id1110 w1109))))
                                          (if (memv t1072 '(module-form))
                                              ((lambda (r1121 ribcage1120)
                                                 (parse-module454
                                                   e1070
                                                   w1068
                                                   s1069
                                                   (make-wrap310
                                                     (wrap-marks311 w1068)
                                                     (cons ribcage1120
                                                           (wrap-subst312
                                                             w1068)))
                                                   (lambda (id1124
                                                            exports1122
                                                            forms1123)
                                                     (if id1124
                                                         (begin ((lambda (n1125)
                                                                   ((lambda (b1126)
                                                                      ((lambda (t1127)
                                                                         (if (memv t1127
                                                                                   '(displaced-lexical))
                                                                             (displaced-lexical-error297
                                                                               (wrap404
                                                                                 id1124
                                                                                 w1068))
                                                                             (void)))
                                                                       (binding-type279
                                                                         b1126)))
                                                                    (lookup300
                                                                      n1125
                                                                      r1121)))
                                                                 (id-var-name396
                                                                   id1124
                                                                   '(())))
                                                                (chi-top-module433
                                                                  e1070
                                                                  r1121
                                                                  ribcage1120
                                                                  w1068
                                                                  s1069
                                                                  ctem1062
                                                                  rtem1064
                                                                  id1124
                                                                  exports1122
                                                                  forms1123))
                                                         (chi-top-module433
                                                           e1070
                                                           r1121
                                                           ribcage1120
                                                           w1068
                                                           s1069
                                                           ctem1062
                                                           rtem1064
                                                           '#f
                                                           exports1122
                                                           forms1123)))))
                                               (cons '("top-level module placeholder"
                                                        placeholder)
                                                     r1061)
                                               (make-ribcage351
                                                 '()
                                                 '()
                                                 '()))
                                              (if (memv t1072
                                                        '(import-form))
                                                  (parse-import455
                                                    e1070
                                                    w1068
                                                    s1069
                                                    (lambda (mid1128)
                                                      (ct-eval/residualize445
                                                        ctem1062
                                                        (lambda ()
                                                          (begin (if value1067
                                                                     (syntax-error
                                                                       (source-wrap405
                                                                         e1070
                                                                         w1068
                                                                         s1069)
                                                                       '"not valid at top-level")
                                                                     (void))
                                                                 ((lambda (binding1129)
                                                                    ((lambda (t1130)
                                                                       (if (memv t1130
                                                                                 '(module))
                                                                           (do-top-import441
                                                                             mid1128
                                                                             (interface-token416
                                                                               (binding-value280
                                                                                 binding1129)))
                                                                           (if (memv t1130
                                                                                     '(displaced-lexical))
                                                                               (displaced-lexical-error297
                                                                                 mid1128)
                                                                               (syntax-error
                                                                                 mid1128
                                                                                 '"import from unknown module"))))
                                                                     (binding-type279
                                                                       binding1129)))
                                                                  (lookup300
                                                                    (id-var-name396
                                                                      mid1128
                                                                      '(()))
                                                                    '())))))))
                                                  (rt-eval/residualize444
                                                    rtem1064
                                                    (lambda ()
                                                      (chi-expr447
                                                        type1071
                                                        value1067
                                                        e1070
                                                        r1061
                                                        w1068
                                                        s1069)))))))))))
                    type1071)))))
            (flatten-exports412
             (lambda (exports1789)
               ((letrec ((loop1790
                          (lambda (exports1792 ls1791)
                            (if (null? exports1792)
                                ls1791
                                (loop1790
                                  (cdr exports1792)
                                  (if (pair? (car exports1792))
                                      (loop1790 (car exports1792) ls1791)
                                      (cons (car exports1792) ls1791)))))))
                  loop1790)
                exports1789
                '())))
            (make-interface413
             (lambda (exports1132 token1131)
               (vector 'interface exports1132 token1131)))
            (interface?414
             (lambda (x1788)
               (if (vector? x1788)
                   (if (= (vector-length x1788) '3)
                       (eq? (vector-ref x1788 '0) 'interface)
                       '#f)
                   '#f)))
            (interface-exports415
             (lambda (x1133) (vector-ref x1133 '1)))
            (interface-token416 (lambda (x1787) (vector-ref x1787 '2)))
            (set-interface-exports!417
             (lambda (x1135 update1134)
               (vector-set! x1135 '1 update1134)))
            (set-interface-token!418
             (lambda (x1786 update1785)
               (vector-set! x1786 '2 update1785)))
            (make-trimmed-interface419
             (lambda (exports1136)
               (make-interface413
                 (list->vector
                   (map (lambda (x1137)
                          (if (pair? x1137) (car x1137) x1137))
                        exports1136))
                 '#f)))
            (make-resolved-interface420
             (lambda (exports1783 import-token1782)
               (make-interface413
                 (list->vector
                   (map (lambda (x1784)
                          (make-trimmed-syntax-object388
                            (if (pair? x1784) (car x1784) x1784)))
                        exports1783))
                 import-token1782)))
            (make-module-binding421
             (lambda (type1142 id1138 label1141 imps1139 val1140)
               (vector
                 'module-binding
                 type1142
                 id1138
                 label1141
                 imps1139
                 val1140)))
            (module-binding?422
             (lambda (x1781)
               (if (vector? x1781)
                   (if (= (vector-length x1781) '6)
                       (eq? (vector-ref x1781 '0) 'module-binding)
                       '#f)
                   '#f)))
            (module-binding-type423
             (lambda (x1143) (vector-ref x1143 '1)))
            (module-binding-id424
             (lambda (x1780) (vector-ref x1780 '2)))
            (module-binding-label425
             (lambda (x1144) (vector-ref x1144 '3)))
            (module-binding-imps426
             (lambda (x1779) (vector-ref x1779 '4)))
            (module-binding-val427
             (lambda (x1145) (vector-ref x1145 '5)))
            (set-module-binding-type!428
             (lambda (x1778 update1777)
               (vector-set! x1778 '1 update1777)))
            (set-module-binding-id!429
             (lambda (x1147 update1146)
               (vector-set! x1147 '2 update1146)))
            (set-module-binding-label!430
             (lambda (x1776 update1775)
               (vector-set! x1776 '3 update1775)))
            (set-module-binding-imps!431
             (lambda (x1149 update1148)
               (vector-set! x1149 '4 update1148)))
            (set-module-binding-val!432
             (lambda (x1774 update1773)
               (vector-set! x1774 '5 update1773)))
            (chi-top-module433
             (lambda (e1159
                      r1150
                      ribcage1158
                      w1151
                      s1157
                      ctem1152
                      rtem1156
                      id1153
                      exports1155
                      forms1154)
               ((lambda (fexports1160)
                  (chi-external438
                    ribcage1158
                    (source-wrap405 e1159 w1151 s1157)
                    (map (lambda (d1223) (cons r1150 d1223)) forms1154)
                    r1150
                    exports1155
                    fexports1160
                    ctem1152
                    rtem1156
                    (lambda (bindings1162 inits1161)
                      ((letrec ((partition1163
                                 (lambda (fexports1168
                                          bs1164
                                          svs1167
                                          ses1165
                                          ctdefs1166)
                                   (if (null? fexports1168)
                                       ((letrec ((partition1169
                                                  (lambda (bs1172
                                                           dvs1170
                                                           des1171)
                                                    (if (null? bs1172)
                                                        ((lambda (ses1175
                                                                  des1173
                                                                  inits1174)
                                                           (begin (for-each
                                                                    (lambda (x1191)
                                                                      (apply
                                                                        (lambda (t1195
                                                                                 label1192
                                                                                 sym1194
                                                                                 val1193)
                                                                          (if label1192
                                                                              (set-indirect-label!347
                                                                                label1192
                                                                                sym1194)
                                                                              (void)))
                                                                        x1191))
                                                                    ctdefs1166)
                                                                  (build-sequence236
                                                                    '#f
                                                                    (list (ct-eval/residualize445
                                                                            ctem1152
                                                                            (lambda ()
                                                                              (if (null?
                                                                                    ctdefs1166)
                                                                                  (chi-void460)
                                                                                  (build-sequence236
                                                                                    '#f
                                                                                    (map (lambda (x1186)
                                                                                           (apply
                                                                                             (lambda (t1190
                                                                                                      label1187
                                                                                                      sym1189
                                                                                                      val1188)
                                                                                               (list '$sc-put-cte
                                                                                                     (list 'quote
                                                                                                           sym1189)
                                                                                                     (if (eq? t1190
                                                                                                              'define-syntax-form)
                                                                                                         val1188
                                                                                                         (list 'quote
                                                                                                               (make-binding278
                                                                                                                 'module
                                                                                                                 (make-resolved-interface420
                                                                                                                   val1188
                                                                                                                   sym1189))))))
                                                                                             x1186))
                                                                                         ctdefs1166)))))
                                                                          (ct-eval/residualize445
                                                                            ctem1152
                                                                            (lambda ()
                                                                              ((lambda (n1176)
                                                                                 ((lambda (token1177)
                                                                                    ((lambda (b1178)
                                                                                       ((lambda ()
                                                                                          (if n1176
                                                                                              (list '$sc-put-cte
                                                                                                    (list 'quote
                                                                                                          (if (same-marks?392
                                                                                                                (wrap-marks311
                                                                                                                  (syntax-object-wrap253
                                                                                                                    id1153))
                                                                                                                (wrap-marks311
                                                                                                                  '((top))))
                                                                                                              n1176
                                                                                                              ((lambda (marks1179)
                                                                                                                 (make-syntax-object250
                                                                                                                   n1176
                                                                                                                   (make-wrap310
                                                                                                                     marks1179
                                                                                                                     (list (make-ribcage351
                                                                                                                             (vector
                                                                                                                               n1176)
                                                                                                                             (vector
                                                                                                                               marks1179)
                                                                                                                             (vector
                                                                                                                               (generate-id137
                                                                                                                                 n1176)))))))
                                                                                                               (wrap-marks311
                                                                                                                 (syntax-object-wrap253
                                                                                                                   id1153)))))
                                                                                                    b1178)
                                                                                              ((lambda (n1180)
                                                                                                 (build-sequence236
                                                                                                   '#f
                                                                                                   (list (list '$sc-put-cte
                                                                                                               (list 'quote
                                                                                                                     n1180)
                                                                                                               b1178)
                                                                                                         (do-top-import441
                                                                                                           n1180
                                                                                                           token1177))))
                                                                                               (generate-id137
                                                                                                 'tmp))))))
                                                                                     (list 'quote
                                                                                           (make-binding278
                                                                                             'module
                                                                                             (make-resolved-interface420
                                                                                               exports1155
                                                                                               token1177)))))
                                                                                  (generate-id137
                                                                                    n1176)))
                                                                               (if id1153
                                                                                   ((lambda (x1181)
                                                                                      ((lambda (e1182)
                                                                                         (if (annotation?126
                                                                                               e1182)
                                                                                             (annotation-expression
                                                                                               e1182)
                                                                                             e1182))
                                                                                       (if (syntax-object?251
                                                                                             x1181)
                                                                                           (syntax-object-expression252
                                                                                             x1181)
                                                                                           x1181)))
                                                                                    id1153)
                                                                                   '#f))))
                                                                          (if (null?
                                                                                svs1167)
                                                                              (chi-void460)
                                                                              (build-sequence236
                                                                                '#f
                                                                                (map (lambda (v1185)
                                                                                       (list 'define
                                                                                             v1185
                                                                                             (chi-void460)))
                                                                                     svs1167)))
                                                                          (build-body238
                                                                            '#f
                                                                            dvs1170
                                                                            des1173
                                                                            (build-sequence236
                                                                              '#f
                                                                              (list (if (null?
                                                                                          svs1167)
                                                                                        (chi-void460)
                                                                                        (build-sequence236
                                                                                          '#f
                                                                                          (map (lambda (v1184
                                                                                                        e1183)
                                                                                                 (list 'set!
                                                                                                       v1184
                                                                                                       e1183))
                                                                                               svs1167
                                                                                               ses1175)))
                                                                                    (if (null?
                                                                                          inits1174)
                                                                                        (chi-void460)
                                                                                        (build-sequence236
                                                                                          '#f
                                                                                          inits1174)))))
                                                                          (chi-void460)))))
                                                         (map (lambda (x1198)
                                                                (chi446
                                                                  (cdr x1198)
                                                                  (car x1198)
                                                                  '(())))
                                                              ses1165)
                                                         (map (lambda (x1196)
                                                                (chi446
                                                                  (cdr x1196)
                                                                  (car x1196)
                                                                  '(())))
                                                              des1171)
                                                         (map (lambda (x1197)
                                                                (chi446
                                                                  (cdr x1197)
                                                                  (car x1197)
                                                                  '(())))
                                                              inits1161))
                                                        ((lambda (b1199)
                                                           ((lambda (t1200)
                                                              (if (memv t1200
                                                                        '(define-form))
                                                                  ((lambda (var1201)
                                                                     (begin (extend-store!435
                                                                              r1150
                                                                              (get-indirect-label346
                                                                                (module-binding-label425
                                                                                  b1199))
                                                                              (make-binding278
                                                                                'lexical
                                                                                var1201))
                                                                            (partition1169
                                                                              (cdr bs1172)
                                                                              (cons var1201
                                                                                    dvs1170)
                                                                              (cons (module-binding-val427
                                                                                      b1199)
                                                                                    des1171))))
                                                                   (gen-var465
                                                                     (module-binding-id424
                                                                       b1199)))
                                                                  (if (memv t1200
                                                                            '(define-syntax-form
                                                                               module-form))
                                                                      (partition1169
                                                                        (cdr bs1172)
                                                                        dvs1170
                                                                        des1171)
                                                                      (error 'sc-expand-internal
                                                                        '"unexpected module binding type"))))
                                                            (module-binding-type423
                                                              b1199)))
                                                         (car bs1172))))))
                                          partition1169)
                                        bs1164
                                        '()
                                        '())
                                       ((lambda (id1203 fexports1202)
                                          (letrec ((pluck-binding1204
                                                    (lambda (id1219
                                                             bs1216
                                                             succ1218
                                                             fail1217)
                                                      ((letrec ((loop1220
                                                                 (lambda (bs1222
                                                                          new-bs1221)
                                                                   (if (null?
                                                                         bs1222)
                                                                       (fail1217)
                                                                       (if (free-id=?397
                                                                             (module-binding-id424
                                                                               (car bs1222))
                                                                             id1219)
                                                                           (succ1218
                                                                             (car bs1222)
                                                                             (smart-append389
                                                                               (reverse
                                                                                 new-bs1221)
                                                                               (cdr bs1222)))
                                                                           (loop1220
                                                                             (cdr bs1222)
                                                                             (cons (car bs1222)
                                                                                   new-bs1221)))))))
                                                         loop1220)
                                                       bs1216
                                                       '()))))
                                            (pluck-binding1204
                                              id1203
                                              bs1164
                                              (lambda (b1206 bs1205)
                                                ((lambda (t1209
                                                          label1207
                                                          imps1208)
                                                   ((lambda (fexports1211
                                                             sym1210)
                                                      ((lambda (t1212)
                                                         (if (memv t1212
                                                                   '(define-form))
                                                             (begin (set-indirect-label!347
                                                                      label1207
                                                                      sym1210)
                                                                    (partition1163
                                                                      fexports1211
                                                                      bs1205
                                                                      (cons sym1210
                                                                            svs1167)
                                                                      (cons (module-binding-val427
                                                                              b1206)
                                                                            ses1165)
                                                                      ctdefs1166))
                                                             (if (memv t1212
                                                                       '(define-syntax-form))
                                                                 (partition1163
                                                                   fexports1211
                                                                   bs1205
                                                                   svs1167
                                                                   ses1165
                                                                   (cons (list t1209
                                                                               label1207
                                                                               sym1210
                                                                               (module-binding-val427
                                                                                 b1206))
                                                                         ctdefs1166))
                                                                 (if (memv t1212
                                                                           '(module-form))
                                                                     ((lambda (exports1213)
                                                                        (partition1163
                                                                          (append
                                                                            (flatten-exports412
                                                                              exports1213)
                                                                            fexports1211)
                                                                          bs1205
                                                                          svs1167
                                                                          ses1165
                                                                          (cons (list t1209
                                                                                      label1207
                                                                                      sym1210
                                                                                      exports1213)
                                                                                ctdefs1166)))
                                                                      (module-binding-val427
                                                                        b1206))
                                                                     (error 'sc-expand-internal
                                                                       '"unexpected module binding type")))))
                                                       t1209))
                                                    (append
                                                      imps1208
                                                      fexports1202)
                                                    (generate-id137
                                                      ((lambda (x1214)
                                                         ((lambda (e1215)
                                                            (if (annotation?126
                                                                  e1215)
                                                                (annotation-expression
                                                                  e1215)
                                                                e1215))
                                                          (if (syntax-object?251
                                                                x1214)
                                                              (syntax-object-expression252
                                                                x1214)
                                                              x1214)))
                                                       id1203))))
                                                 (module-binding-type423
                                                   b1206)
                                                 (module-binding-label425
                                                   b1206)
                                                 (module-binding-imps426
                                                   b1206)))
                                              (lambda ()
                                                (partition1163
                                                  fexports1202
                                                  bs1164
                                                  svs1167
                                                  ses1165
                                                  ctdefs1166)))))
                                        (car fexports1168)
                                        (cdr fexports1168))))))
                         partition1163)
                       fexports1160
                       bindings1162
                       '()
                       '()
                       '()))))
                (flatten-exports412 exports1155))))
            (id-set-diff434
             (lambda (exports1772 defs1771)
               (if (null? exports1772)
                   '()
                   (if (bound-id-member?403 (car exports1772) defs1771)
                       (id-set-diff434 (cdr exports1772) defs1771)
                       (cons (car exports1772)
                             (id-set-diff434
                               (cdr exports1772)
                               defs1771))))))
            (extend-store!435
             (lambda (r1226 label1224 binding1225)
               (set-cdr!
                 r1226
                 (extend-env293 label1224 binding1225 (cdr r1226)))))
            (check-module-exports436
             (lambda (source-exp1754 fexports1752 ids1753)
               (letrec ((defined?1755
                         (lambda (e1762 ids1761)
                           (ormap
                             (lambda (x1763)
                               (if (interface?414 x1763)
                                   ((lambda (token1764)
                                      (if token1764
                                          (lookup-import-binding-name386
                                            ((lambda (x1765)
                                               ((lambda (e1766)
                                                  (if (annotation?126
                                                        e1766)
                                                      (annotation-expression
                                                        e1766)
                                                      e1766))
                                                (if (syntax-object?251
                                                      x1765)
                                                    (syntax-object-expression252
                                                      x1765)
                                                    x1765)))
                                             e1762)
                                            token1764
                                            (wrap-marks311
                                              (syntax-object-wrap253
                                                e1762)))
                                          ((lambda (v1767)
                                             ((letrec ((lp1768
                                                        (lambda (i1769)
                                                          (if (>= i1769 '0)
                                                              ((lambda (t1770)
                                                                 (if t1770
                                                                     t1770
                                                                     (lp1768
                                                                       (- i1769
                                                                          '1))))
                                                               (bound-id=?399
                                                                 e1762
                                                                 (vector-ref
                                                                   v1767
                                                                   i1769)))
                                                              '#f))))
                                                lp1768)
                                              (- (vector-length v1767)
                                                 '1)))
                                           (interface-exports415 x1763))))
                                    (interface-token416 x1763))
                                   (bound-id=?399 e1762 x1763)))
                             ids1761))))
                 ((letrec ((loop1756
                            (lambda (fexports1758 missing1757)
                              (if (null? fexports1758)
                                  (if (not (null? missing1757))
                                      (syntax-error
                                        missing1757
                                        '"missing definition for export(s)")
                                      (void))
                                  ((lambda (e1760 fexports1759)
                                     (if (defined?1755 e1760 ids1753)
                                         (loop1756
                                           fexports1759
                                           missing1757)
                                         (loop1756
                                           fexports1759
                                           (cons e1760 missing1757))))
                                   (car fexports1758)
                                   (cdr fexports1758))))))
                    loop1756)
                  fexports1752
                  '()))))
            (check-defined-ids437
             (lambda (source-exp1228 ls1227)
               (letrec ((b-i=?1229
                         (lambda (x1266 y1265)
                           (if (symbol? x1266)
                               (if (symbol? y1265)
                                   (eq? x1266 y1265)
                                   (if (eq? x1266
                                            ((lambda (x1267)
                                               ((lambda (e1268)
                                                  (if (annotation?126
                                                        e1268)
                                                      (annotation-expression
                                                        e1268)
                                                      e1268))
                                                (if (syntax-object?251
                                                      x1267)
                                                    (syntax-object-expression252
                                                      x1267)
                                                    x1267)))
                                             y1265))
                                       (same-marks?392
                                         (wrap-marks311
                                           (syntax-object-wrap253 y1265))
                                         (wrap-marks311 '((top))))
                                       '#f))
                               (if (symbol? y1265)
                                   (if (eq? y1265
                                            ((lambda (x1269)
                                               ((lambda (e1270)
                                                  (if (annotation?126
                                                        e1270)
                                                      (annotation-expression
                                                        e1270)
                                                      e1270))
                                                (if (syntax-object?251
                                                      x1269)
                                                    (syntax-object-expression252
                                                      x1269)
                                                    x1269)))
                                             x1266))
                                       (same-marks?392
                                         (wrap-marks311
                                           (syntax-object-wrap253 x1266))
                                         (wrap-marks311 '((top))))
                                       '#f)
                                   (bound-id=?399 x1266 y1265)))))
                        (vfold1230
                         (lambda (v1243 p1241 cls1242)
                           ((lambda (len1244)
                              ((letrec ((lp1245
                                         (lambda (i1247 cls1246)
                                           (if (= i1247 len1244)
                                               cls1246
                                               (lp1245
                                                 (+ i1247 '1)
                                                 (p1241
                                                   (vector-ref v1243 i1247)
                                                   cls1246))))))
                                 lp1245)
                               '0
                               cls1242))
                            (vector-length v1243))))
                        (conflicts1231
                         (lambda (x1258 y1256 cls1257)
                           (if (interface?414 x1258)
                               (if (interface?414 y1256)
                                   (call-with-values
                                     (lambda ()
                                       ((lambda (xe1264 ye1263)
                                          (if (> (vector-length xe1264)
                                                 (vector-length ye1263))
                                              (values x1258 ye1263)
                                              (values y1256 xe1264)))
                                        (interface-exports415 x1258)
                                        (interface-exports415 y1256)))
                                     (lambda (iface1260 exports1259)
                                       (vfold1230
                                         exports1259
                                         (lambda (id1262 cls1261)
                                           (id-iface-conflicts1232
                                             id1262
                                             iface1260
                                             cls1261))
                                         cls1257)))
                                   (id-iface-conflicts1232
                                     y1256
                                     x1258
                                     cls1257))
                               (if (interface?414 y1256)
                                   (id-iface-conflicts1232
                                     x1258
                                     y1256
                                     cls1257)
                                   (if (b-i=?1229 x1258 y1256)
                                       (cons x1258 cls1257)
                                       cls1257)))))
                        (id-iface-conflicts1232
                         (lambda (id1250 iface1248 cls1249)
                           ((lambda (token1251)
                              (if token1251
                                  (if (lookup-import-binding-name386
                                        ((lambda (x1252)
                                           ((lambda (e1253)
                                              (if (annotation?126 e1253)
                                                  (annotation-expression
                                                    e1253)
                                                  e1253))
                                            (if (syntax-object?251 x1252)
                                                (syntax-object-expression252
                                                  x1252)
                                                x1252)))
                                         id1250)
                                        token1251
                                        (if (symbol? id1250)
                                            (wrap-marks311 '((top)))
                                            (wrap-marks311
                                              (syntax-object-wrap253
                                                id1250))))
                                      (cons id1250 cls1249)
                                      cls1249)
                                  (vfold1230
                                    (interface-exports415 iface1248)
                                    (lambda (*id1255 cls1254)
                                      (if (b-i=?1229 *id1255 id1250)
                                          (cons *id1255 cls1254)
                                          cls1254))
                                    cls1249)))
                            (interface-token416 iface1248)))))
                 (if (not (null? ls1227))
                     ((letrec ((lp1233
                                (lambda (x1236 ls1234 cls1235)
                                  (if (null? ls1234)
                                      (if (not (null? cls1235))
                                          ((lambda (cls1237)
                                             (syntax-error
                                               source-exp1228
                                               '"duplicate definition for "
                                               (symbol->string
                                                 (car cls1237))
                                               '" in"))
                                           (syntax-object->datum cls1235))
                                          (void))
                                      ((letrec ((lp21238
                                                 (lambda (ls21240 cls1239)
                                                   (if (null? ls21240)
                                                       (lp1233
                                                         (car ls1234)
                                                         (cdr ls1234)
                                                         cls1239)
                                                       (lp21238
                                                         (cdr ls21240)
                                                         (conflicts1231
                                                           x1236
                                                           (car ls21240)
                                                           cls1239))))))
                                         lp21238)
                                       ls1234
                                       cls1235)))))
                        lp1233)
                      (car ls1227)
                      (cdr ls1227)
                      '())
                     (void)))))
            (chi-external438
             (lambda (ribcage1670
                      source-exp1662
                      body1669
                      r1663
                      exports1668
                      fexports1664
                      ctem1667
                      rtem1665
                      k1666)
               (letrec ((return1671
                         (lambda (bindings1751 ids1749 inits1750)
                           (begin (check-defined-ids437
                                    source-exp1662
                                    ids1749)
                                  (check-module-exports436
                                    source-exp1662
                                    fexports1664
                                    ids1749)
                                  (k1666 bindings1751 inits1750))))
                        (get-implicit-exports1672
                         (lambda (id1740)
                           ((letrec ((f1741
                                      (lambda (exports1742)
                                        (if (null? exports1742)
                                            '()
                                            (if (if (pair?
                                                      (car exports1742))
                                                    (bound-id=?399
                                                      id1740
                                                      (caar exports1742))
                                                    '#f)
                                                (flatten-exports412
                                                  (cdar exports1742))
                                                (f1741
                                                  (cdr exports1742)))))))
                              f1741)
                            exports1668)))
                        (update-imp-exports1673
                         (lambda (bindings1744 exports1743)
                           ((lambda (exports1745)
                              (map (lambda (b1746)
                                     ((lambda (id1747)
                                        (if (not (bound-id-member?403
                                                   id1747
                                                   exports1745))
                                            b1746
                                            (make-module-binding421
                                              (module-binding-type423
                                                b1746)
                                              id1747
                                              (module-binding-label425
                                                b1746)
                                              (append
                                                (get-implicit-exports1672
                                                  id1747)
                                                (module-binding-imps426
                                                  b1746))
                                              (module-binding-val427
                                                b1746))))
                                      (module-binding-id424 b1746)))
                                   bindings1744))
                            (map (lambda (x1748)
                                   (if (pair? x1748) (car x1748) x1748))
                                 exports1743)))))
                 ((letrec ((parse1674
                            (lambda (body1678
                                     ids1675
                                     bindings1677
                                     inits1676)
                              (if (null? body1678)
                                  (return1671
                                    bindings1677
                                    ids1675
                                    inits1676)
                                  ((lambda (e1680 er1679)
                                     (call-with-values
                                       (lambda ()
                                         (syntax-type409
                                           e1680
                                           er1679
                                           '(())
                                           '#f
                                           ribcage1670))
                                       (lambda (type1685
                                                value1681
                                                e1684
                                                w1682
                                                s1683)
                                         ((lambda (t1686)
                                            (if (memv t1686 '(define-form))
                                                (parse-define456
                                                  e1684
                                                  w1682
                                                  s1683
                                                  (lambda (id1689
                                                           rhs1687
                                                           w1688)
                                                    ((lambda (id1690)
                                                       ((lambda (label1691)
                                                          ((lambda (imps1692)
                                                             ((lambda ()
                                                                (begin (extend-ribcage!382
                                                                         ribcage1670
                                                                         id1690
                                                                         label1691)
                                                                       (parse1674
                                                                         (cdr body1678)
                                                                         (cons id1690
                                                                               ids1675)
                                                                         (cons (make-module-binding421
                                                                                 type1685
                                                                                 id1690
                                                                                 label1691
                                                                                 imps1692
                                                                                 (cons er1679
                                                                                       (wrap404
                                                                                         rhs1687
                                                                                         w1688)))
                                                                               bindings1677)
                                                                         inits1676)))))
                                                           (get-implicit-exports1672
                                                             id1690)))
                                                        (gen-indirect-label345)))
                                                     (wrap404
                                                       id1689
                                                       w1688))))
                                                (if (memv t1686
                                                          '(define-syntax-form))
                                                    (parse-define-syntax457
                                                      e1684
                                                      w1682
                                                      s1683
                                                      (lambda (id1695
                                                               rhs1693
                                                               w1694)
                                                        ((lambda (id1696)
                                                           ((lambda (label1697)
                                                              ((lambda (imps1698)
                                                                 ((lambda (exp1699)
                                                                    ((lambda ()
                                                                       (begin (extend-store!435
                                                                                r1663
                                                                                (get-indirect-label346
                                                                                  label1697)
                                                                                (cons 'deferred
                                                                                      exp1699))
                                                                              (extend-ribcage!382
                                                                                ribcage1670
                                                                                id1696
                                                                                label1697)
                                                                              (parse1674
                                                                                (cdr body1678)
                                                                                (cons id1696
                                                                                      ids1675)
                                                                                (cons (make-module-binding421
                                                                                        type1685
                                                                                        id1696
                                                                                        label1697
                                                                                        imps1698
                                                                                        exp1699)
                                                                                      bindings1677)
                                                                                inits1676)))))
                                                                  (chi446
                                                                    rhs1693
                                                                    (transformer-env296
                                                                      er1679)
                                                                    w1694)))
                                                               (get-implicit-exports1672
                                                                 id1696)))
                                                            (gen-indirect-label345)))
                                                         (wrap404
                                                           id1695
                                                           w1694))))
                                                    (if (memv t1686
                                                              '(module-form))
                                                        ((lambda (*ribcage1700)
                                                           ((lambda (*w1701)
                                                              ((lambda ()
                                                                 (parse-module454
                                                                   e1684
                                                                   w1682
                                                                   s1683
                                                                   *w1701
                                                                   (lambda (id1704
                                                                            *exports1702
                                                                            forms1703)
                                                                     (chi-external438
                                                                       *ribcage1700
                                                                       (source-wrap405
                                                                         e1684
                                                                         w1682
                                                                         s1683)
                                                                       (map (lambda (d1712)
                                                                              (cons er1679
                                                                                    d1712))
                                                                            forms1703)
                                                                       r1663
                                                                       *exports1702
                                                                       (flatten-exports412
                                                                         *exports1702)
                                                                       ctem1667
                                                                       rtem1665
                                                                       (lambda (*bindings1706
                                                                                *inits1705)
                                                                         ((lambda (iface1707)
                                                                            ((lambda (bindings1708)
                                                                               ((lambda (inits1709)
                                                                                  ((lambda ()
                                                                                     (if id1704
                                                                                         ((lambda (label1711
                                                                                                   imps1710)
                                                                                            (begin (extend-store!435
                                                                                                     r1663
                                                                                                     (get-indirect-label346
                                                                                                       label1711)
                                                                                                     (make-binding278
                                                                                                       'module
                                                                                                       iface1707))
                                                                                                   (extend-ribcage!382
                                                                                                     ribcage1670
                                                                                                     id1704
                                                                                                     label1711)
                                                                                                   (parse1674
                                                                                                     (cdr body1678)
                                                                                                     (cons id1704
                                                                                                           ids1675)
                                                                                                     (cons (make-module-binding421
                                                                                                             type1685
                                                                                                             id1704
                                                                                                             label1711
                                                                                                             imps1710
                                                                                                             *exports1702)
                                                                                                           bindings1708)
                                                                                                     inits1709)))
                                                                                          (gen-indirect-label345)
                                                                                          (get-implicit-exports1672
                                                                                            id1704))
                                                                                         ((lambda ()
                                                                                            (begin (do-import!453
                                                                                                     iface1707
                                                                                                     ribcage1670)
                                                                                                   (parse1674
                                                                                                     (cdr body1678)
                                                                                                     (cons iface1707
                                                                                                           ids1675)
                                                                                                     bindings1708
                                                                                                     inits1709))))))))
                                                                                (append
                                                                                  inits1676
                                                                                  *inits1705)))
                                                                             (append
                                                                               (if id1704
                                                                                   *bindings1706
                                                                                   (update-imp-exports1673
                                                                                     *bindings1706
                                                                                     *exports1702))
                                                                               bindings1677)))
                                                                          (make-trimmed-interface419
                                                                            *exports1702)))))))))
                                                            (make-wrap310
                                                              (wrap-marks311
                                                                w1682)
                                                              (cons *ribcage1700
                                                                    (wrap-subst312
                                                                      w1682)))))
                                                         (make-ribcage351
                                                           '()
                                                           '()
                                                           '()))
                                                        (if (memv t1686
                                                                  '(import-form))
                                                            (parse-import455
                                                              e1684
                                                              w1682
                                                              s1683
                                                              (lambda (mid1713)
                                                                ((lambda (mlabel1714)
                                                                   ((lambda (binding1715)
                                                                      ((lambda (t1716)
                                                                         (if (memv t1716
                                                                                   '(module))
                                                                             ((lambda (iface1717)
                                                                                (begin (if value1681
                                                                                           (extend-ribcage-barrier!383
                                                                                             ribcage1670
                                                                                             value1681)
                                                                                           (void))
                                                                                       (do-import!453
                                                                                         iface1717
                                                                                         ribcage1670)
                                                                                       (parse1674
                                                                                         (cdr body1678)
                                                                                         (cons iface1717
                                                                                               ids1675)
                                                                                         (update-imp-exports1673
                                                                                           bindings1677
                                                                                           (vector->list
                                                                                             (interface-exports415
                                                                                               iface1717)))
                                                                                         inits1676)))
                                                                              (binding-value280
                                                                                binding1715))
                                                                             (if (memv t1716
                                                                                       '(displaced-lexical))
                                                                                 (displaced-lexical-error297
                                                                                   mid1713)
                                                                                 (syntax-error
                                                                                   mid1713
                                                                                   '"import from unknown module"))))
                                                                       (binding-type279
                                                                         binding1715)))
                                                                    (lookup300
                                                                      mlabel1714
                                                                      r1663)))
                                                                 (id-var-name396
                                                                   mid1713
                                                                   '(())))))
                                                            (if (memv t1686
                                                                      '(begin-form))
                                                                ((lambda (tmp1718)
                                                                   ((lambda (tmp1719)
                                                                      (if tmp1719
                                                                          (apply
                                                                            (lambda (_1721
                                                                                     e11720)
                                                                              (parse1674
                                                                                ((letrec ((f1722
                                                                                           (lambda (forms1723)
                                                                                             (if (null?
                                                                                                   forms1723)
                                                                                                 (cdr body1678)
                                                                                                 (cons (cons er1679
                                                                                                             (wrap404
                                                                                                               (car forms1723)
                                                                                                               w1682))
                                                                                                       (f1722
                                                                                                         (cdr forms1723)))))))
                                                                                   f1722)
                                                                                 e11720)
                                                                                ids1675
                                                                                bindings1677
                                                                                inits1676))
                                                                            tmp1719)
                                                                          (syntax-error
                                                                            tmp1718)))
                                                                    ($syntax-dispatch
                                                                      tmp1718
                                                                      '(any .
                                                                            each-any))))
                                                                 e1684)
                                                                (if (memv t1686
                                                                          '(eval-when-form))
                                                                    ((lambda (tmp1725)
                                                                       ((lambda (tmp1726)
                                                                          (if tmp1726
                                                                              (apply
                                                                                (lambda (_1729
                                                                                         x1727
                                                                                         e11728)
                                                                                  (parse1674
                                                                                    (if (memq 'eval
                                                                                              (chi-when-list408
                                                                                                x1727
                                                                                                w1682))
                                                                                        ((letrec ((f1731
                                                                                                   (lambda (forms1732)
                                                                                                     (if (null?
                                                                                                           forms1732)
                                                                                                         (cdr body1678)
                                                                                                         (cons (cons er1679
                                                                                                                     (wrap404
                                                                                                                       (car forms1732)
                                                                                                                       w1682))
                                                                                                               (f1731
                                                                                                                 (cdr forms1732)))))))
                                                                                           f1731)
                                                                                         e11728)
                                                                                        (cdr body1678))
                                                                                    ids1675
                                                                                    bindings1677
                                                                                    inits1676))
                                                                                tmp1726)
                                                                              (syntax-error
                                                                                tmp1725)))
                                                                        ($syntax-dispatch
                                                                          tmp1725
                                                                          '(any each-any
                                                                                .
                                                                                each-any))))
                                                                     e1684)
                                                                    (if (memv t1686
                                                                              '(local-syntax-form))
                                                                        (chi-local-syntax459
                                                                          value1681
                                                                          e1684
                                                                          er1679
                                                                          w1682
                                                                          s1683
                                                                          (lambda (forms1737
                                                                                   er1734
                                                                                   w1736
                                                                                   s1735)
                                                                            (parse1674
                                                                              ((letrec ((f1738
                                                                                         (lambda (forms1739)
                                                                                           (if (null?
                                                                                                 forms1739)
                                                                                               (cdr body1678)
                                                                                               (cons (cons er1734
                                                                                                           (wrap404
                                                                                                             (car forms1739)
                                                                                                             w1736))
                                                                                                     (f1738
                                                                                                       (cdr forms1739)))))))
                                                                                 f1738)
                                                                               forms1737)
                                                                              ids1675
                                                                              bindings1677
                                                                              inits1676)))
                                                                        (return1671
                                                                          bindings1677
                                                                          ids1675
                                                                          (append
                                                                            inits1676
                                                                            (cons (cons er1679
                                                                                        (source-wrap405
                                                                                          e1684
                                                                                          w1682
                                                                                          s1683))
                                                                                  (cdr body1678))))))))))))
                                          type1685))))
                                   (cdar body1678)
                                   (caar body1678))))))
                    parse1674)
                  body1669
                  '()
                  '()
                  '()))))
            (vmap439
             (lambda (fn1272 v1271)
               ((letrec ((doloop1273
                          (lambda (i1275 ls1274)
                            (if (< i1275 '0)
                                ls1274
                                (doloop1273
                                  (- i1275 '1)
                                  (cons (fn1272 (vector-ref v1271 i1275))
                                        ls1274))))))
                  doloop1273)
                (- (vector-length v1271) '1)
                '())))
            (vfor-each440
             (lambda (fn1658 v1657)
               ((lambda (len1659)
                  ((letrec ((doloop1660
                             (lambda (i1661)
                               (if (not (= i1661 len1659))
                                   (begin (fn1658 (vector-ref v1657 i1661))
                                          (doloop1660 (+ i1661 '1)))
                                   (void)))))
                     doloop1660)
                   '0))
                (vector-length v1657))))
            (do-top-import441
             (lambda (mid1277 token1276)
               (list '$sc-put-cte
                     (list 'quote mid1277)
                     (list 'quote
                           (make-binding278 'do-import token1276)))))
            (update-mode-set442
             ((lambda (table1651)
                (lambda (when-list1653 mode-set1652)
                  (remq '-
                        (apply
                          append
                          (map (lambda (m1654)
                                 ((lambda (row1655)
                                    (map (lambda (s1656)
                                           (cdr (assq s1656 row1655)))
                                         when-list1653))
                                  (cdr (assq m1654 table1651))))
                               mode-set1652)))))
              '((l (load . l)
                   (compile . c)
                   (visit . v)
                   (revisit . r)
                   (eval . -))
                (c (load . -)
                   (compile . -)
                   (visit . -)
                   (revisit . -)
                   (eval . c))
                (v (load . v)
                   (compile . c)
                   (visit . v)
                   (revisit . -)
                   (eval . -))
                (r (load . r)
                   (compile . c)
                   (visit . -)
                   (revisit . r)
                   (eval . -))
                (e (load . -)
                   (compile . -)
                   (visit . -)
                   (revisit . -)
                   (eval . e)))))
            (initial-mode-set443
             (lambda (when-list1279 compiling-a-file1278)
               (apply
                 append
                 (map (lambda (s1280)
                        (if compiling-a-file1278
                            ((lambda (t1281)
                               (if (memv t1281 '(compile))
                                   '(c)
                                   (if (memv t1281 '(load))
                                       '(l)
                                       (if (memv t1281 '(visit))
                                           '(v)
                                           (if (memv t1281 '(revisit))
                                               '(r)
                                               '())))))
                             s1280)
                            ((lambda (t1282)
                               (if (memv t1282 '(eval)) '(e) '()))
                             s1280)))
                      when-list1279))))
            (rt-eval/residualize444
             (lambda (rtem1646 thunk1645)
               (if (memq 'e rtem1646)
                   (thunk1645)
                   ((lambda (thunk1647)
                      (if (memq 'v rtem1646)
                          (if ((lambda (t1648)
                                 (if t1648 t1648 (memq 'r rtem1646)))
                               (memq 'l rtem1646))
                              (thunk1647)
                              (thunk1647))
                          (if ((lambda (t1649)
                                 (if t1649 t1649 (memq 'r rtem1646)))
                               (memq 'l rtem1646))
                              (thunk1647)
                              (chi-void460))))
                    (if (memq 'c rtem1646)
                        ((lambda (x1650)
                           (begin (top-level-eval-hook127 x1650)
                                  (lambda () x1650)))
                         (thunk1645))
                        thunk1645)))))
            (ct-eval/residualize445
             (lambda (ctem1284 thunk1283)
               (if (memq 'e ctem1284)
                   (begin (top-level-eval-hook127 (thunk1283))
                          (chi-void460))
                   ((lambda (thunk1285)
                      (if (memq 'r ctem1284)
                          (if ((lambda (t1286)
                                 (if t1286 t1286 (memq 'v ctem1284)))
                               (memq 'l ctem1284))
                              (thunk1285)
                              (thunk1285))
                          (if ((lambda (t1287)
                                 (if t1287 t1287 (memq 'v ctem1284)))
                               (memq 'l ctem1284))
                              (thunk1285)
                              (chi-void460))))
                    (if (memq 'c ctem1284)
                        ((lambda (x1288)
                           (begin (top-level-eval-hook127 x1288)
                                  (lambda () x1288)))
                         (thunk1283))
                        thunk1283)))))
            (chi446
             (lambda (e1639 r1637 w1638)
               (call-with-values
                 (lambda () (syntax-type409 e1639 r1637 w1638 '#f '#f))
                 (lambda (type1644 value1640 e1643 w1641 s1642)
                   (chi-expr447
                     type1644
                     value1640
                     e1643
                     r1637
                     w1641
                     s1642)))))
            (chi-expr447
             (lambda (type1294 value1289 e1293 r1290 w1292 s1291)
               ((lambda (t1295)
                  (if (memv t1295 '(lexical))
                      value1289
                      (if (memv t1295 '(core))
                          (value1289 e1293 r1290 w1292 s1291)
                          (if (memv t1295 '(lexical-call))
                              (chi-application448
                                value1289
                                e1293
                                r1290
                                w1292
                                s1291)
                              (if (memv t1295 '(constant))
                                  (list 'quote
                                        (strip464
                                          (source-wrap405
                                            e1293
                                            w1292
                                            s1291)
                                          '(())))
                                  (if (memv t1295 '(global))
                                      value1289
                                      (if (memv t1295 '(call))
                                          (chi-application448
                                            (chi446
                                              (car e1293)
                                              r1290
                                              w1292)
                                            e1293
                                            r1290
                                            w1292
                                            s1291)
                                          (if (memv t1295 '(begin-form))
                                              ((lambda (tmp1296)
                                                 ((lambda (tmp1297)
                                                    (if tmp1297
                                                        (apply
                                                          (lambda (_1300
                                                                   e11298
                                                                   e21299)
                                                            (chi-sequence406
                                                              (cons e11298
                                                                    e21299)
                                                              r1290
                                                              w1292
                                                              s1291))
                                                          tmp1297)
                                                        (syntax-error
                                                          tmp1296)))
                                                  ($syntax-dispatch
                                                    tmp1296
                                                    '(any any
                                                          .
                                                          each-any))))
                                               e1293)
                                              (if (memv t1295
                                                        '(local-syntax-form))
                                                  (chi-local-syntax459
                                                    value1289
                                                    e1293
                                                    r1290
                                                    w1292
                                                    s1291
                                                    chi-sequence406)
                                                  (if (memv t1295
                                                            '(eval-when-form))
                                                      ((lambda (tmp1302)
                                                         ((lambda (tmp1303)
                                                            (if tmp1303
                                                                (apply
                                                                  (lambda (_1307
                                                                           x1304
                                                                           e11306
                                                                           e21305)
                                                                    (if (memq 'eval
                                                                              (chi-when-list408
                                                                                x1304
                                                                                w1292))
                                                                        (chi-sequence406
                                                                          (cons e11306
                                                                                e21305)
                                                                          r1290
                                                                          w1292
                                                                          s1291)
                                                                        (chi-void460)))
                                                                  tmp1303)
                                                                (syntax-error
                                                                  tmp1302)))
                                                          ($syntax-dispatch
                                                            tmp1302
                                                            '(any each-any
                                                                  any
                                                                  .
                                                                  each-any))))
                                                       e1293)
                                                      (if (memv t1295
                                                                '(define-form
                                                                   define-syntax-form
                                                                   module-form
                                                                   import-form))
                                                          (syntax-error
                                                            (source-wrap405
                                                              e1293
                                                              w1292
                                                              s1291)
                                                            '"invalid context for definition")
                                                          (if (memv t1295
                                                                    '(syntax))
                                                              (syntax-error
                                                                (source-wrap405
                                                                  e1293
                                                                  w1292
                                                                  s1291)
                                                                '"reference to pattern variable outside syntax form")
                                                              (if (memv t1295
                                                                        '(displaced-lexical))
                                                                  (displaced-lexical-error297
                                                                    (source-wrap405
                                                                      e1293
                                                                      w1292
                                                                      s1291))
                                                                  (syntax-error
                                                                    (source-wrap405
                                                                      e1293
                                                                      w1292
                                                                      s1291)))))))))))))))
                type1294)))
            (chi-application448
             (lambda (x1629 e1625 r1628 w1626 s1627)
               ((lambda (tmp1630)
                  ((lambda (tmp1631)
                     (if tmp1631
                         (apply
                           (lambda (e01633 e11632)
                             (cons x1629
                                   (map (lambda (e1635)
                                          (chi446 e1635 r1628 w1626))
                                        e11632)))
                           tmp1631)
                         ((lambda (_1636)
                            (syntax-error
                              (source-wrap405 e1625 w1626 s1627)))
                          tmp1630)))
                   ($syntax-dispatch tmp1630 '(any . each-any))))
                e1625)))
            (chi-set!449
             (lambda (e1314 r1310 w1313 s1311 rib1312)
               ((lambda (tmp1315)
                  ((lambda (tmp1316)
                     (if (if tmp1316
                             (apply
                               (lambda (_1319 id1317 val1318)
                                 (id?303 id1317))
                               tmp1316)
                             '#f)
                         (apply
                           (lambda (_1322 id1320 val1321)
                             ((lambda (n1323)
                                ((lambda (b1324)
                                   ((lambda (t1325)
                                      (if (memv t1325 '(macro!))
                                          ((lambda (id1327 val1326)
                                             (syntax-type409
                                               (chi-macro450
                                                 (binding-value280 b1324)
                                                 (list '#(syntax-object set! ((top) #(ribcage () () ()) #(ribcage #(id val) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(t) #(("m" top)) #("i")) #(ribcage () () ()) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(b) #((top)) #("i")) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(n) #((top)) #("i")) #(ribcage #(_ id val) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(e r w s rib) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage (lambda-var-list gen-var strip strip* strip-annotation ellipsis? chi-void chi-local-syntax chi-lambda-clause parse-define-syntax parse-define parse-import parse-module do-import! chi-internal chi-body chi-macro chi-set! chi-application chi-expr chi ct-eval/residualize rt-eval/residualize initial-mode-set update-mode-set do-top-import vfor-each vmap chi-external check-defined-ids check-module-exports extend-store! id-set-diff chi-top-module set-module-binding-val! set-module-binding-imps! set-module-binding-label! set-module-binding-id! set-module-binding-type! module-binding-val module-binding-imps module-binding-label module-binding-id module-binding-type module-binding? make-module-binding make-resolved-interface make-trimmed-interface set-interface-token! set-interface-exports! interface-token interface-exports interface? make-interface flatten-exports chi-top chi-top-expr syntax-type chi-when-list chi-top-sequence chi-sequence source-wrap wrap bound-id-member? invalid-ids-error distinct-bound-ids? valid-bound-ids? bound-id=? literal-id=? free-id=? id-var-name id-var-name-loc id-var-name&marks id-var-name-loc&marks same-marks? join-marks join-wraps smart-append make-trimmed-syntax-object make-binding-wrap lookup-import-binding-name extend-ribcage-subst! extend-ribcage-barrier-help! extend-ribcage-barrier! extend-ribcage! make-empty-ribcage set-import-token-key! import-token-key import-token? make-import-token barrier-marker new-mark anti-mark the-anti-mark set-ribcage-labels! set-ribcage-marks! set-ribcage-symnames! ribcage-labels ribcage-marks ribcage-symnames ribcage? make-ribcage gen-labels label? gen-label set-indirect-label! get-indirect-label indirect-label? gen-indirect-label only-top-marked? top-marked? top-wrap empty-wrap wrap-subst wrap-marks make-wrap id-sym-name&marks id-sym-name id? nonsymbol-id? global-extend lookup sanitize-binding lookup* displaced-lexical-error transformer-env extend-var-env* extend-env* extend-env null-env binding? set-binding-value! set-binding-type! binding-value binding-type make-binding arg-check source-annotation no-source unannotate set-syntax-object-wrap! set-syntax-object-expression! syntax-object-wrap syntax-object-expression syntax-object? make-syntax-object self-evaluating? build-lexical-var build-body build-letrec build-sequence build-data build-primref build-lambda build-revisit-only build-visit-only build-cte-install build-module-definition build-global-definition build-global-assignment build-global-reference build-lexical-assignment build-lexical-reference build-conditional build-application generate-id get-import-binding get-global-definition-hook put-global-definition-hook gensym-hook error-hook local-eval-hook top-level-eval-hook annotation? fx>= fx<= fx> fx< fx= fx- fx+ noexpand let-values define-structure unless when) ((top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top)) ("i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()) #(ribcage (#(import-token *top*)) () ())))
                                                       id1327
                                                       val1326)
                                                 r1310
                                                 '(())
                                                 s1311
                                                 rib1312)
                                               r1310
                                               '(())
                                               s1311
                                               rib1312))
                                           (wrap404 id1320 w1313)
                                           (wrap404 val1321 w1313))
                                          (values
                                            'core
                                            (lambda (e1331
                                                     r1328
                                                     w1330
                                                     s1329)
                                              ((lambda (val1333 n1332)
                                                 ((lambda (b1334)
                                                    ((lambda (t1335)
                                                       (if (memv t1335
                                                                 '(lexical))
                                                           (list 'set!
                                                                 (binding-value280
                                                                   b1334)
                                                                 val1333)
                                                           (if (memv t1335
                                                                     '(global))
                                                               (list 'set!
                                                                     (binding-value280
                                                                       b1334)
                                                                     val1333)
                                                               (if (memv t1335
                                                                         '(displaced-lexical))
                                                                   (syntax-error
                                                                     (wrap404
                                                                       id1320
                                                                       w1330)
                                                                     '"identifier out of context")
                                                                   (syntax-error
                                                                     (source-wrap405
                                                                       e1331
                                                                       w1330
                                                                       s1329))))))
                                                     (binding-type279
                                                       b1334)))
                                                  (lookup300 n1332 r1328)))
                                               (chi446 val1321 r1328 w1330)
                                               (id-var-name396
                                                 id1320
                                                 w1330)))
                                            e1314
                                            w1313
                                            s1311)))
                                    (binding-type279 b1324)))
                                 (lookup300 n1323 r1310)))
                              (id-var-name396 id1320 w1313)))
                           tmp1316)
                         ((lambda (_1336)
                            (syntax-error
                              (source-wrap405 e1314 w1313 s1311)))
                          tmp1315)))
                   ($syntax-dispatch tmp1315 '(any any any))))
                e1314)))
            (chi-macro450
             (lambda (p1612 e1607 r1611 w1608 s1610 rib1609)
               (letrec ((rebuild-macro-output1613
                         (lambda (x1617 m1616)
                           (if (pair? x1617)
                               (cons (rebuild-macro-output1613
                                       (car x1617)
                                       m1616)
                                     (rebuild-macro-output1613
                                       (cdr x1617)
                                       m1616))
                               (if (syntax-object?251 x1617)
                                   ((lambda (w1618)
                                      ((lambda (ms1620 s1619)
                                         (make-syntax-object250
                                           (syntax-object-expression252
                                             x1617)
                                           (if (if (pair? ms1620)
                                                   (eq? (car ms1620) '#f)
                                                   '#f)
                                               (make-wrap310
                                                 (cdr ms1620)
                                                 (if rib1609
                                                     (cons rib1609
                                                           (cdr s1619))
                                                     (cdr s1619)))
                                               (make-wrap310
                                                 (cons m1616 ms1620)
                                                 (if rib1609
                                                     (cons rib1609
                                                           (cons 'shift
                                                                 s1619))
                                                     (cons 'shift
                                                           s1619))))))
                                       (wrap-marks311 w1618)
                                       (wrap-subst312 w1618)))
                                    (syntax-object-wrap253 x1617))
                                   (if (vector? x1617)
                                       ((lambda (n1621)
                                          ((lambda (v1622)
                                             ((lambda ()
                                                ((letrec ((doloop1623
                                                           (lambda (i1624)
                                                             (if (= i1624
                                                                    n1621)
                                                                 v1622
                                                                 (begin (vector-set!
                                                                          v1622
                                                                          i1624
                                                                          (rebuild-macro-output1613
                                                                            (vector-ref
                                                                              x1617
                                                                              i1624)
                                                                            m1616))
                                                                        (doloop1623
                                                                          (+ i1624
                                                                             '1)))))))
                                                   doloop1623)
                                                 '0))))
                                           (make-vector n1621)))
                                        (vector-length x1617))
                                       (if (symbol? x1617)
                                           (syntax-error
                                             (source-wrap405
                                               e1607
                                               w1608
                                               s1610)
                                             '"encountered raw symbol "
                                             (format '"~s" x1617)
                                             '" in output of macro")
                                           x1617)))))))
                 (rebuild-macro-output1613
                   ((lambda (out1614)
                      (if (procedure? out1614)
                          (out1614
                            (lambda (id1615)
                              (begin (if (not (identifier? id1615))
                                         (syntax-error
                                           id1615
                                           '"environment argument is not an identifier")
                                         (void))
                                     (lookup300
                                       (id-var-name396 id1615 '(()))
                                       r1611))))
                          out1614))
                    (p1612
                      (source-wrap405 e1607 (anti-mark368 w1608) s1610)))
                   (string '#\m)))))
            (chi-body451
             (lambda (body1340 outer-form1337 r1339 w1338)
               ((lambda (r1341)
                  ((lambda (ribcage1342)
                     ((lambda (w1343)
                        ((lambda (body1344)
                           ((lambda ()
                              (chi-internal452
                                ribcage1342
                                outer-form1337
                                body1344
                                r1341
                                (lambda (exprs1349
                                         ids1345
                                         vars1348
                                         vals1346
                                         inits1347)
                                  (begin (if (null? exprs1349)
                                             (syntax-error
                                               outer-form1337
                                               '"no expressions in body")
                                             (void))
                                         (build-body238
                                           '#f
                                           vars1348
                                           (map (lambda (x1351)
                                                  (chi446
                                                    (cdr x1351)
                                                    (car x1351)
                                                    '(())))
                                                vals1346)
                                           (build-sequence236
                                             '#f
                                             (map (lambda (x1350)
                                                    (chi446
                                                      (cdr x1350)
                                                      (car x1350)
                                                      '(())))
                                                  (append
                                                    inits1347
                                                    exprs1349))))))))))
                         (map (lambda (x1352)
                                (cons r1341 (wrap404 x1352 w1343)))
                              body1340)))
                      (make-wrap310
                        (wrap-marks311 w1338)
                        (cons ribcage1342 (wrap-subst312 w1338)))))
                   (make-ribcage351 '() '() '())))
                (cons '("placeholder" placeholder) r1339))))
            (chi-internal452
             (lambda (ribcage1531 source-exp1527 body1530 r1528 k1529)
               (letrec ((return1532
                         (lambda (exprs1606
                                  ids1602
                                  vars1605
                                  vals1603
                                  inits1604)
                           (begin (check-defined-ids437
                                    source-exp1527
                                    ids1602)
                                  (k1529
                                    exprs1606
                                    ids1602
                                    (reverse vars1605)
                                    (reverse vals1603)
                                    inits1604)))))
                 ((letrec ((parse1533
                            (lambda (body1538
                                     ids1534
                                     vars1537
                                     vals1535
                                     inits1536)
                              (if (null? body1538)
                                  (return1532
                                    body1538
                                    ids1534
                                    vars1537
                                    vals1535
                                    inits1536)
                                  ((lambda (e1540 er1539)
                                     (call-with-values
                                       (lambda ()
                                         (syntax-type409
                                           e1540
                                           er1539
                                           '(())
                                           '#f
                                           ribcage1531))
                                       (lambda (type1545
                                                value1541
                                                e1544
                                                w1542
                                                s1543)
                                         ((lambda (t1546)
                                            (if (memv t1546 '(define-form))
                                                (parse-define456
                                                  e1544
                                                  w1542
                                                  s1543
                                                  (lambda (id1549
                                                           rhs1547
                                                           w1548)
                                                    ((lambda (id1551
                                                              label1550)
                                                       ((lambda (var1552)
                                                          (begin (extend-ribcage!382
                                                                   ribcage1531
                                                                   id1551
                                                                   label1550)
                                                                 (extend-store!435
                                                                   r1528
                                                                   label1550
                                                                   (make-binding278
                                                                     'lexical
                                                                     var1552))
                                                                 (parse1533
                                                                   (cdr body1538)
                                                                   (cons id1551
                                                                         ids1534)
                                                                   (cons var1552
                                                                         vars1537)
                                                                   (cons (cons er1539
                                                                               (wrap404
                                                                                 rhs1547
                                                                                 w1548))
                                                                         vals1535)
                                                                   inits1536)))
                                                        (gen-var465
                                                          id1551)))
                                                     (wrap404 id1549 w1548)
                                                     (gen-label348))))
                                                (if (memv t1546
                                                          '(define-syntax-form))
                                                    (parse-define-syntax457
                                                      e1544
                                                      w1542
                                                      s1543
                                                      (lambda (id1555
                                                               rhs1553
                                                               w1554)
                                                        ((lambda (id1558
                                                                  label1556
                                                                  exp1557)
                                                           (begin (extend-ribcage!382
                                                                    ribcage1531
                                                                    id1558
                                                                    label1556)
                                                                  (extend-store!435
                                                                    r1528
                                                                    label1556
                                                                    (make-binding278
                                                                      'deferred
                                                                      exp1557))
                                                                  (parse1533
                                                                    (cdr body1538)
                                                                    (cons id1558
                                                                          ids1534)
                                                                    vars1537
                                                                    vals1535
                                                                    inits1536)))
                                                         (wrap404
                                                           id1555
                                                           w1554)
                                                         (gen-label348)
                                                         (chi446
                                                           rhs1553
                                                           (transformer-env296
                                                             er1539)
                                                           w1554))))
                                                    (if (memv t1546
                                                              '(module-form))
                                                        ((lambda (*ribcage1559)
                                                           ((lambda (*w1560)
                                                              ((lambda ()
                                                                 (parse-module454
                                                                   e1544
                                                                   w1542
                                                                   s1543
                                                                   *w1560
                                                                   (lambda (id1563
                                                                            exports1561
                                                                            forms1562)
                                                                     (chi-internal452
                                                                       *ribcage1559
                                                                       (source-wrap405
                                                                         e1544
                                                                         w1542
                                                                         s1543)
                                                                       (map (lambda (d1574)
                                                                              (cons er1539
                                                                                    d1574))
                                                                            forms1562)
                                                                       r1528
                                                                       (lambda (*body1568
                                                                                *ids1564
                                                                                *vars1567
                                                                                *vals1565
                                                                                *inits1566)
                                                                         (begin (check-module-exports436
                                                                                  source-exp1527
                                                                                  (flatten-exports412
                                                                                    exports1561)
                                                                                  *ids1564)
                                                                                ((lambda (iface1572
                                                                                          vars1569
                                                                                          vals1571
                                                                                          inits1570)
                                                                                   (if id1563
                                                                                       ((lambda (label1573)
                                                                                          (begin (extend-ribcage!382
                                                                                                   ribcage1531
                                                                                                   id1563
                                                                                                   label1573)
                                                                                                 (extend-store!435
                                                                                                   r1528
                                                                                                   label1573
                                                                                                   (make-binding278
                                                                                                     'module
                                                                                                     iface1572))
                                                                                                 (parse1533
                                                                                                   (cdr body1538)
                                                                                                   (cons id1563
                                                                                                         ids1534)
                                                                                                   vars1569
                                                                                                   vals1571
                                                                                                   inits1570)))
                                                                                        (gen-label348))
                                                                                       ((lambda ()
                                                                                          (begin (do-import!453
                                                                                                   iface1572
                                                                                                   ribcage1531)
                                                                                                 (parse1533
                                                                                                   (cdr body1538)
                                                                                                   (cons iface1572
                                                                                                         ids1534)
                                                                                                   vars1569
                                                                                                   vals1571
                                                                                                   inits1570))))))
                                                                                 (make-trimmed-interface419
                                                                                   exports1561)
                                                                                 (append
                                                                                   *vars1567
                                                                                   vars1537)
                                                                                 (append
                                                                                   *vals1565
                                                                                   vals1535)
                                                                                 (append
                                                                                   inits1536
                                                                                   *inits1566
                                                                                   *body1568))))))))))
                                                            (make-wrap310
                                                              (wrap-marks311
                                                                w1542)
                                                              (cons *ribcage1559
                                                                    (wrap-subst312
                                                                      w1542)))))
                                                         (make-ribcage351
                                                           '()
                                                           '()
                                                           '()))
                                                        (if (memv t1546
                                                                  '(import-form))
                                                            (parse-import455
                                                              e1544
                                                              w1542
                                                              s1543
                                                              (lambda (mid1575)
                                                                ((lambda (mlabel1576)
                                                                   ((lambda (binding1577)
                                                                      ((lambda (t1578)
                                                                         (if (memv t1578
                                                                                   '(module))
                                                                             ((lambda (iface1579)
                                                                                (begin (if value1541
                                                                                           (extend-ribcage-barrier!383
                                                                                             ribcage1531
                                                                                             value1541)
                                                                                           (void))
                                                                                       (do-import!453
                                                                                         iface1579
                                                                                         ribcage1531)
                                                                                       (parse1533
                                                                                         (cdr body1538)
                                                                                         (cons iface1579
                                                                                               ids1534)
                                                                                         vars1537
                                                                                         vals1535
                                                                                         inits1536)))
                                                                              (cdr binding1577))
                                                                             (if (memv t1578
                                                                                       '(displaced-lexical))
                                                                                 (displaced-lexical-error297
                                                                                   mid1575)
                                                                                 (syntax-error
                                                                                   mid1575
                                                                                   '"import from unknown module"))))
                                                                       (car binding1577)))
                                                                    (lookup300
                                                                      mlabel1576
                                                                      r1528)))
                                                                 (id-var-name396
                                                                   mid1575
                                                                   '(())))))
                                                            (if (memv t1546
                                                                      '(begin-form))
                                                                ((lambda (tmp1580)
                                                                   ((lambda (tmp1581)
                                                                      (if tmp1581
                                                                          (apply
                                                                            (lambda (_1583
                                                                                     e11582)
                                                                              (parse1533
                                                                                ((letrec ((f1584
                                                                                           (lambda (forms1585)
                                                                                             (if (null?
                                                                                                   forms1585)
                                                                                                 (cdr body1538)
                                                                                                 (cons (cons er1539
                                                                                                             (wrap404
                                                                                                               (car forms1585)
                                                                                                               w1542))
                                                                                                       (f1584
                                                                                                         (cdr forms1585)))))))
                                                                                   f1584)
                                                                                 e11582)
                                                                                ids1534
                                                                                vars1537
                                                                                vals1535
                                                                                inits1536))
                                                                            tmp1581)
                                                                          (syntax-error
                                                                            tmp1580)))
                                                                    ($syntax-dispatch
                                                                      tmp1580
                                                                      '(any .
                                                                            each-any))))
                                                                 e1544)
                                                                (if (memv t1546
                                                                          '(eval-when-form))
                                                                    ((lambda (tmp1587)
                                                                       ((lambda (tmp1588)
                                                                          (if tmp1588
                                                                              (apply
                                                                                (lambda (_1591
                                                                                         x1589
                                                                                         e11590)
                                                                                  (parse1533
                                                                                    (if (memq 'eval
                                                                                              (chi-when-list408
                                                                                                x1589
                                                                                                w1542))
                                                                                        ((letrec ((f1593
                                                                                                   (lambda (forms1594)
                                                                                                     (if (null?
                                                                                                           forms1594)
                                                                                                         (cdr body1538)
                                                                                                         (cons (cons er1539
                                                                                                                     (wrap404
                                                                                                                       (car forms1594)
                                                                                                                       w1542))
                                                                                                               (f1593
                                                                                                                 (cdr forms1594)))))))
                                                                                           f1593)
                                                                                         e11590)
                                                                                        (cdr body1538))
                                                                                    ids1534
                                                                                    vars1537
                                                                                    vals1535
                                                                                    inits1536))
                                                                                tmp1588)
                                                                              (syntax-error
                                                                                tmp1587)))
                                                                        ($syntax-dispatch
                                                                          tmp1587
                                                                          '(any each-any
                                                                                .
                                                                                each-any))))
                                                                     e1544)
                                                                    (if (memv t1546
                                                                              '(local-syntax-form))
                                                                        (chi-local-syntax459
                                                                          value1541
                                                                          e1544
                                                                          er1539
                                                                          w1542
                                                                          s1543
                                                                          (lambda (forms1599
                                                                                   er1596
                                                                                   w1598
                                                                                   s1597)
                                                                            (parse1533
                                                                              ((letrec ((f1600
                                                                                         (lambda (forms1601)
                                                                                           (if (null?
                                                                                                 forms1601)
                                                                                               (cdr body1538)
                                                                                               (cons (cons er1596
                                                                                                           (wrap404
                                                                                                             (car forms1601)
                                                                                                             w1598))
                                                                                                     (f1600
                                                                                                       (cdr forms1601)))))))
                                                                                 f1600)
                                                                               forms1599)
                                                                              ids1534
                                                                              vars1537
                                                                              vals1535
                                                                              inits1536)))
                                                                        (return1532
                                                                          (cons (cons er1539
                                                                                      (source-wrap405
                                                                                        e1544
                                                                                        w1542
                                                                                        s1543))
                                                                                (cdr body1538))
                                                                          ids1534
                                                                          vars1537
                                                                          vals1535
                                                                          inits1536)))))))))
                                          type1545))))
                                   (cdar body1538)
                                   (caar body1538))))))
                    parse1533)
                  body1530
                  '()
                  '()
                  '()
                  '()))))
            (do-import!453
             (lambda (interface1354 ribcage1353)
               ((lambda (token1355)
                  (if token1355
                      (extend-ribcage-subst!385 ribcage1353 token1355)
                      (vfor-each440
                        (lambda (id1356)
                          ((lambda (label11357)
                             (begin (if (not label11357)
                                        (syntax-error
                                          id1356
                                          '"exported identifier not visible")
                                        (void))
                                    (extend-ribcage!382
                                      ribcage1353
                                      id1356
                                      label11357)))
                           (id-var-name-loc395 id1356 '(()))))
                        (interface-exports415 interface1354))))
                (interface-token416 interface1354))))
            (parse-module454
             (lambda (e1495 w1491 s1494 *w1492 k1493)
               (letrec ((listify1496
                         (lambda (exports1521)
                           (if (null? exports1521)
                               '()
                               (cons ((lambda (tmp1522)
                                        ((lambda (tmp1523)
                                           (if tmp1523
                                               (apply
                                                 (lambda (ex1524)
                                                   (listify1496 ex1524))
                                                 tmp1523)
                                               ((lambda (x1526)
                                                  (if (id?303 x1526)
                                                      (wrap404
                                                        x1526
                                                        *w1492)
                                                      (syntax-error
                                                        (source-wrap405
                                                          e1495
                                                          w1491
                                                          s1494)
                                                        '"invalid exports list in")))
                                                tmp1522)))
                                         ($syntax-dispatch
                                           tmp1522
                                           'each-any)))
                                      (car exports1521))
                                     (listify1496 (cdr exports1521))))))
                        (return1497
                         (lambda (id1519 exports1517 forms1518)
                           (k1493
                             id1519
                             (listify1496 exports1517)
                             (map (lambda (x1520) (wrap404 x1520 *w1492))
                                  forms1518)))))
                 ((lambda (tmp1498)
                    ((lambda (tmp1499)
                       (if tmp1499
                           (apply
                             (lambda (_1502 ex1500 form1501)
                               (return1497 '#f ex1500 form1501))
                             tmp1499)
                           ((lambda (tmp1505)
                              (if (if tmp1505
                                      (apply
                                        (lambda (_1509
                                                 mid1506
                                                 ex1508
                                                 form1507)
                                          (id?303 mid1506))
                                        tmp1505)
                                      '#f)
                                  (apply
                                    (lambda (_1513 mid1510 ex1512 form1511)
                                      (return1497
                                        (wrap404 mid1510 w1491)
                                        ex1512
                                        form1511))
                                    tmp1505)
                                  ((lambda (_1516)
                                     (syntax-error
                                       (source-wrap405 e1495 w1491 s1494)))
                                   tmp1498)))
                            ($syntax-dispatch
                              tmp1498
                              '(any any each-any . each-any)))))
                     ($syntax-dispatch
                       tmp1498
                       '(any each-any . each-any))))
                  e1495))))
            (parse-import455
             (lambda (e1361 w1358 s1360 k1359)
               ((lambda (tmp1362)
                  ((lambda (tmp1363)
                     (if (if tmp1363
                             (apply
                               (lambda (_1365 mid1364) (id?303 mid1364))
                               tmp1363)
                             '#f)
                         (apply
                           (lambda (_1367 mid1366)
                             (k1359 (wrap404 mid1366 w1358)))
                           tmp1363)
                         ((lambda (_1368)
                            (syntax-error
                              (source-wrap405 e1361 w1358 s1360)))
                          tmp1362)))
                   ($syntax-dispatch tmp1362 '(any any))))
                e1361)))
            (parse-define456
             (lambda (e1464 w1461 s1463 k1462)
               ((lambda (tmp1465)
                  ((lambda (tmp1466)
                     (if (if tmp1466
                             (apply
                               (lambda (_1469 name1467 val1468)
                                 (id?303 name1467))
                               tmp1466)
                             '#f)
                         (apply
                           (lambda (_1472 name1470 val1471)
                             (k1462 name1470 val1471 w1461))
                           tmp1466)
                         ((lambda (tmp1473)
                            (if (if tmp1473
                                    (apply
                                      (lambda (_1478
                                               name1474
                                               args1477
                                               e11475
                                               e21476)
                                        (if (id?303 name1474)
                                            (valid-bound-ids?400
                                              (lambda-var-list466
                                                args1477))
                                            '#f))
                                      tmp1473)
                                    '#f)
                                (apply
                                  (lambda (_1483
                                           name1479
                                           args1482
                                           e11480
                                           e21481)
                                    (k1462
                                      (wrap404 name1479 w1461)
                                      (cons '#(syntax-object lambda ((top) #(ribcage #(_ name args e1 e2) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(e w s k) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage (lambda-var-list gen-var strip strip* strip-annotation ellipsis? chi-void chi-local-syntax chi-lambda-clause parse-define-syntax parse-define parse-import parse-module do-import! chi-internal chi-body chi-macro chi-set! chi-application chi-expr chi ct-eval/residualize rt-eval/residualize initial-mode-set update-mode-set do-top-import vfor-each vmap chi-external check-defined-ids check-module-exports extend-store! id-set-diff chi-top-module set-module-binding-val! set-module-binding-imps! set-module-binding-label! set-module-binding-id! set-module-binding-type! module-binding-val module-binding-imps module-binding-label module-binding-id module-binding-type module-binding? make-module-binding make-resolved-interface make-trimmed-interface set-interface-token! set-interface-exports! interface-token interface-exports interface? make-interface flatten-exports chi-top chi-top-expr syntax-type chi-when-list chi-top-sequence chi-sequence source-wrap wrap bound-id-member? invalid-ids-error distinct-bound-ids? valid-bound-ids? bound-id=? literal-id=? free-id=? id-var-name id-var-name-loc id-var-name&marks id-var-name-loc&marks same-marks? join-marks join-wraps smart-append make-trimmed-syntax-object make-binding-wrap lookup-import-binding-name extend-ribcage-subst! extend-ribcage-barrier-help! extend-ribcage-barrier! extend-ribcage! make-empty-ribcage set-import-token-key! import-token-key import-token? make-import-token barrier-marker new-mark anti-mark the-anti-mark set-ribcage-labels! set-ribcage-marks! set-ribcage-symnames! ribcage-labels ribcage-marks ribcage-symnames ribcage? make-ribcage gen-labels label? gen-label set-indirect-label! get-indirect-label indirect-label? gen-indirect-label only-top-marked? top-marked? top-wrap empty-wrap wrap-subst wrap-marks make-wrap id-sym-name&marks id-sym-name id? nonsymbol-id? global-extend lookup sanitize-binding lookup* displaced-lexical-error transformer-env extend-var-env* extend-env* extend-env null-env binding? set-binding-value! set-binding-type! binding-value binding-type make-binding arg-check source-annotation no-source unannotate set-syntax-object-wrap! set-syntax-object-expression! syntax-object-wrap syntax-object-expression syntax-object? make-syntax-object self-evaluating? build-lexical-var build-body build-letrec build-sequence build-data build-primref build-lambda build-revisit-only build-visit-only build-cte-install build-module-definition build-global-definition build-global-assignment build-global-reference build-lexical-assignment build-lexical-reference build-conditional build-application generate-id get-import-binding get-global-definition-hook put-global-definition-hook gensym-hook error-hook local-eval-hook top-level-eval-hook annotation? fx>= fx<= fx> fx< fx= fx- fx+ noexpand let-values define-structure unless when) ((top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top)) ("i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()) #(ribcage (#(import-token *top*)) () ())))
                                            (wrap404
                                              (cons args1482
                                                    (cons e11480 e21481))
                                              w1461))
                                      '(())))
                                  tmp1473)
                                ((lambda (tmp1485)
                                   (if (if tmp1485
                                           (apply
                                             (lambda (_1487 name1486)
                                               (id?303 name1486))
                                             tmp1485)
                                           '#f)
                                       (apply
                                         (lambda (_1489 name1488)
                                           (k1462
                                             (wrap404 name1488 w1461)
                                             '#(syntax-object (void) ((top) #(ribcage #(_ name) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(e w s k) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage (lambda-var-list gen-var strip strip* strip-annotation ellipsis? chi-void chi-local-syntax chi-lambda-clause parse-define-syntax parse-define parse-import parse-module do-import! chi-internal chi-body chi-macro chi-set! chi-application chi-expr chi ct-eval/residualize rt-eval/residualize initial-mode-set update-mode-set do-top-import vfor-each vmap chi-external check-defined-ids check-module-exports extend-store! id-set-diff chi-top-module set-module-binding-val! set-module-binding-imps! set-module-binding-label! set-module-binding-id! set-module-binding-type! module-binding-val module-binding-imps module-binding-label module-binding-id module-binding-type module-binding? make-module-binding make-resolved-interface make-trimmed-interface set-interface-token! set-interface-exports! interface-token interface-exports interface? make-interface flatten-exports chi-top chi-top-expr syntax-type chi-when-list chi-top-sequence chi-sequence source-wrap wrap bound-id-member? invalid-ids-error distinct-bound-ids? valid-bound-ids? bound-id=? literal-id=? free-id=? id-var-name id-var-name-loc id-var-name&marks id-var-name-loc&marks same-marks? join-marks join-wraps smart-append make-trimmed-syntax-object make-binding-wrap lookup-import-binding-name extend-ribcage-subst! extend-ribcage-barrier-help! extend-ribcage-barrier! extend-ribcage! make-empty-ribcage set-import-token-key! import-token-key import-token? make-import-token barrier-marker new-mark anti-mark the-anti-mark set-ribcage-labels! set-ribcage-marks! set-ribcage-symnames! ribcage-labels ribcage-marks ribcage-symnames ribcage? make-ribcage gen-labels label? gen-label set-indirect-label! get-indirect-label indirect-label? gen-indirect-label only-top-marked? top-marked? top-wrap empty-wrap wrap-subst wrap-marks make-wrap id-sym-name&marks id-sym-name id? nonsymbol-id? global-extend lookup sanitize-binding lookup* displaced-lexical-error transformer-env extend-var-env* extend-env* extend-env null-env binding? set-binding-value! set-binding-type! binding-value binding-type make-binding arg-check source-annotation no-source unannotate set-syntax-object-wrap! set-syntax-object-expression! syntax-object-wrap syntax-object-expression syntax-object? make-syntax-object self-evaluating? build-lexical-var build-body build-letrec build-sequence build-data build-primref build-lambda build-revisit-only build-visit-only build-cte-install build-module-definition build-global-definition build-global-assignment build-global-reference build-lexical-assignment build-lexical-reference build-conditional build-application generate-id get-import-binding get-global-definition-hook put-global-definition-hook gensym-hook error-hook local-eval-hook top-level-eval-hook annotation? fx>= fx<= fx> fx< fx= fx- fx+ noexpand let-values define-structure unless when) ((top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top)) ("i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()) #(ribcage (#(import-token *top*)) () ())))
                                             '(())))
                                         tmp1485)
                                       ((lambda (_1490)
                                          (syntax-error
                                            (source-wrap405
                                              e1464
                                              w1461
                                              s1463)))
                                        tmp1465)))
                                 ($syntax-dispatch tmp1465 '(any any)))))
                          ($syntax-dispatch
                            tmp1465
                            '(any (any . any) any . each-any)))))
                   ($syntax-dispatch tmp1465 '(any any any))))
                e1464)))
            (parse-define-syntax457
             (lambda (e1372 w1369 s1371 k1370)
               ((lambda (tmp1373)
                  ((lambda (tmp1374)
                     (if (if tmp1374
                             (apply
                               (lambda (_1377 name1375 val1376)
                                 (id?303 name1375))
                               tmp1374)
                             '#f)
                         (apply
                           (lambda (_1380 name1378 val1379)
                             (k1370 name1378 val1379 w1369))
                           tmp1374)
                         ((lambda (_1381)
                            (syntax-error
                              (source-wrap405 e1372 w1369 s1371)))
                          tmp1373)))
                   ($syntax-dispatch tmp1373 '(any any any))))
                e1372)))
            (chi-lambda-clause458
             (lambda (e1438 c1434 r1437 w1435 k1436)
               ((lambda (tmp1439)
                  ((lambda (tmp1440)
                     (if tmp1440
                         (apply
                           (lambda (id1443 e11441 e21442)
                             ((lambda (ids1444)
                                (if (not (valid-bound-ids?400 ids1444))
                                    (syntax-error
                                      e1438
                                      '"invalid parameter list in")
                                    ((lambda (labels1446 new-vars1445)
                                       (k1436
                                         new-vars1445
                                         (chi-body451
                                           (cons e11441 e21442)
                                           e1438
                                           (extend-var-env*295
                                             labels1446
                                             new-vars1445
                                             r1437)
                                           (make-binding-wrap387
                                             ids1444
                                             labels1446
                                             w1435))))
                                     (gen-labels350 ids1444)
                                     (map gen-var465 ids1444))))
                              id1443))
                           tmp1440)
                         ((lambda (tmp1449)
                            (if tmp1449
                                (apply
                                  (lambda (ids1452 e11450 e21451)
                                    ((lambda (old-ids1453)
                                       (if (not (valid-bound-ids?400
                                                  old-ids1453))
                                           (syntax-error
                                             e1438
                                             '"invalid parameter list in")
                                           ((lambda (labels1455
                                                     new-vars1454)
                                              (k1436
                                                ((letrec ((f1457
                                                           (lambda (ls11459
                                                                    ls21458)
                                                             (if (null?
                                                                   ls11459)
                                                                 ls21458
                                                                 (f1457
                                                                   (cdr ls11459)
                                                                   (cons (car ls11459)
                                                                         ls21458))))))
                                                   f1457)
                                                 (cdr new-vars1454)
                                                 (car new-vars1454))
                                                (chi-body451
                                                  (cons e11450 e21451)
                                                  e1438
                                                  (extend-var-env*295
                                                    labels1455
                                                    new-vars1454
                                                    r1437)
                                                  (make-binding-wrap387
                                                    old-ids1453
                                                    labels1455
                                                    w1435))))
                                            (gen-labels350 old-ids1453)
                                            (map gen-var465 old-ids1453))))
                                     (lambda-var-list466 ids1452)))
                                  tmp1449)
                                ((lambda (_1460) (syntax-error e1438))
                                 tmp1439)))
                          ($syntax-dispatch
                            tmp1439
                            '(any any . each-any)))))
                   ($syntax-dispatch tmp1439 '(each-any any . each-any))))
                c1434)))
            (chi-local-syntax459
             (lambda (rec?1387 e1382 r1386 w1383 s1385 k1384)
               ((lambda (tmp1388)
                  ((lambda (tmp1389)
                     (if tmp1389
                         (apply
                           (lambda (_1394 id1390 val1393 e11391 e21392)
                             ((lambda (ids1395)
                                (if (not (valid-bound-ids?400 ids1395))
                                    (invalid-ids-error402
                                      (map (lambda (x1396)
                                             (wrap404 x1396 w1383))
                                           ids1395)
                                      (source-wrap405 e1382 w1383 s1385)
                                      '"keyword")
                                    ((lambda (labels1397)
                                       ((lambda (new-w1398)
                                          (k1384
                                            (cons e11391 e21392)
                                            (extend-env*294
                                              labels1397
                                              ((lambda (w1400 trans-r1399)
                                                 (map (lambda (x1402)
                                                        (make-binding278
                                                          'deferred
                                                          (chi446
                                                            x1402
                                                            trans-r1399
                                                            w1400)))
                                                      val1393))
                                               (if rec?1387
                                                   new-w1398
                                                   w1383)
                                               (transformer-env296 r1386))
                                              r1386)
                                            new-w1398
                                            s1385))
                                        (make-binding-wrap387
                                          ids1395
                                          labels1397
                                          w1383)))
                                     (gen-labels350 ids1395))))
                              id1390))
                           tmp1389)
                         ((lambda (_1405)
                            (syntax-error
                              (source-wrap405 e1382 w1383 s1385)))
                          tmp1388)))
                   ($syntax-dispatch
                     tmp1388
                     '(any #(each (any any)) any . each-any))))
                e1382)))
            (chi-void460 (lambda () (list 'void)))
            (ellipsis?461
             (lambda (x1406)
               (if (nonsymbol-id?302 x1406)
                   (literal-id=?398
                     x1406
                     '#(syntax-object ... ((top) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (lambda-var-list gen-var strip strip* strip-annotation ellipsis? chi-void chi-local-syntax chi-lambda-clause parse-define-syntax parse-define parse-import parse-module do-import! chi-internal chi-body chi-macro chi-set! chi-application chi-expr chi ct-eval/residualize rt-eval/residualize initial-mode-set update-mode-set do-top-import vfor-each vmap chi-external check-defined-ids check-module-exports extend-store! id-set-diff chi-top-module set-module-binding-val! set-module-binding-imps! set-module-binding-label! set-module-binding-id! set-module-binding-type! module-binding-val module-binding-imps module-binding-label module-binding-id module-binding-type module-binding? make-module-binding make-resolved-interface make-trimmed-interface set-interface-token! set-interface-exports! interface-token interface-exports interface? make-interface flatten-exports chi-top chi-top-expr syntax-type chi-when-list chi-top-sequence chi-sequence source-wrap wrap bound-id-member? invalid-ids-error distinct-bound-ids? valid-bound-ids? bound-id=? literal-id=? free-id=? id-var-name id-var-name-loc id-var-name&marks id-var-name-loc&marks same-marks? join-marks join-wraps smart-append make-trimmed-syntax-object make-binding-wrap lookup-import-binding-name extend-ribcage-subst! extend-ribcage-barrier-help! extend-ribcage-barrier! extend-ribcage! make-empty-ribcage set-import-token-key! import-token-key import-token? make-import-token barrier-marker new-mark anti-mark the-anti-mark set-ribcage-labels! set-ribcage-marks! set-ribcage-symnames! ribcage-labels ribcage-marks ribcage-symnames ribcage? make-ribcage gen-labels label? gen-label set-indirect-label! get-indirect-label indirect-label? gen-indirect-label only-top-marked? top-marked? top-wrap empty-wrap wrap-subst wrap-marks make-wrap id-sym-name&marks id-sym-name id? nonsymbol-id? global-extend lookup sanitize-binding lookup* displaced-lexical-error transformer-env extend-var-env* extend-env* extend-env null-env binding? set-binding-value! set-binding-type! binding-value binding-type make-binding arg-check source-annotation no-source unannotate set-syntax-object-wrap! set-syntax-object-expression! syntax-object-wrap syntax-object-expression syntax-object? make-syntax-object self-evaluating? build-lexical-var build-body build-letrec build-sequence build-data build-primref build-lambda build-revisit-only build-visit-only build-cte-install build-module-definition build-global-definition build-global-assignment build-global-reference build-lexical-assignment build-lexical-reference build-conditional build-application generate-id get-import-binding get-global-definition-hook put-global-definition-hook gensym-hook error-hook local-eval-hook top-level-eval-hook annotation? fx>= fx<= fx> fx< fx= fx- fx+ noexpand let-values define-structure unless when) ((top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top) (top)) ("i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()) #(ribcage (#(import-token *top*)) () ()))))
                   '#f)))
            (strip-annotation462
             (lambda (x1428 parent1427)
               (if (pair? x1428)
                   ((lambda (new1429)
                      (begin (if parent1427
                                 (set-annotation-stripped!
                                   parent1427
                                   new1429)
                                 (void))
                             (set-car!
                               new1429
                               (strip-annotation462 (car x1428) '#f))
                             (set-cdr!
                               new1429
                               (strip-annotation462 (cdr x1428) '#f))
                             new1429))
                    (cons '#f '#f))
                   (if (annotation?126 x1428)
                       ((lambda (t1430)
                          (if t1430
                              t1430
                              (strip-annotation462
                                (annotation-expression x1428)
                                x1428)))
                        (annotation-stripped x1428))
                       (if (vector? x1428)
                           ((lambda (new1431)
                              (begin (if parent1427
                                         (set-annotation-stripped!
                                           parent1427
                                           new1431)
                                         (void))
                                     ((letrec ((loop1432
                                                (lambda (i1433)
                                                  (if (not (< i1433 '0))
                                                      (begin (vector-set!
                                                               new1431
                                                               i1433
                                                               (strip-annotation462
                                                                 (vector-ref
                                                                   x1428
                                                                   i1433)
                                                                 '#f))
                                                             (loop1432
                                                               (- i1433
                                                                  '1)))
                                                      (void)))))
                                        loop1432)
                                      (- (vector-length x1428) '1))
                                     new1431))
                            (make-vector (vector-length x1428)))
                           x1428)))))
            (strip*463
             (lambda (x1409 w1407 fn1408)
               (if (memq 'top (wrap-marks311 w1407))
                   (fn1408 x1409)
                   ((letrec ((f1410
                              (lambda (x1411)
                                (if (syntax-object?251 x1411)
                                    (strip*463
                                      (syntax-object-expression252 x1411)
                                      (syntax-object-wrap253 x1411)
                                      fn1408)
                                    (if (pair? x1411)
                                        ((lambda (a1413 d1412)
                                           (if (if (eq? a1413 (car x1411))
                                                   (eq? d1412 (cdr x1411))
                                                   '#f)
                                               x1411
                                               (cons a1413 d1412)))
                                         (f1410 (car x1411))
                                         (f1410 (cdr x1411)))
                                        (if (vector? x1411)
                                            ((lambda (old1414)
                                               ((lambda (new1415)
                                                  (if (andmap
                                                        eq?
                                                        old1414
                                                        new1415)
                                                      x1411
                                                      (list->vector
                                                        new1415)))
                                                (map f1410 old1414)))
                                             (vector->list x1411))
                                            x1411))))))
                      f1410)
                    x1409))))
            (strip464
             (lambda (x1424 w1423)
               (strip*463
                 x1424
                 w1423
                 (lambda (x1425)
                   (if ((lambda (t1426)
                          (if t1426
                              t1426
                              (if (pair? x1425)
                                  (annotation?126 (car x1425))
                                  '#f)))
                        (annotation?126 x1425))
                       (strip-annotation462 x1425 '#f)
                       x1425)))))
            (gen-var465
             (lambda (id1416)
               ((lambda (id1417)
                  (if (annotation?126 id1417) (gensym) (gensym)))
                (if (syntax-object?251 id1416)
                    (syntax-object-expression252 id1416)
                    id1416))))
            (lambda-var-list466
             (lambda (vars1418)
               ((letrec ((lvl1419
                          (lambda (vars1422 ls1420 w1421)
                            (if (pair? vars1422)
                                (lvl1419
                                  (cdr vars1422)
                                  (cons (wrap404 (car vars1422) w1421)
                                        ls1420)
                                  w1421)
                                (if (id?303 vars1422)
                                    (cons (wrap404 vars1422 w1421) ls1420)
                                    (if (null? vars1422)
                                        ls1420
                                        (if (syntax-object?251 vars1422)
                                            (lvl1419
                                              (syntax-object-expression252
                                                vars1422)
                                              ls1420
                                              (join-wraps390
                                                w1421
                                                (syntax-object-wrap253
                                                  vars1422)))
                                            (if (annotation?126 vars1422)
                                                (lvl1419
                                                  (annotation-expression
                                                    vars1422)
                                                  ls1420
                                                  w1421)
                                                (cons vars1422
                                                      ls1420)))))))))
                  lvl1419)
                vars1418
                '()
                '(())))))
     (begin (set! $sc-put-cte
              (lambda (id870 b869)
                (letrec ((put-token871
                          (lambda (id889 token888)
                            (letrec ((cons-id890
                                      (lambda (id900 x899)
                                        (if (not x899)
                                            id900
                                            (cons id900 x899))))
                                     (weed891
                                      (lambda (id897 x896)
                                        (if (pair? x896)
                                            (if (bound-id=?399
                                                  (car x896)
                                                  id897)
                                                (weed891 id897 (cdr x896))
                                                (cons-id890
                                                  (car x896)
                                                  (weed891
                                                    id897
                                                    (cdr x896))))
                                            (if ((lambda (t898)
                                                   (if t898
                                                       t898
                                                       (bound-id=?399
                                                         x896
                                                         id897)))
                                                 (not x896))
                                                '#f
                                                x896)))))
                              ((lambda (sym892)
                                 ((lambda (x893)
                                    (if (if (not x893) (symbol? id889) '#f)
                                        (remprop sym892 token888)
                                        (putprop
                                          sym892
                                          token888
                                          (cons-id890 id889 x893))))
                                  (weed891
                                    id889
                                    (getprop sym892 token888))))
                               ((lambda (x894)
                                  ((lambda (e895)
                                     (if (annotation?126 e895)
                                         (annotation-expression e895)
                                         e895))
                                   (if (syntax-object?251 x894)
                                       (syntax-object-expression252 x894)
                                       x894)))
                                id889)))))
                         (sc-put-module872
                          (lambda (exports883 token882)
                            (vfor-each440
                              (lambda (id884)
                                (put-token871 id884 token882))
                              exports883)))
                         (put-cte873
                          (lambda (id886 binding885)
                            (begin (put-token871 id886 '*top*)
                                   ((lambda (sym887)
                                      (putprop
                                        sym887
                                        '*sc-expander*
                                        binding885))
                                    (if (symbol? id886)
                                        id886
                                        (id-var-name396 id886 '(()))))))))
                  ((lambda (binding874)
                     ((lambda (t875)
                        (if (memv t875 '(module))
                            (begin ((lambda (iface876)
                                      (sc-put-module872
                                        (interface-exports415 iface876)
                                        (interface-token416 iface876)))
                                    (binding-value280 binding874))
                                   (put-cte873 id870 binding874))
                            (if (memv t875 '(do-import))
                                ((lambda (token877)
                                   ((lambda (b878)
                                      ((lambda (t879)
                                         (if (memv t879 '(module))
                                             ((lambda (iface880)
                                                (begin (if (not (eq? (interface-token416
                                                                       iface880)
                                                                     token877))
                                                           (syntax-error
                                                             id870
                                                             '"import mismatch for module")
                                                           (void))
                                                       (sc-put-module872
                                                         (interface-exports415
                                                           iface880)
                                                         '*top*)))
                                              (binding-value280 b878))
                                             (syntax-error
                                               id870
                                               '"import from unknown module")))
                                       (binding-type279 b878)))
                                    (lookup300
                                      (id-var-name396 id870 '(()))
                                      '())))
                                 (binding-value280 b869))
                                (put-cte873 id870 binding874))))
                      (binding-type279 binding874)))
                   ((lambda (t881)
                      (if t881
                          t881
                          (error 'define-syntax
                            '"invalid transformer ~s"
                            b869)))
                    (sanitize-binding299 b869))))))
            (global-extend301 'local-syntax 'letrec-syntax '#t)
            (global-extend301 'local-syntax 'let-syntax '#f)
            (global-extend301
              'core
              'fluid-let-syntax
              (lambda (e470 r467 w469 s468)
                ((lambda (tmp471)
                   ((lambda (tmp472)
                      (if (if tmp472
                              (apply
                                (lambda (_477 var473 val476 e1474 e2475)
                                  (valid-bound-ids?400 var473))
                                tmp472)
                              '#f)
                          (apply
                            (lambda (_483 var479 val482 e1480 e2481)
                              ((lambda (names484)
                                 (begin (for-each
                                          (lambda (id491 n490)
                                            ((lambda (t492)
                                               (if (memv t492
                                                         '(displaced-lexical))
                                                   (displaced-lexical-error297
                                                     (wrap404 id491 w469))
                                                   (void)))
                                             (binding-type279
                                               (lookup300 n490 r467))))
                                          var479
                                          names484)
                                        (chi-body451
                                          (cons e1480 e2481)
                                          (source-wrap405 e470 w469 s468)
                                          (extend-env*294
                                            names484
                                            ((lambda (trans-r485)
                                               (map (lambda (x487)
                                                      (make-binding278
                                                        'deferred
                                                        (chi446
                                                          x487
                                                          trans-r485
                                                          w469)))
                                                    val482))
                                             (transformer-env296 r467))
                                            r467)
                                          w469)))
                               (map (lambda (x494)
                                      (id-var-name396 x494 w469))
                                    var479)))
                            tmp472)
                          ((lambda (_495)
                             (syntax-error
                               (source-wrap405 e470 w469 s468)))
                           tmp471)))
                    ($syntax-dispatch
                      tmp471
                      '(any #(each (any any)) any . each-any))))
                 e470)))
            (global-extend301
              'core
              'quote
              (lambda (e863 r860 w862 s861)
                ((lambda (tmp864)
                   ((lambda (tmp865)
                      (if tmp865
                          (apply
                            (lambda (_867 e866)
                              (list 'quote (strip464 e866 w862)))
                            tmp865)
                          ((lambda (_868)
                             (syntax-error
                               (source-wrap405 e863 w862 s861)))
                           tmp864)))
                    ($syntax-dispatch tmp864 '(any any))))
                 e863)))
            (global-extend301
              'core
              'syntax
              ((lambda ()
                 (letrec ((gen-syntax496
                           (lambda (src554 e550 r553 maps551 ellipsis?552)
                             (if (id?303 e550)
                                 ((lambda (label555)
                                    ((lambda (b556)
                                       (if (eq? (binding-type279 b556)
                                                'syntax)
                                           (call-with-values
                                             (lambda ()
                                               ((lambda (var.lev559)
                                                  (gen-ref497
                                                    src554
                                                    (car var.lev559)
                                                    (cdr var.lev559)
                                                    maps551))
                                                (binding-value280 b556)))
                                             (lambda (var558 maps557)
                                               (values
                                                 (list 'ref var558)
                                                 maps557)))
                                           (if (ellipsis?552 e550)
                                               (syntax-error
                                                 src554
                                                 '"misplaced ellipsis in syntax form")
                                               (values
                                                 (list 'quote e550)
                                                 maps551))))
                                     (lookup300 label555 r553)))
                                  (id-var-name396 e550 '(())))
                                 ((lambda (tmp560)
                                    ((lambda (tmp561)
                                       (if (if tmp561
                                               (apply
                                                 (lambda (dots563 e562)
                                                   (ellipsis?552 dots563))
                                                 tmp561)
                                               '#f)
                                           (apply
                                             (lambda (dots565 e564)
                                               (gen-syntax496
                                                 src554
                                                 e564
                                                 r553
                                                 maps551
                                                 (lambda (x566) '#f)))
                                             tmp561)
                                           ((lambda (tmp567)
                                              (if (if tmp567
                                                      (apply
                                                        (lambda (x570
                                                                 dots568
                                                                 y569)
                                                          (ellipsis?552
                                                            dots568))
                                                        tmp567)
                                                      '#f)
                                                  (apply
                                                    (lambda (x573
                                                             dots571
                                                             y572)
                                                      ((letrec ((f574
                                                                 (lambda (y576
                                                                          k575)
                                                                   ((lambda (tmp577)
                                                                      ((lambda (tmp578)
                                                                         (if (if tmp578
                                                                                 (apply
                                                                                   (lambda (dots580
                                                                                            y579)
                                                                                     (ellipsis?552
                                                                                       dots580))
                                                                                   tmp578)
                                                                                 '#f)
                                                                             (apply
                                                                               (lambda (dots582
                                                                                        y581)
                                                                                 (f574 y581
                                                                                       (lambda (maps583)
                                                                                         (call-with-values
                                                                                           (lambda ()
                                                                                             (k575 (cons '()
                                                                                                         maps583)))
                                                                                           (lambda (x585
                                                                                                    maps584)
                                                                                             (if (null?
                                                                                                   (car maps584))
                                                                                                 (syntax-error
                                                                                                   src554
                                                                                                   '"extra ellipsis in syntax form")
                                                                                                 (values
                                                                                                   (gen-mappend499
                                                                                                     x585
                                                                                                     (car maps584))
                                                                                                   (cdr maps584))))))))
                                                                               tmp578)
                                                                             ((lambda (_586)
                                                                                (call-with-values
                                                                                  (lambda ()
                                                                                    (gen-syntax496
                                                                                      src554
                                                                                      y576
                                                                                      r553
                                                                                      maps551
                                                                                      ellipsis?552))
                                                                                  (lambda (y588
                                                                                           maps587)
                                                                                    (call-with-values
                                                                                      (lambda ()
                                                                                        (k575 maps587))
                                                                                      (lambda (x590
                                                                                               maps589)
                                                                                        (values
                                                                                          (gen-append498
                                                                                            x590
                                                                                            y588)
                                                                                          maps589))))))
                                                                              tmp577)))
                                                                       ($syntax-dispatch
                                                                         tmp577
                                                                         '(any .
                                                                               any))))
                                                                    y576))))
                                                         f574)
                                                       y572
                                                       (lambda (maps591)
                                                         (call-with-values
                                                           (lambda ()
                                                             (gen-syntax496
                                                               src554
                                                               x573
                                                               r553
                                                               (cons '()
                                                                     maps591)
                                                               ellipsis?552))
                                                           (lambda (x593
                                                                    maps592)
                                                             (if (null?
                                                                   (car maps592))
                                                                 (syntax-error
                                                                   src554
                                                                   '"extra ellipsis in syntax form")
                                                                 (values
                                                                   (gen-map500
                                                                     x593
                                                                     (car maps592))
                                                                   (cdr maps592))))))))
                                                    tmp567)
                                                  ((lambda (tmp594)
                                                     (if tmp594
                                                         (apply
                                                           (lambda (x596
                                                                    y595)
                                                             (call-with-values
                                                               (lambda ()
                                                                 (gen-syntax496
                                                                   src554
                                                                   x596
                                                                   r553
                                                                   maps551
                                                                   ellipsis?552))
                                                               (lambda (xnew598
                                                                        maps597)
                                                                 (call-with-values
                                                                   (lambda ()
                                                                     (gen-syntax496
                                                                       src554
                                                                       y595
                                                                       r553
                                                                       maps597
                                                                       ellipsis?552))
                                                                   (lambda (ynew600
                                                                            maps599)
                                                                     (values
                                                                       (gen-cons501
                                                                         e550
                                                                         x596
                                                                         y595
                                                                         xnew598
                                                                         ynew600)
                                                                       maps599))))))
                                                           tmp594)
                                                         ((lambda (tmp601)
                                                            (if tmp601
                                                                (apply
                                                                  (lambda (x1603
                                                                           x2602)
                                                                    ((lambda (ls604)
                                                                       (call-with-values
                                                                         (lambda ()
                                                                           (gen-syntax496
                                                                             src554
                                                                             ls604
                                                                             r553
                                                                             maps551
                                                                             ellipsis?552))
                                                                         (lambda (lsnew606
                                                                                  maps605)
                                                                           (values
                                                                             (gen-vector502
                                                                               e550
                                                                               ls604
                                                                               lsnew606)
                                                                             maps605))))
                                                                     (cons x1603
                                                                           x2602)))
                                                                  tmp601)
                                                                ((lambda (_608)
                                                                   (values
                                                                     (list 'quote
                                                                           e550)
                                                                     maps551))
                                                                 tmp560)))
                                                          ($syntax-dispatch
                                                            tmp560
                                                            '#(vector
                                                               (any .
                                                                    each-any))))))
                                                   ($syntax-dispatch
                                                     tmp560
                                                     '(any . any)))))
                                            ($syntax-dispatch
                                              tmp560
                                              '(any any . any)))))
                                     ($syntax-dispatch tmp560 '(any any))))
                                  e550))))
                          (gen-ref497
                           (lambda (src519 var516 level518 maps517)
                             (if (= level518 '0)
                                 (values var516 maps517)
                                 (if (null? maps517)
                                     (syntax-error
                                       src519
                                       '"missing ellipsis in syntax form")
                                     (call-with-values
                                       (lambda ()
                                         (gen-ref497
                                           src519
                                           var516
                                           (- level518 '1)
                                           (cdr maps517)))
                                       (lambda (outer-var521 outer-maps520)
                                         ((lambda (b522)
                                            (if b522
                                                (values (cdr b522) maps517)
                                                ((lambda (inner-var523)
                                                   (values
                                                     inner-var523
                                                     (cons (cons (cons outer-var521
                                                                       inner-var523)
                                                                 (car maps517))
                                                           outer-maps520)))
                                                 (gen-var465 'tmp))))
                                          (assq outer-var521
                                                (car maps517)))))))))
                          (gen-append498
                           (lambda (x549 y548)
                             (if (equal? y548 ''())
                                 x549
                                 (list 'append x549 y548))))
                          (gen-mappend499
                           (lambda (e525 map-env524)
                             (list 'apply
                                   '(primitive append)
                                   (gen-map500 e525 map-env524))))
                          (gen-map500
                           (lambda (e541 map-env540)
                             ((lambda (formals543 actuals542)
                                (if (eq? (car e541) 'ref)
                                    (car actuals542)
                                    (if (andmap
                                          (lambda (x544)
                                            (if (eq? (car x544) 'ref)
                                                (memq (cadr x544)
                                                      formals543)
                                                '#f))
                                          (cdr e541))
                                        (cons 'map
                                              (cons (list 'primitive
                                                          (car e541))
                                                    (map ((lambda (r545)
                                                            (lambda (x546)
                                                              (cdr (assq (cadr x546)
                                                                         r545))))
                                                          (map cons
                                                               formals543
                                                               actuals542))
                                                         (cdr e541))))
                                        (cons 'map
                                              (cons (list 'lambda
                                                          formals543
                                                          e541)
                                                    actuals542)))))
                              (map cdr map-env540)
                              (map (lambda (x547) (list 'ref (car x547)))
                                   map-env540))))
                          (gen-cons501
                           (lambda (e530 x526 y529 xnew527 ynew528)
                             ((lambda (t531)
                                (if (memv t531 '(quote))
                                    (if (eq? (car xnew527) 'quote)
                                        ((lambda (xnew533 ynew532)
                                           (if (if (eq? xnew533 x526)
                                                   (eq? ynew532 y529)
                                                   '#f)
                                               (list 'quote e530)
                                               (list 'quote
                                                     (cons xnew533
                                                           ynew532))))
                                         (cadr xnew527)
                                         (cadr ynew528))
                                        (if (eq? (cadr ynew528) '())
                                            (list 'list xnew527)
                                            (list 'cons xnew527 ynew528)))
                                    (if (memv t531 '(list))
                                        (cons 'list
                                              (cons xnew527 (cdr ynew528)))
                                        (list 'cons xnew527 ynew528))))
                              (car ynew528))))
                          (gen-vector502
                           (lambda (e539 ls537 lsnew538)
                             (if (eq? (car lsnew538) 'quote)
                                 (if (eq? (cadr lsnew538) ls537)
                                     (list 'quote e539)
                                     (list 'quote
                                           (list->vector (cadr lsnew538))))
                                 (if (eq? (car lsnew538) 'list)
                                     (cons 'vector (cdr lsnew538))
                                     (list 'list->vector lsnew538)))))
                          (regen503
                           (lambda (x534)
                             ((lambda (t535)
                                (if (memv t535 '(ref))
                                    (cadr x534)
                                    (if (memv t535 '(primitive))
                                        (cadr x534)
                                        (if (memv t535 '(quote))
                                            (list 'quote (cadr x534))
                                            (if (memv t535 '(lambda))
                                                (list 'lambda
                                                      (cadr x534)
                                                      (regen503
                                                        (caddr x534)))
                                                (if (memv t535 '(map))
                                                    ((lambda (ls536)
                                                       (cons (if (= (length
                                                                      ls536)
                                                                    '2)
                                                                 'map
                                                                 'map)
                                                             ls536))
                                                     (map regen503
                                                          (cdr x534)))
                                                    (cons (car x534)
                                                          (map regen503
                                                               (cdr x534)))))))))
                              (car x534)))))
                   (lambda (e507 r504 w506 s505)
                     ((lambda (e508)
                        ((lambda (tmp509)
                           ((lambda (tmp510)
                              (if tmp510
                                  (apply
                                    (lambda (_512 x511)
                                      (call-with-values
                                        (lambda ()
                                          (gen-syntax496
                                            e508
                                            x511
                                            r504
                                            '()
                                            ellipsis?461))
                                        (lambda (e514 maps513)
                                          (regen503 e514))))
                                    tmp510)
                                  ((lambda (_515) (syntax-error e508))
                                   tmp509)))
                            ($syntax-dispatch tmp509 '(any any))))
                         e508))
                      (source-wrap405 e507 w506 s505)))))))
            (global-extend301
              'core
              'lambda
              (lambda (e853 r850 w852 s851)
                ((lambda (tmp854)
                   ((lambda (tmp855)
                      (if tmp855
                          (apply
                            (lambda (_857 c856)
                              (chi-lambda-clause458
                                (source-wrap405 e853 w852 s851)
                                c856
                                r850
                                w852
                                (lambda (vars859 body858)
                                  (list 'lambda vars859 body858))))
                            tmp855)
                          (syntax-error tmp854)))
                    ($syntax-dispatch tmp854 '(any . any))))
                 e853)))
            (global-extend301
              'core
              'letrec
              (lambda (e612 r609 w611 s610)
                ((lambda (tmp613)
                   ((lambda (tmp614)
                      (if tmp614
                          (apply
                            (lambda (_619 id615 val618 e1616 e2617)
                              ((lambda (ids620)
                                 (if (not (valid-bound-ids?400 ids620))
                                     (invalid-ids-error402
                                       (map (lambda (x621)
                                              (wrap404 x621 w611))
                                            ids620)
                                       (source-wrap405 e612 w611 s610)
                                       '"bound variable")
                                     ((lambda (labels623 new-vars622)
                                        ((lambda (w625 r624)
                                           (build-letrec237
                                             s610
                                             new-vars622
                                             (map (lambda (x628)
                                                    (chi446
                                                      x628
                                                      r624
                                                      w625))
                                                  val618)
                                             (chi-body451
                                               (cons e1616 e2617)
                                               (source-wrap405
                                                 e612
                                                 w625
                                                 s610)
                                               r624
                                               w625)))
                                         (make-binding-wrap387
                                           ids620
                                           labels623
                                           w611)
                                         (extend-var-env*295
                                           labels623
                                           new-vars622
                                           r609)))
                                      (gen-labels350 ids620)
                                      (map gen-var465 ids620))))
                               id615))
                            tmp614)
                          ((lambda (_630)
                             (syntax-error
                               (source-wrap405 e612 w611 s610)))
                           tmp613)))
                    ($syntax-dispatch
                      tmp613
                      '(any #(each (any any)) any . each-any))))
                 e612)))
            (global-extend301
              'core
              'if
              (lambda (e838 r835 w837 s836)
                ((lambda (tmp839)
                   ((lambda (tmp840)
                      (if tmp840
                          (apply
                            (lambda (_843 test841 then842)
                              (list 'if
                                    (chi446 test841 r835 w837)
                                    (chi446 then842 r835 w837)
                                    (chi-void460)))
                            tmp840)
                          ((lambda (tmp844)
                             (if tmp844
                                 (apply
                                   (lambda (_848 test845 then847 else846)
                                     (list 'if
                                           (chi446 test845 r835 w837)
                                           (chi446 then847 r835 w837)
                                           (chi446 else846 r835 w837)))
                                   tmp844)
                                 ((lambda (_849)
                                    (syntax-error
                                      (source-wrap405 e838 w837 s836)))
                                  tmp839)))
                           ($syntax-dispatch tmp839 '(any any any any)))))
                    ($syntax-dispatch tmp839 '(any any any))))
                 e838)))
            (global-extend301 'set! 'set! '())
            (global-extend301 'begin 'begin '())
            (global-extend301 'module-key 'module '())
            (global-extend301 'import 'import '#f)
            (global-extend301 'import 'import-only '#t)
            (global-extend301 'define 'define '())
            (global-extend301 'define-syntax 'define-syntax '())
            (global-extend301 'eval-when 'eval-when '())
            (global-extend301
              'core
              'syntax-case
              ((lambda ()
                 (letrec ((convert-pattern631
                           (lambda (pattern700 keys699)
                             (letrec ((cvt*701
                                       (lambda (p*746 n744 ids745)
                                         (if (null? p*746)
                                             (values '() ids745)
                                             (call-with-values
                                               (lambda ()
                                                 (cvt*701
                                                   (cdr p*746)
                                                   n744
                                                   ids745))
                                               (lambda (y748 ids747)
                                                 (call-with-values
                                                   (lambda ()
                                                     (cvt702
                                                       (car p*746)
                                                       n744
                                                       ids747))
                                                   (lambda (x750 ids749)
                                                     (values
                                                       (cons x750 y748)
                                                       ids749))))))))
                                      (cvt702
                                       (lambda (p705 n703 ids704)
                                         (if (id?303 p705)
                                             (if (bound-id-member?403
                                                   p705
                                                   keys699)
                                                 (values
                                                   (vector 'free-id p705)
                                                   ids704)
                                                 (values
                                                   'any
                                                   (cons (cons p705 n703)
                                                         ids704)))
                                             ((lambda (tmp706)
                                                ((lambda (tmp707)
                                                   (if (if tmp707
                                                           (apply
                                                             (lambda (x709
                                                                      dots708)
                                                               (ellipsis?461
                                                                 dots708))
                                                             tmp707)
                                                           '#f)
                                                       (apply
                                                         (lambda (x711
                                                                  dots710)
                                                           (call-with-values
                                                             (lambda ()
                                                               (cvt702
                                                                 x711
                                                                 (+ n703
                                                                    '1)
                                                                 ids704))
                                                             (lambda (p713
                                                                      ids712)
                                                               (values
                                                                 (if (eq? p713
                                                                          'any)
                                                                     'each-any
                                                                     (vector
                                                                       'each
                                                                       p713))
                                                                 ids712))))
                                                         tmp707)
                                                       ((lambda (tmp714)
                                                          (if (if tmp714
                                                                  (apply
                                                                    (lambda (x718
                                                                             dots715
                                                                             y717
                                                                             z716)
                                                                      (ellipsis?461
                                                                        dots715))
                                                                    tmp714)
                                                                  '#f)
                                                              (apply
                                                                (lambda (x722
                                                                         dots719
                                                                         y721
                                                                         z720)
                                                                  (call-with-values
                                                                    (lambda ()
                                                                      (cvt702
                                                                        z720
                                                                        n703
                                                                        ids704))
                                                                    (lambda (z724
                                                                             ids723)
                                                                      (call-with-values
                                                                        (lambda ()
                                                                          (cvt*701
                                                                            y721
                                                                            n703
                                                                            ids723))
                                                                        (lambda (y726
                                                                                 ids725)
                                                                          (call-with-values
                                                                            (lambda ()
                                                                              (cvt702
                                                                                x722
                                                                                (+ n703
                                                                                   '1)
                                                                                ids725))
                                                                            (lambda (x728
                                                                                     ids727)
                                                                              (values
                                                                                (vector
                                                                                  'each+
                                                                                  x728
                                                                                  (reverse
                                                                                    y726)
                                                                                  z724)
                                                                                ids727))))))))
                                                                tmp714)
                                                              ((lambda (tmp730)
                                                                 (if tmp730
                                                                     (apply
                                                                       (lambda (x732
                                                                                y731)
                                                                         (call-with-values
                                                                           (lambda ()
                                                                             (cvt702
                                                                               y731
                                                                               n703
                                                                               ids704))
                                                                           (lambda (y734
                                                                                    ids733)
                                                                             (call-with-values
                                                                               (lambda ()
                                                                                 (cvt702
                                                                                   x732
                                                                                   n703
                                                                                   ids733))
                                                                               (lambda (x736
                                                                                        ids735)
                                                                                 (values
                                                                                   (cons x736
                                                                                         y734)
                                                                                   ids735))))))
                                                                       tmp730)
                                                                     ((lambda (tmp737)
                                                                        (if tmp737
                                                                            (apply
                                                                              (lambda ()
                                                                                (values
                                                                                  '()
                                                                                  ids704))
                                                                              tmp737)
                                                                            ((lambda (tmp738)
                                                                               (if tmp738
                                                                                   (apply
                                                                                     (lambda (x739)
                                                                                       (call-with-values
                                                                                         (lambda ()
                                                                                           (cvt702
                                                                                             x739
                                                                                             n703
                                                                                             ids704))
                                                                                         (lambda (p741
                                                                                                  ids740)
                                                                                           (values
                                                                                             (vector
                                                                                               'vector
                                                                                               p741)
                                                                                             ids740))))
                                                                                     tmp738)
                                                                                   ((lambda (x743)
                                                                                      (values
                                                                                        (vector
                                                                                          'atom
                                                                                          (strip464
                                                                                            p705
                                                                                            '(())))
                                                                                        ids704))
                                                                                    tmp706)))
                                                                             ($syntax-dispatch
                                                                               tmp706
                                                                               '#(vector
                                                                                  each-any)))))
                                                                      ($syntax-dispatch
                                                                        tmp706
                                                                        '()))))
                                                               ($syntax-dispatch
                                                                 tmp706
                                                                 '(any .
                                                                       any)))))
                                                        ($syntax-dispatch
                                                          tmp706
                                                          '(any any
                                                                .
                                                                #(each+
                                                                  any
                                                                  ()
                                                                  any))))))
                                                 ($syntax-dispatch
                                                   tmp706
                                                   '(any any))))
                                              p705)))))
                               (cvt702 pattern700 '0 '()))))
                          (build-dispatch-call632
                           (lambda (pvars654 exp651 y653 r652)
                             ((lambda (ids656 levels655)
                                ((lambda (labels658 new-vars657)
                                   (list 'apply
                                         (list 'lambda
                                               new-vars657
                                               (chi446
                                                 exp651
                                                 (extend-env*294
                                                   labels658
                                                   (map (lambda (var660
                                                                 level659)
                                                          (make-binding278
                                                            'syntax
                                                            (cons var660
                                                                  level659)))
                                                        new-vars657
                                                        (map cdr pvars654))
                                                   r652)
                                                 (make-binding-wrap387
                                                   ids656
                                                   labels658
                                                   '(()))))
                                         y653))
                                 (gen-labels350 ids656)
                                 (map gen-var465 ids656)))
                              (map car pvars654)
                              (map cdr pvars654))))
                          (gen-clause633
                           (lambda (x682
                                    keys676
                                    clauses681
                                    r677
                                    pat680
                                    fender678
                                    exp679)
                             (call-with-values
                               (lambda ()
                                 (convert-pattern631 pat680 keys676))
                               (lambda (p684 pvars683)
                                 (if (not (distinct-bound-ids?401
                                            (map car pvars683)))
                                     (invalid-ids-error402
                                       (map car pvars683)
                                       pat680
                                       '"pattern variable")
                                     (if (not (andmap
                                                (lambda (x685)
                                                  (not (ellipsis?461
                                                         (car x685))))
                                                pvars683))
                                         (syntax-error
                                           pat680
                                           '"misplaced ellipsis in syntax-case pattern")
                                         ((lambda (y686)
                                            (list (list 'lambda
                                                        (list y686)
                                                        (list 'if
                                                              ((lambda (tmp696)
                                                                 ((lambda (tmp697)
                                                                    (if tmp697
                                                                        (apply
                                                                          (lambda ()
                                                                            y686)
                                                                          tmp697)
                                                                        ((lambda (_698)
                                                                           (list 'if
                                                                                 y686
                                                                                 (build-dispatch-call632
                                                                                   pvars683
                                                                                   fender678
                                                                                   y686
                                                                                   r677)
                                                                                 (list 'quote
                                                                                       '#f)))
                                                                         tmp696)))
                                                                  ($syntax-dispatch
                                                                    tmp696
                                                                    '#(atom
                                                                       #t))))
                                                               fender678)
                                                              (build-dispatch-call632
                                                                pvars683
                                                                exp679
                                                                y686
                                                                r677)
                                                              (gen-syntax-case634
                                                                x682
                                                                keys676
                                                                clauses681
                                                                r677)))
                                                  (if (eq? p684 'any)
                                                      (list 'list x682)
                                                      (list '$syntax-dispatch
                                                            x682
                                                            (list 'quote
                                                                  p684)))))
                                          (gen-var465 'tmp))))))))
                          (gen-syntax-case634
                           (lambda (x664 keys661 clauses663 r662)
                             (if (null? clauses663)
                                 (list 'syntax-error x664)
                                 ((lambda (tmp665)
                                    ((lambda (tmp666)
                                       (if tmp666
                                           (apply
                                             (lambda (pat668 exp667)
                                               (if (if (id?303 pat668)
                                                       (if (not (bound-id-member?403
                                                                  pat668
                                                                  keys661))
                                                           (not (ellipsis?461
                                                                  pat668))
                                                           '#f)
                                                       '#f)
                                                   ((lambda (label670
                                                             var669)
                                                      (list (list 'lambda
                                                                  (list var669)
                                                                  (chi446
                                                                    exp667
                                                                    (extend-env293
                                                                      label670
                                                                      (make-binding278
                                                                        'syntax
                                                                        (cons var669
                                                                              '0))
                                                                      r662)
                                                                    (make-binding-wrap387
                                                                      (list pat668)
                                                                      (list label670)
                                                                      '(()))))
                                                            x664))
                                                    (gen-label348)
                                                    (gen-var465 pat668))
                                                   (gen-clause633
                                                     x664
                                                     keys661
                                                     (cdr clauses663)
                                                     r662
                                                     pat668
                                                     '#t
                                                     exp667)))
                                             tmp666)
                                           ((lambda (tmp671)
                                              (if tmp671
                                                  (apply
                                                    (lambda (pat674
                                                             fender672
                                                             exp673)
                                                      (gen-clause633
                                                        x664
                                                        keys661
                                                        (cdr clauses663)
                                                        r662
                                                        pat674
                                                        fender672
                                                        exp673))
                                                    tmp671)
                                                  ((lambda (_675)
                                                     (syntax-error
                                                       (car clauses663)
                                                       '"invalid syntax-case clause"))
                                                   tmp665)))
                                            ($syntax-dispatch
                                              tmp665
                                              '(any any any)))))
                                     ($syntax-dispatch tmp665 '(any any))))
                                  (car clauses663))))))
                   (lambda (e638 r635 w637 s636)
                     ((lambda (e639)
                        ((lambda (tmp640)
                           ((lambda (tmp641)
                              (if tmp641
                                  (apply
                                    (lambda (_645 val642 key644 m643)
                                      (if (andmap
                                            (lambda (x647)
                                              (if (id?303 x647)
                                                  (not (ellipsis?461 x647))
                                                  '#f))
                                            key644)
                                          ((lambda (x648)
                                             (list (list 'lambda
                                                         (list x648)
                                                         (gen-syntax-case634
                                                           x648
                                                           key644
                                                           m643
                                                           r635))
                                                   (chi446
                                                     val642
                                                     r635
                                                     '(()))))
                                           (gen-var465 'tmp))
                                          (syntax-error
                                            e639
                                            '"invalid literals list in")))
                                    tmp641)
                                  (syntax-error tmp640)))
                            ($syntax-dispatch
                              tmp640
                              '(any any each-any . each-any))))
                         e639))
                      (source-wrap405 e638 w637 s636)))))))
            (set! sc-expand
              ((lambda (ctem831 rtem829 user-ribcage830)
                 ((lambda (user-top-wrap832)
                    (lambda (x833)
                      (if (if (pair? x833)
                              (equal? (car x833) noexpand62)
                              '#f)
                          (cadr x833)
                          (chi-top411
                            x833
                            '()
                            user-top-wrap832
                            ctem831
                            rtem829
                            user-ribcage830))))
                  (make-wrap310
                    (wrap-marks311 '((top)))
                    (cons user-ribcage830 (wrap-subst312 '((top)))))))
               '(e)
               '(e)
               ((lambda (ribcage834)
                  (begin (extend-ribcage-subst!385 ribcage834 '*top*)
                         ribcage834))
                (make-ribcage351 '() '() '()))))
            (set! identifier? (lambda (x751) (nonsymbol-id?302 x751)))
            (set! datum->syntax-object
              (lambda (id827 datum826)
                (begin ((lambda (x828)
                          (if (not (nonsymbol-id?302 x828))
                              (error-hook129
                                'datum->syntax-object
                                '"invalid argument"
                                x828)
                              (void)))
                        id827)
                       (make-syntax-object250
                         datum826
                         (syntax-object-wrap253 id827)))))
            (set! syntax-object->datum
              (lambda (x752) (strip464 x752 '(()))))
            (set! generate-temporaries
              (lambda (ls823)
                (begin ((lambda (x825)
                          (if (not (list? x825))
                              (error-hook129
                                'generate-temporaries
                                '"invalid argument"
                                x825)
                              (void)))
                        ls823)
                       (map (lambda (x824) (wrap404 (gensym) '((top))))
                            ls823))))
            (set! free-identifier=?
              (lambda (x754 y753)
                (begin ((lambda (x756)
                          (if (not (nonsymbol-id?302 x756))
                              (error-hook129
                                'free-identifier=?
                                '"invalid argument"
                                x756)
                              (void)))
                        x754)
                       ((lambda (x755)
                          (if (not (nonsymbol-id?302 x755))
                              (error-hook129
                                'free-identifier=?
                                '"invalid argument"
                                x755)
                              (void)))
                        y753)
                       (free-id=?397 x754 y753))))
            (set! bound-identifier=?
              (lambda (x820 y819)
                (begin ((lambda (x822)
                          (if (not (nonsymbol-id?302 x822))
                              (error-hook129
                                'bound-identifier=?
                                '"invalid argument"
                                x822)
                              (void)))
                        x820)
                       ((lambda (x821)
                          (if (not (nonsymbol-id?302 x821))
                              (error-hook129
                                'bound-identifier=?
                                '"invalid argument"
                                x821)
                              (void)))
                        y819)
                       (bound-id=?399 x820 y819))))
            (set! literal-identifier=?
              (lambda (x758 y757)
                (begin ((lambda (x760)
                          (if (not (nonsymbol-id?302 x760))
                              (error-hook129
                                'literal-identifier=?
                                '"invalid argument"
                                x760)
                              (void)))
                        x758)
                       ((lambda (x759)
                          (if (not (nonsymbol-id?302 x759))
                              (error-hook129
                                'literal-identifier=?
                                '"invalid argument"
                                x759)
                              (void)))
                        y757)
                       (literal-id=?398 x758 y757))))
            (set! syntax-error
              (lambda (object814 . messages815)
                (begin (for-each
                         (lambda (x817)
                           ((lambda (x818)
                              (if (not (string? x818))
                                  (error-hook129
                                    'syntax-error
                                    '"invalid argument"
                                    x818)
                                  (void)))
                            x817))
                         messages815)
                       ((lambda (message816)
                          (error-hook129
                            '#f
                            message816
                            (strip464 object814 '(()))))
                        (if (null? messages815)
                            '"invalid syntax"
                            (apply string-append messages815))))))
            ((lambda ()
               (letrec ((match-each761
                         (lambda (e811 p809 w810)
                           (if (annotation?126 e811)
                               (match-each761
                                 (annotation-expression e811)
                                 p809
                                 w810)
                               (if (pair? e811)
                                   ((lambda (first812)
                                      (if first812
                                          ((lambda (rest813)
                                             (if rest813
                                                 (cons first812 rest813)
                                                 '#f))
                                           (match-each761
                                             (cdr e811)
                                             p809
                                             w810))
                                          '#f))
                                    (match767 (car e811) p809 w810 '()))
                                   (if (null? e811)
                                       '()
                                       (if (syntax-object?251 e811)
                                           (match-each761
                                             (syntax-object-expression252
                                               e811)
                                             p809
                                             (join-wraps390
                                               w810
                                               (syntax-object-wrap253
                                                 e811)))
                                           '#f))))))
                        (match-each+762
                         (lambda (e777
                                  x-pat772
                                  y-pat776
                                  z-pat773
                                  w775
                                  r774)
                           ((letrec ((f778
                                      (lambda (e780 w779)
                                        (if (pair? e780)
                                            (call-with-values
                                              (lambda ()
                                                (f778 (cdr e780) w779))
                                              (lambda (xr*783
                                                       y-pat781
                                                       r782)
                                                (if r782
                                                    (if (null? y-pat781)
                                                        ((lambda (xr784)
                                                           (if xr784
                                                               (values
                                                                 (cons xr784
                                                                       xr*783)
                                                                 y-pat781
                                                                 r782)
                                                               (values
                                                                 '#f
                                                                 '#f
                                                                 '#f)))
                                                         (match767
                                                           (car e780)
                                                           x-pat772
                                                           w779
                                                           '()))
                                                        (values
                                                          '()
                                                          (cdr y-pat781)
                                                          (match767
                                                            (car e780)
                                                            (car y-pat781)
                                                            w779
                                                            r782)))
                                                    (values '#f '#f '#f))))
                                            (if (annotation?126 e780)
                                                (f778 (annotation-expression
                                                        e780)
                                                      w779)
                                                (if (syntax-object?251
                                                      e780)
                                                    (f778 (syntax-object-expression252
                                                            e780)
                                                          (join-wraps390
                                                            w779
                                                            (syntax-object-wrap253
                                                              e780)))
                                                    (values
                                                      '()
                                                      y-pat776
                                                      (match767
                                                        e780
                                                        z-pat773
                                                        w779
                                                        r774))))))))
                              f778)
                            e777
                            w775)))
                        (match-each-any763
                         (lambda (e807 w806)
                           (if (annotation?126 e807)
                               (match-each-any763
                                 (annotation-expression e807)
                                 w806)
                               (if (pair? e807)
                                   ((lambda (l808)
                                      (if l808
                                          (cons (wrap404 (car e807) w806)
                                                l808)
                                          '#f))
                                    (match-each-any763 (cdr e807) w806))
                                   (if (null? e807)
                                       '()
                                       (if (syntax-object?251 e807)
                                           (match-each-any763
                                             (syntax-object-expression252
                                               e807)
                                             (join-wraps390
                                               w806
                                               (syntax-object-wrap253
                                                 e807)))
                                           '#f))))))
                        (match-empty764
                         (lambda (p786 r785)
                           (if (null? p786)
                               r785
                               (if (eq? p786 'any)
                                   (cons '() r785)
                                   (if (pair? p786)
                                       (match-empty764
                                         (car p786)
                                         (match-empty764 (cdr p786) r785))
                                       (if (eq? p786 'each-any)
                                           (cons '() r785)
                                           ((lambda (t787)
                                              (if (memv t787 '(each))
                                                  (match-empty764
                                                    (vector-ref p786 '1)
                                                    r785)
                                                  (if (memv t787 '(each+))
                                                      (match-empty764
                                                        (vector-ref
                                                          p786
                                                          '1)
                                                        (match-empty764
                                                          (reverse
                                                            (vector-ref
                                                              p786
                                                              '2))
                                                          (match-empty764
                                                            (vector-ref
                                                              p786
                                                              '3)
                                                            r785)))
                                                      (if (memv t787
                                                                '(free-id
                                                                   atom))
                                                          r785
                                                          (if (memv t787
                                                                    '(vector))
                                                              (match-empty764
                                                                (vector-ref
                                                                  p786
                                                                  '1)
                                                                r785)
                                                              (void))))))
                                            (vector-ref p786 '0))))))))
                        (combine765
                         (lambda (r*805 r804)
                           (if (null? (car r*805))
                               r804
                               (cons (map car r*805)
                                     (combine765 (map cdr r*805) r804)))))
                        (match*766
                         (lambda (e791 p788 w790 r789)
                           (if (null? p788)
                               (if (null? e791) r789 '#f)
                               (if (pair? p788)
                                   (if (pair? e791)
                                       (match767
                                         (car e791)
                                         (car p788)
                                         w790
                                         (match767
                                           (cdr e791)
                                           (cdr p788)
                                           w790
                                           r789))
                                       '#f)
                                   (if (eq? p788 'each-any)
                                       ((lambda (l792)
                                          (if l792 (cons l792 r789) '#f))
                                        (match-each-any763 e791 w790))
                                       ((lambda (t793)
                                          (if (memv t793 '(each))
                                              (if (null? e791)
                                                  (match-empty764
                                                    (vector-ref p788 '1)
                                                    r789)
                                                  ((lambda (r*794)
                                                     (if r*794
                                                         (combine765
                                                           r*794
                                                           r789)
                                                         '#f))
                                                   (match-each761
                                                     e791
                                                     (vector-ref p788 '1)
                                                     w790)))
                                              (if (memv t793 '(free-id))
                                                  (if (id?303 e791)
                                                      (if (literal-id=?398
                                                            (wrap404
                                                              e791
                                                              w790)
                                                            (vector-ref
                                                              p788
                                                              '1))
                                                          r789
                                                          '#f)
                                                      '#f)
                                                  (if (memv t793 '(each+))
                                                      (call-with-values
                                                        (lambda ()
                                                          (match-each+762
                                                            e791
                                                            (vector-ref
                                                              p788
                                                              '1)
                                                            (vector-ref
                                                              p788
                                                              '2)
                                                            (vector-ref
                                                              p788
                                                              '3)
                                                            w790
                                                            r789))
                                                        (lambda (xr*797
                                                                 y-pat795
                                                                 r796)
                                                          (if r796
                                                              (if (null?
                                                                    y-pat795)
                                                                  (if (null?
                                                                        xr*797)
                                                                      (match-empty764
                                                                        (vector-ref
                                                                          p788
                                                                          '1)
                                                                        r796)
                                                                      (combine765
                                                                        xr*797
                                                                        r796))
                                                                  '#f)
                                                              '#f)))
                                                      (if (memv t793
                                                                '(atom))
                                                          (if (equal?
                                                                (vector-ref
                                                                  p788
                                                                  '1)
                                                                (strip464
                                                                  e791
                                                                  w790))
                                                              r789
                                                              '#f)
                                                          (if (memv t793
                                                                    '(vector))
                                                              (if (vector?
                                                                    e791)
                                                                  (match767
                                                                    (vector->list
                                                                      e791)
                                                                    (vector-ref
                                                                      p788
                                                                      '1)
                                                                    w790
                                                                    r789)
                                                                  '#f)
                                                              (void)))))))
                                        (vector-ref p788 '0)))))))
                        (match767
                         (lambda (e801 p798 w800 r799)
                           (if (not r799)
                               '#f
                               (if (eq? p798 'any)
                                   (cons (wrap404 e801 w800) r799)
                                   (if (syntax-object?251 e801)
                                       (match*766
                                         ((lambda (e802)
                                            (if (annotation?126 e802)
                                                (annotation-expression
                                                  e802)
                                                e802))
                                          (syntax-object-expression252
                                            e801))
                                         p798
                                         (join-wraps390
                                           w800
                                           (syntax-object-wrap253 e801))
                                         r799)
                                       (match*766
                                         ((lambda (e803)
                                            (if (annotation?126 e803)
                                                (annotation-expression
                                                  e803)
                                                e803))
                                          e801)
                                         p798
                                         w800
                                         r799)))))))
                 (set! $syntax-dispatch
                   (lambda (e769 p768)
                     (if (eq? p768 'any)
                         (list e769)
                         (if (syntax-object?251 e769)
                             (match*766
                               ((lambda (e770)
                                  (if (annotation?126 e770)
                                      (annotation-expression e770)
                                      e770))
                                (syntax-object-expression252 e769))
                               p768
                               (syntax-object-wrap253 e769)
                               '())
                             (match*766
                               ((lambda (e771)
                                  (if (annotation?126 e771)
                                      (annotation-expression e771)
                                      e771))
                                e769)
                               p768
                               '(())
                               '()))))))))))))
($sc-put-cte
  'with-syntax
  (lambda (x1943)
    ((lambda (tmp1944)
       ((lambda (tmp1945)
          (if tmp1945
              (apply
                (lambda (_1948 e11946 e21947)
                  (cons '#(syntax-object begin ((top) #(ribcage #(_ e1 e2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                        (cons e11946 e21947)))
                tmp1945)
              ((lambda (tmp1950)
                 (if tmp1950
                     (apply
                       (lambda (_1955 out1951 in1954 e11952 e21953)
                         (list '#(syntax-object syntax-case ((top) #(ribcage #(_ out in e1 e2) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                               in1954
                               '()
                               (list out1951
                                     (cons '#(syntax-object begin ((top) #(ribcage #(_ out in e1 e2) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                           (cons e11952 e21953)))))
                       tmp1950)
                     ((lambda (tmp1957)
                        (if tmp1957
                            (apply
                              (lambda (_1962 out1958 in1961 e11959 e21960)
                                (list '#(syntax-object syntax-case ((top) #(ribcage #(_ out in e1 e2) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                      (cons '#(syntax-object list ((top) #(ribcage #(_ out in e1 e2) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                            in1961)
                                      '()
                                      (list out1958
                                            (cons '#(syntax-object begin ((top) #(ribcage #(_ out in e1 e2) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                  (cons e11959 e21960)))))
                              tmp1957)
                            (syntax-error tmp1944)))
                      ($syntax-dispatch
                        tmp1944
                        '(any #(each (any any)) any . each-any)))))
               ($syntax-dispatch
                 tmp1944
                 '(any ((any any)) any . each-any)))))
        ($syntax-dispatch tmp1944 '(any () any . each-any))))
     x1943)))
($sc-put-cte
  'syntax-rules
  (lambda (x1966)
    ((lambda (tmp1967)
       ((lambda (tmp1968)
          (if tmp1968
              (apply
                (lambda (_1973 k1969 keyword1972 pattern1970 template1971)
                  (list '#(syntax-object lambda ((top) #(ribcage #(_ k keyword pattern template) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                        '#(syntax-object (x) ((top) #(ribcage #(_ k keyword pattern template) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                        (cons '#(syntax-object syntax-case ((top) #(ribcage #(_ k keyword pattern template) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                              (cons '#(syntax-object x ((top) #(ribcage #(_ k keyword pattern template) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                    (cons k1969
                                          (map (lambda (tmp1976 tmp1975)
                                                 (list (cons '#(syntax-object dummy ((top) #(ribcage #(_ k keyword pattern template) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                             tmp1975)
                                                       (list '#(syntax-object syntax ((top) #(ribcage #(_ k keyword pattern template) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                             tmp1976)))
                                               template1971
                                               pattern1970))))))
                tmp1968)
              (syntax-error tmp1967)))
        ($syntax-dispatch
          tmp1967
          '(any each-any . #(each ((any . any) any))))))
     x1966)))
($sc-put-cte
  'or
  (lambda (x1977)
    ((lambda (tmp1978)
       ((lambda (tmp1979)
          (if tmp1979
              (apply
                (lambda (_1980)
                  '#(syntax-object #f ((top) #(ribcage #(_) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ()))))
                tmp1979)
              ((lambda (tmp1981)
                 (if tmp1981
                     (apply (lambda (_1983 e1982) e1982) tmp1981)
                     ((lambda (tmp1984)
                        (if tmp1984
                            (apply
                              (lambda (_1988 e11985 e21987 e31986)
                                (list '#(syntax-object let ((top) #(ribcage #(_ e1 e2 e3) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                      (list (list '#(syntax-object t ((top) #(ribcage #(_ e1 e2 e3) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                  e11985))
                                      (list '#(syntax-object if ((top) #(ribcage #(_ e1 e2 e3) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                            '#(syntax-object t ((top) #(ribcage #(_ e1 e2 e3) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                            '#(syntax-object t ((top) #(ribcage #(_ e1 e2 e3) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                            (cons '#(syntax-object or ((top) #(ribcage #(_ e1 e2 e3) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                  (cons e21987 e31986)))))
                              tmp1984)
                            (syntax-error tmp1978)))
                      ($syntax-dispatch
                        tmp1978
                        '(any any any . each-any)))))
               ($syntax-dispatch tmp1978 '(any any)))))
        ($syntax-dispatch tmp1978 '(any))))
     x1977)))
($sc-put-cte
  'and
  (lambda (x1990)
    ((lambda (tmp1991)
       ((lambda (tmp1992)
          (if tmp1992
              (apply
                (lambda (_1996 e11993 e21995 e31994)
                  (cons '#(syntax-object if ((top) #(ribcage #(_ e1 e2 e3) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                        (cons e11993
                              (cons (cons '#(syntax-object and ((top) #(ribcage #(_ e1 e2 e3) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                          (cons e21995 e31994))
                                    '#(syntax-object (#f) ((top) #(ribcage #(_ e1 e2 e3) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))))))
                tmp1992)
              ((lambda (tmp1998)
                 (if tmp1998
                     (apply (lambda (_2000 e1999) e1999) tmp1998)
                     ((lambda (tmp2001)
                        (if tmp2001
                            (apply
                              (lambda (_2002)
                                '#(syntax-object #t ((top) #(ribcage #(_) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ()))))
                              tmp2001)
                            (syntax-error tmp1991)))
                      ($syntax-dispatch tmp1991 '(any)))))
               ($syntax-dispatch tmp1991 '(any any)))))
        ($syntax-dispatch tmp1991 '(any any any . each-any))))
     x1990)))
($sc-put-cte
  'let
  (lambda (x2003)
    ((lambda (tmp2004)
       ((lambda (tmp2005)
          (if (if tmp2005
                  (apply
                    (lambda (_2010 x2006 v2009 e12007 e22008)
                      (andmap identifier? x2006))
                    tmp2005)
                  '#f)
              (apply
                (lambda (_2016 x2012 v2015 e12013 e22014)
                  (cons (cons '#(syntax-object lambda ((top) #(ribcage #(_ x v e1 e2) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                              (cons x2012 (cons e12013 e22014)))
                        v2015))
                tmp2005)
              ((lambda (tmp2020)
                 (if (if tmp2020
                         (apply
                           (lambda (_2026 f2021 x2025 v2022 e12024 e22023)
                             (andmap identifier? (cons f2021 x2025)))
                           tmp2020)
                         '#f)
                     (apply
                       (lambda (_2033 f2028 x2032 v2029 e12031 e22030)
                         (cons (list '#(syntax-object letrec ((top) #(ribcage #(_ f x v e1 e2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                     (list (list f2028
                                                 (cons '#(syntax-object lambda ((top) #(ribcage #(_ f x v e1 e2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                       (cons x2032
                                                             (cons e12031
                                                                   e22030)))))
                                     f2028)
                               v2029))
                       tmp2020)
                     (syntax-error tmp2004)))
               ($syntax-dispatch
                 tmp2004
                 '(any any #(each (any any)) any . each-any)))))
        ($syntax-dispatch
          tmp2004
          '(any #(each (any any)) any . each-any))))
     x2003)))
($sc-put-cte
  'let*
  (lambda (x2037)
    ((lambda (tmp2038)
       ((lambda (tmp2039)
          (if (if tmp2039
                  (apply
                    (lambda (let*2044 x2040 v2043 e12041 e22042)
                      (andmap identifier? x2040))
                    tmp2039)
                  '#f)
              (apply
                (lambda (let*2050 x2046 v2049 e12047 e22048)
                  ((letrec ((f2051
                             (lambda (bindings2052)
                               (if (null? bindings2052)
                                   (cons '#(syntax-object let ((top) #(ribcage () () ()) #(ribcage #(bindings) #((top)) #("i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(let* x v e1 e2) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                         (cons '() (cons e12047 e22048)))
                                   ((lambda (tmp2054)
                                      ((lambda (tmp2055)
                                         (if tmp2055
                                             (apply
                                               (lambda (body2057
                                                        binding2056)
                                                 (list '#(syntax-object let ((top) #(ribcage #(body binding) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(bindings) #((top)) #("i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(let* x v e1 e2) #((top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                       (list binding2056)
                                                       body2057))
                                               tmp2055)
                                             (syntax-error tmp2054)))
                                       ($syntax-dispatch
                                         tmp2054
                                         '(any any))))
                                    (list (f2051 (cdr bindings2052))
                                          (car bindings2052)))))))
                     f2051)
                   (map list x2046 v2049)))
                tmp2039)
              (syntax-error tmp2038)))
        ($syntax-dispatch
          tmp2038
          '(any #(each (any any)) any . each-any))))
     x2037)))
($sc-put-cte
  'cond
  (lambda (x2060)
    ((lambda (tmp2061)
       ((lambda (tmp2062)
          (if tmp2062
              (apply
                (lambda (_2065 m12063 m22064)
                  ((letrec ((f2066
                             (lambda (clause2068 clauses2067)
                               (if (null? clauses2067)
                                   ((lambda (tmp2069)
                                      ((lambda (tmp2070)
                                         (if tmp2070
                                             (apply
                                               (lambda (e12072 e22071)
                                                 (cons '#(syntax-object begin ((top) #(ribcage #(e1 e2) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                       (cons e12072
                                                             e22071)))
                                               tmp2070)
                                             ((lambda (tmp2074)
                                                (if tmp2074
                                                    (apply
                                                      (lambda (e02075)
                                                        (cons '#(syntax-object let ((top) #(ribcage #(e0) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                              (cons (list (list '#(syntax-object t ((top) #(ribcage #(e0) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                                e02075))
                                                                    '#(syntax-object ((if t t)) ((top) #(ribcage #(e0) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ()))))))
                                                      tmp2074)
                                                    ((lambda (tmp2076)
                                                       (if tmp2076
                                                           (apply
                                                             (lambda (e02078
                                                                      e12077)
                                                               (list '#(syntax-object let ((top) #(ribcage #(e0 e1) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                     (list (list '#(syntax-object t ((top) #(ribcage #(e0 e1) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                                 e02078))
                                                                     (list '#(syntax-object if ((top) #(ribcage #(e0 e1) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                           '#(syntax-object t ((top) #(ribcage #(e0 e1) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                           (cons e12077
                                                                                 '#(syntax-object (t) ((top) #(ribcage #(e0 e1) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))))))
                                                             tmp2076)
                                                           ((lambda (tmp2079)
                                                              (if tmp2079
                                                                  (apply
                                                                    (lambda (e02082
                                                                             e12080
                                                                             e22081)
                                                                      (list '#(syntax-object if ((top) #(ribcage #(e0 e1 e2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                            e02082
                                                                            (cons '#(syntax-object begin ((top) #(ribcage #(e0 e1 e2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                                  (cons e12080
                                                                                        e22081))))
                                                                    tmp2079)
                                                                  ((lambda (_2084)
                                                                     (syntax-error
                                                                       x2060))
                                                                   tmp2069)))
                                                            ($syntax-dispatch
                                                              tmp2069
                                                              '(any any
                                                                    .
                                                                    each-any)))))
                                                     ($syntax-dispatch
                                                       tmp2069
                                                       '(any #(free-id
                                                               #(syntax-object => ((top) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ()))))
                                                             any)))))
                                              ($syntax-dispatch
                                                tmp2069
                                                '(any)))))
                                       ($syntax-dispatch
                                         tmp2069
                                         '(#(free-id
                                             #(syntax-object else ((top) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ()))))
                                            any
                                            .
                                            each-any))))
                                    clause2068)
                                   ((lambda (tmp2085)
                                      ((lambda (rest2086)
                                         ((lambda (tmp2087)
                                            ((lambda (tmp2088)
                                               (if tmp2088
                                                   (apply
                                                     (lambda (e02089)
                                                       (list '#(syntax-object let ((top) #(ribcage #(e0) #((top)) #("i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                             (list (list '#(syntax-object t ((top) #(ribcage #(e0) #((top)) #("i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                         e02089))
                                                             (list '#(syntax-object if ((top) #(ribcage #(e0) #((top)) #("i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                   '#(syntax-object t ((top) #(ribcage #(e0) #((top)) #("i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                   '#(syntax-object t ((top) #(ribcage #(e0) #((top)) #("i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                   rest2086)))
                                                     tmp2088)
                                                   ((lambda (tmp2090)
                                                      (if tmp2090
                                                          (apply
                                                            (lambda (e02092
                                                                     e12091)
                                                              (list '#(syntax-object let ((top) #(ribcage #(e0 e1) #((top) (top)) #("i" "i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                    (list (list '#(syntax-object t ((top) #(ribcage #(e0 e1) #((top) (top)) #("i" "i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                                e02092))
                                                                    (list '#(syntax-object if ((top) #(ribcage #(e0 e1) #((top) (top)) #("i" "i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                          '#(syntax-object t ((top) #(ribcage #(e0 e1) #((top) (top)) #("i" "i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                          (cons e12091
                                                                                '#(syntax-object (t) ((top) #(ribcage #(e0 e1) #((top) (top)) #("i" "i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ()))))
                                                                          rest2086)))
                                                            tmp2090)
                                                          ((lambda (tmp2093)
                                                             (if tmp2093
                                                                 (apply
                                                                   (lambda (e02096
                                                                            e12094
                                                                            e22095)
                                                                     (list '#(syntax-object if ((top) #(ribcage #(e0 e1 e2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                           e02096
                                                                           (cons '#(syntax-object begin ((top) #(ribcage #(e0 e1 e2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                                 (cons e12094
                                                                                       e22095))
                                                                           rest2086))
                                                                   tmp2093)
                                                                 ((lambda (_2098)
                                                                    (syntax-error
                                                                      x2060))
                                                                  tmp2087)))
                                                           ($syntax-dispatch
                                                             tmp2087
                                                             '(any any
                                                                   .
                                                                   each-any)))))
                                                    ($syntax-dispatch
                                                      tmp2087
                                                      '(any #(free-id
                                                              #(syntax-object => ((top) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ m1 m2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ()))))
                                                            any)))))
                                             ($syntax-dispatch
                                               tmp2087
                                               '(any))))
                                          clause2068))
                                       tmp2085))
                                    (f2066
                                      (car clauses2067)
                                      (cdr clauses2067)))))))
                     f2066)
                   m12063
                   m22064))
                tmp2062)
              (syntax-error tmp2061)))
        ($syntax-dispatch tmp2061 '(any any . each-any))))
     x2060)))
($sc-put-cte
  'do
  (lambda (orig-x2100)
    ((lambda (tmp2101)
       ((lambda (tmp2102)
          (if tmp2102
              (apply
                (lambda (_2109
                         var2103
                         init2108
                         step2104
                         e02107
                         e12105
                         c2106)
                  ((lambda (tmp2110)
                     ((lambda (tmp2120)
                        (if tmp2120
                            (apply
                              (lambda (step2121)
                                ((lambda (tmp2122)
                                   ((lambda (tmp2124)
                                      (if tmp2124
                                          (apply
                                            (lambda ()
                                              (list '#(syntax-object let ((top) #(ribcage #(step) #((top)) #("i")) #(ribcage #(_ var init step e0 e1 c) #((top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(orig-x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                    '#(syntax-object doloop ((top) #(ribcage #(step) #((top)) #("i")) #(ribcage #(_ var init step e0 e1 c) #((top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(orig-x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                    (map list
                                                         var2103
                                                         init2108)
                                                    (list '#(syntax-object if ((top) #(ribcage #(step) #((top)) #("i")) #(ribcage #(_ var init step e0 e1 c) #((top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(orig-x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                          (list '#(syntax-object not ((top) #(ribcage #(step) #((top)) #("i")) #(ribcage #(_ var init step e0 e1 c) #((top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(orig-x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                e02107)
                                                          (cons '#(syntax-object begin ((top) #(ribcage #(step) #((top)) #("i")) #(ribcage #(_ var init step e0 e1 c) #((top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(orig-x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                (append
                                                                  c2106
                                                                  (list (cons '#(syntax-object doloop ((top) #(ribcage #(step) #((top)) #("i")) #(ribcage #(_ var init step e0 e1 c) #((top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(orig-x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                              step2121)))))))
                                            tmp2124)
                                          ((lambda (tmp2129)
                                             (if tmp2129
                                                 (apply
                                                   (lambda (e12131 e22130)
                                                     (list '#(syntax-object let ((top) #(ribcage #(e1 e2) #((top) (top)) #("i" "i")) #(ribcage #(step) #((top)) #("i")) #(ribcage #(_ var init step e0 e1 c) #((top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(orig-x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                           '#(syntax-object doloop ((top) #(ribcage #(e1 e2) #((top) (top)) #("i" "i")) #(ribcage #(step) #((top)) #("i")) #(ribcage #(_ var init step e0 e1 c) #((top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(orig-x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                           (map list
                                                                var2103
                                                                init2108)
                                                           (list '#(syntax-object if ((top) #(ribcage #(e1 e2) #((top) (top)) #("i" "i")) #(ribcage #(step) #((top)) #("i")) #(ribcage #(_ var init step e0 e1 c) #((top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(orig-x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                 e02107
                                                                 (cons '#(syntax-object begin ((top) #(ribcage #(e1 e2) #((top) (top)) #("i" "i")) #(ribcage #(step) #((top)) #("i")) #(ribcage #(_ var init step e0 e1 c) #((top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(orig-x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                       (cons e12131
                                                                             e22130))
                                                                 (cons '#(syntax-object begin ((top) #(ribcage #(e1 e2) #((top) (top)) #("i" "i")) #(ribcage #(step) #((top)) #("i")) #(ribcage #(_ var init step e0 e1 c) #((top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(orig-x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                       (append
                                                                         c2106
                                                                         (list (cons '#(syntax-object doloop ((top) #(ribcage #(e1 e2) #((top) (top)) #("i" "i")) #(ribcage #(step) #((top)) #("i")) #(ribcage #(_ var init step e0 e1 c) #((top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(orig-x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                                     step2121)))))))
                                                   tmp2129)
                                                 (syntax-error tmp2122)))
                                           ($syntax-dispatch
                                             tmp2122
                                             '(any . each-any)))))
                                    ($syntax-dispatch tmp2122 '())))
                                 e12105))
                              tmp2120)
                            (syntax-error tmp2110)))
                      ($syntax-dispatch tmp2110 'each-any)))
                   (map (lambda (v2114 s2113)
                          ((lambda (tmp2115)
                             ((lambda (tmp2116)
                                (if tmp2116
                                    (apply (lambda () v2114) tmp2116)
                                    ((lambda (tmp2117)
                                       (if tmp2117
                                           (apply
                                             (lambda (e2118) e2118)
                                             tmp2117)
                                           ((lambda (_2119)
                                              (syntax-error orig-x2100))
                                            tmp2115)))
                                     ($syntax-dispatch tmp2115 '(any)))))
                              ($syntax-dispatch tmp2115 '())))
                           s2113))
                        var2103
                        step2104)))
                tmp2102)
              (syntax-error tmp2101)))
        ($syntax-dispatch
          tmp2101
          '(any #(each (any any . any))
                (any . each-any)
                .
                each-any))))
     orig-x2100)))
($sc-put-cte
  'quasiquote
  (letrec ((isquote?2145
            (lambda (x2257)
              (if (identifier? x2257)
                  (free-identifier=?
                    x2257
                    '#(syntax-object quote ((top) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()))))
                  '#f)))
           (islist?2137
            (lambda (x2151)
              (if (identifier? x2151)
                  (free-identifier=?
                    x2151
                    '#(syntax-object list ((top) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()))))
                  '#f)))
           (iscons?2144
            (lambda (x2256)
              (if (identifier? x2256)
                  (free-identifier=?
                    x2256
                    '#(syntax-object cons ((top) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()))))
                  '#f)))
           (quote-nil?2138
            (lambda (x2152)
              ((lambda (tmp2153)
                 ((lambda (tmp2154)
                    (if tmp2154
                        (apply
                          (lambda (quote?2155) (isquote?2145 quote?2155))
                          tmp2154)
                        ((lambda (_2156) '#f) tmp2153)))
                  ($syntax-dispatch tmp2153 '(any ()))))
               x2152)))
           (quasilist*2143
            (lambda (x2253 y2252)
              ((letrec ((f2254
                         (lambda (x2255)
                           (if (null? x2255)
                               y2252
                               (quasicons2139
                                 (car x2255)
                                 (f2254 (cdr x2255)))))))
                 f2254)
               x2253)))
           (quasicons2139
            (lambda (x2158 y2157)
              ((lambda (tmp2159)
                 ((lambda (tmp2160)
                    (if tmp2160
                        (apply
                          (lambda (x2162 y2161)
                            ((lambda (tmp2163)
                               ((lambda (tmp2164)
                                  (if (if tmp2164
                                          (apply
                                            (lambda (quote?2166 dy2165)
                                              (isquote?2145 quote?2166))
                                            tmp2164)
                                          '#f)
                                      (apply
                                        (lambda (quote?2168 dy2167)
                                          ((lambda (tmp2169)
                                             ((lambda (tmp2170)
                                                (if (if tmp2170
                                                        (apply
                                                          (lambda (quote?2172
                                                                   dx2171)
                                                            (isquote?2145
                                                              quote?2172))
                                                          tmp2170)
                                                        '#f)
                                                    (apply
                                                      (lambda (quote?2174
                                                               dx2173)
                                                        (list '#(syntax-object quote ((top) #(ribcage #(quote? dx) #((top) (top)) #("i" "i")) #(ribcage #(quote? dy) #((top) (top)) #("i" "i")) #(ribcage #(x y) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x y) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                                                              (cons dx2173
                                                                    dy2167)))
                                                      tmp2170)
                                                    ((lambda (_2175)
                                                       (if (null? dy2167)
                                                           (list '#(syntax-object list ((top) #(ribcage #(_) #((top)) #("i")) #(ribcage #(quote? dy) #((top) (top)) #("i" "i")) #(ribcage #(x y) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x y) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                                                                 x2162)
                                                           (list '#(syntax-object cons ((top) #(ribcage #(_) #((top)) #("i")) #(ribcage #(quote? dy) #((top) (top)) #("i" "i")) #(ribcage #(x y) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x y) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                                                                 x2162
                                                                 y2161)))
                                                     tmp2169)))
                                              ($syntax-dispatch
                                                tmp2169
                                                '(any any))))
                                           x2162))
                                        tmp2164)
                                      ((lambda (tmp2176)
                                         (if (if tmp2176
                                                 (apply
                                                   (lambda (listp2178
                                                            stuff2177)
                                                     (islist?2137
                                                       listp2178))
                                                   tmp2176)
                                                 '#f)
                                             (apply
                                               (lambda (listp2180
                                                        stuff2179)
                                                 (cons '#(syntax-object list ((top) #(ribcage #(listp stuff) #((top) (top)) #("i" "i")) #(ribcage #(x y) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x y) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                                                       (cons x2162
                                                             stuff2179)))
                                               tmp2176)
                                             ((lambda (else2181)
                                                (list '#(syntax-object cons ((top) #(ribcage #(else) #((top)) #("i")) #(ribcage #(x y) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x y) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                                                      x2162
                                                      y2161))
                                              tmp2163)))
                                       ($syntax-dispatch
                                         tmp2163
                                         '(any . any)))))
                                ($syntax-dispatch tmp2163 '(any any))))
                             y2161))
                          tmp2160)
                        (syntax-error tmp2159)))
                  ($syntax-dispatch tmp2159 '(any any))))
               (list x2158 y2157))))
           (quasiappend2142
            (lambda (x2244 y2243)
              ((lambda (ls2245)
                 (if (null? ls2245)
                     '#(syntax-object (quote ()) ((top) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(ls) #((top)) #("i")) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x y) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                     (if (null? (cdr ls2245))
                         (car ls2245)
                         ((lambda (tmp2246)
                            ((lambda (tmp2247)
                               (if tmp2247
                                   (apply
                                     (lambda (p2248)
                                       (cons '#(syntax-object append ((top) #(ribcage #(p) #((top)) #("i")) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(ls) #((top)) #("i")) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x y) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                                             p2248))
                                     tmp2247)
                                   (syntax-error tmp2246)))
                             ($syntax-dispatch tmp2246 'each-any)))
                          ls2245))))
               ((letrec ((f2250
                          (lambda (x2251)
                            (if (null? x2251)
                                (if (quote-nil?2138 y2243)
                                    '()
                                    (list y2243))
                                (if (quote-nil?2138 (car x2251))
                                    (f2250 (cdr x2251))
                                    (cons (car x2251)
                                          (f2250 (cdr x2251))))))))
                  f2250)
                x2244))))
           (quasivector2140
            (lambda (x2182)
              ((lambda (tmp2183)
                 ((lambda (pat-x2184)
                    ((lambda (tmp2185)
                       ((lambda (tmp2186)
                          (if (if tmp2186
                                  (apply
                                    (lambda (quote?2188 x2187)
                                      (isquote?2145 quote?2188))
                                    tmp2186)
                                  '#f)
                              (apply
                                (lambda (quote?2190 x2189)
                                  (list '#(syntax-object quote ((top) #(ribcage #(quote? x) #((top) (top)) #("i" "i")) #(ribcage #(pat-x) #((top)) #("i")) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                                        (list->vector x2189)))
                                tmp2186)
                              ((lambda (_2192)
                                 ((letrec ((f2193
                                            (lambda (x2195 k2194)
                                              ((lambda (tmp2196)
                                                 ((lambda (tmp2197)
                                                    (if (if tmp2197
                                                            (apply
                                                              (lambda (quote?2199
                                                                       x2198)
                                                                (isquote?2145
                                                                  quote?2199))
                                                              tmp2197)
                                                            '#f)
                                                        (apply
                                                          (lambda (quote?2201
                                                                   x2200)
                                                            (k2194
                                                              (map (lambda (tmp2202)
                                                                     (list '#(syntax-object quote ((top) #(ribcage #(quote? x) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(x k) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_) #((top)) #("i")) #(ribcage #(pat-x) #((top)) #("i")) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                                                                           tmp2202))
                                                                   x2200)))
                                                          tmp2197)
                                                        ((lambda (tmp2203)
                                                           (if (if tmp2203
                                                                   (apply
                                                                     (lambda (listp2205
                                                                              x2204)
                                                                       (islist?2137
                                                                         listp2205))
                                                                     tmp2203)
                                                                   '#f)
                                                               (apply
                                                                 (lambda (listp2207
                                                                          x2206)
                                                                   (k2194
                                                                     x2206))
                                                                 tmp2203)
                                                               ((lambda (tmp2209)
                                                                  (if (if tmp2209
                                                                          (apply
                                                                            (lambda (cons?2212
                                                                                     x2210
                                                                                     y2211)
                                                                              (iscons?2144
                                                                                cons?2212))
                                                                            tmp2209)
                                                                          '#f)
                                                                      (apply
                                                                        (lambda (cons?2215
                                                                                 x2213
                                                                                 y2214)
                                                                          (f2193
                                                                            y2214
                                                                            (lambda (ls2216)
                                                                              (k2194
                                                                                (cons x2213
                                                                                      ls2216)))))
                                                                        tmp2209)
                                                                      ((lambda (else2217)
                                                                         (list '#(syntax-object list->vector ((top) #(ribcage #(else) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(x k) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_) #((top)) #("i")) #(ribcage #(pat-x) #((top)) #("i")) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                                                                               pat-x2184))
                                                                       tmp2196)))
                                                                ($syntax-dispatch
                                                                  tmp2196
                                                                  '(any any
                                                                        any)))))
                                                         ($syntax-dispatch
                                                           tmp2196
                                                           '(any .
                                                                 each-any)))))
                                                  ($syntax-dispatch
                                                    tmp2196
                                                    '(any each-any))))
                                               x2195))))
                                    f2193)
                                  x2182
                                  (lambda (ls2218)
                                    (cons '#(syntax-object vector ((top) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(ls) #((top)) #("i")) #(ribcage #(_) #((top)) #("i")) #(ribcage #(pat-x) #((top)) #("i")) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                                          ls2218))))
                               tmp2185)))
                        ($syntax-dispatch tmp2185 '(any each-any))))
                     pat-x2184))
                  tmp2183))
               x2182)))
           (quasi2141
            (lambda (p2220 lev2219)
              ((lambda (tmp2221)
                 ((lambda (tmp2222)
                    (if tmp2222
                        (apply
                          (lambda (p2223)
                            (if (= lev2219 '0)
                                p2223
                                (quasicons2139
                                  '#(syntax-object (quote unquote) ((top) #(ribcage #(p) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(p lev) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                                  (quasi2141
                                    (list p2223)
                                    (- lev2219 '1)))))
                          tmp2222)
                        ((lambda (tmp2224)
                           (if tmp2224
                               (apply
                                 (lambda (p2226 q2225)
                                   (if (= lev2219 '0)
                                       (quasilist*2143
                                         p2226
                                         (quasi2141 q2225 lev2219))
                                       (quasicons2139
                                         (quasicons2139
                                           '#(syntax-object (quote unquote) ((top) #(ribcage #(p q) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(p lev) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                                           (quasi2141
                                             p2226
                                             (- lev2219 '1)))
                                         (quasi2141 q2225 lev2219))))
                                 tmp2224)
                               ((lambda (tmp2229)
                                  (if tmp2229
                                      (apply
                                        (lambda (p2231 q2230)
                                          (if (= lev2219 '0)
                                              (quasiappend2142
                                                p2231
                                                (quasi2141 q2230 lev2219))
                                              (quasicons2139
                                                (quasicons2139
                                                  '#(syntax-object (quote unquote-splicing) ((top) #(ribcage #(p q) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(p lev) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                                                  (quasi2141
                                                    p2231
                                                    (- lev2219 '1)))
                                                (quasi2141
                                                  q2230
                                                  lev2219))))
                                        tmp2229)
                                      ((lambda (tmp2234)
                                         (if tmp2234
                                             (apply
                                               (lambda (p2235)
                                                 (quasicons2139
                                                   '#(syntax-object (quote quasiquote) ((top) #(ribcage #(p) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(p lev) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                                                   (quasi2141
                                                     (list p2235)
                                                     (+ lev2219 '1))))
                                               tmp2234)
                                             ((lambda (tmp2236)
                                                (if tmp2236
                                                    (apply
                                                      (lambda (p2238 q2237)
                                                        (quasicons2139
                                                          (quasi2141
                                                            p2238
                                                            lev2219)
                                                          (quasi2141
                                                            q2237
                                                            lev2219)))
                                                      tmp2236)
                                                    ((lambda (tmp2239)
                                                       (if tmp2239
                                                           (apply
                                                             (lambda (x2240)
                                                               (quasivector2140
                                                                 (quasi2141
                                                                   x2240
                                                                   lev2219)))
                                                             tmp2239)
                                                           ((lambda (p2242)
                                                              (list '#(syntax-object quote ((top) #(ribcage #(p) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(p lev) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ())))
                                                                    p2242))
                                                            tmp2221)))
                                                     ($syntax-dispatch
                                                       tmp2221
                                                       '#(vector
                                                          each-any)))))
                                              ($syntax-dispatch
                                                tmp2221
                                                '(any . any)))))
                                       ($syntax-dispatch
                                         tmp2221
                                         '(#(free-id
                                             #(syntax-object quasiquote ((top) #(ribcage () () ()) #(ribcage #(p lev) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()))))
                                            any)))))
                                ($syntax-dispatch
                                  tmp2221
                                  '((#(free-id
                                       #(syntax-object unquote-splicing ((top) #(ribcage () () ()) #(ribcage #(p lev) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()))))
                                      .
                                      each-any)
                                    .
                                    any)))))
                         ($syntax-dispatch
                           tmp2221
                           '((#(free-id
                                #(syntax-object unquote ((top) #(ribcage () () ()) #(ribcage #(p lev) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()))))
                               .
                               each-any)
                             .
                             any)))))
                  ($syntax-dispatch
                    tmp2221
                    '(#(free-id
                        #(syntax-object unquote ((top) #(ribcage () () ()) #(ribcage #(p lev) #((top) (top)) #("i" "i")) #(ribcage #(isquote? islist? iscons? quote-nil? quasilist* quasicons quasiappend quasivector quasi) #((top) (top) (top) (top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i" "i" "i" "i")) #(ribcage (#(import-token *top*)) () ()))))
                       any))))
               p2220))))
    (lambda (x2146)
      ((lambda (tmp2147)
         ((lambda (tmp2148)
            (if tmp2148
                (apply (lambda (_2150 e2149) (quasi2141 e2149 '0)) tmp2148)
                (syntax-error tmp2147)))
          ($syntax-dispatch tmp2147 '(any any))))
       x2146))))
($sc-put-cte
  'include
  (lambda (x2258)
    (letrec ((read-file2259
              (lambda (fn2270 k2269)
                ((lambda (p2271)
                   ((letrec ((f2272
                              (lambda ()
                                ((lambda (x2273)
                                   (if (eof-object? x2273)
                                       (begin (close-input-port p2271) '())
                                       (cons (datum->syntax-object
                                               k2269
                                               x2273)
                                             (f2272))))
                                 (read p2271)))))
                      f2272)))
                 (open-input-file fn2270)))))
      ((lambda (tmp2260)
         ((lambda (tmp2261)
            (if tmp2261
                (apply
                  (lambda (k2263 filename2262)
                    ((lambda (fn2264)
                       ((lambda (tmp2265)
                          ((lambda (tmp2266)
                             (if tmp2266
                                 (apply
                                   (lambda (exp2267)
                                     (cons '#(syntax-object begin ((top) #(ribcage #(exp) #((top)) #("i")) #(ribcage () () ()) #(ribcage () () ()) #(ribcage #(fn) #((top)) #("i")) #(ribcage #(k filename) #((top) (top)) #("i" "i")) #(ribcage (read-file) ((top)) ("i")) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                           exp2267))
                                   tmp2266)
                                 (syntax-error tmp2265)))
                           ($syntax-dispatch tmp2265 'each-any)))
                        (read-file2259 fn2264 k2263)))
                     (syntax-object->datum filename2262)))
                  tmp2261)
                (syntax-error tmp2260)))
          ($syntax-dispatch tmp2260 '(any any))))
       x2258))))
($sc-put-cte
  'unquote
  (lambda (x2274)
    ((lambda (tmp2275)
       ((lambda (tmp2276)
          (if tmp2276
              (apply
                (lambda (_2278 e2277)
                  (syntax-error
                    x2274
                    '"expression not valid outside of quasiquote"))
                tmp2276)
              (syntax-error tmp2275)))
        ($syntax-dispatch tmp2275 '(any . each-any))))
     x2274)))
($sc-put-cte
  'unquote-splicing
  (lambda (x2279)
    ((lambda (tmp2280)
       ((lambda (tmp2281)
          (if tmp2281
              (apply
                (lambda (_2283 e2282)
                  (syntax-error
                    x2279
                    '"expression not valid outside of quasiquote"))
                tmp2281)
              (syntax-error tmp2280)))
        ($syntax-dispatch tmp2280 '(any . each-any))))
     x2279)))
($sc-put-cte
  'case
  (lambda (x2284)
    ((lambda (tmp2285)
       ((lambda (tmp2286)
          (if tmp2286
              (apply
                (lambda (_2290 e2287 m12289 m22288)
                  ((lambda (tmp2291)
                     ((lambda (body2318)
                        (list '#(syntax-object let ((top) #(ribcage #(body) #((top)) #("i")) #(ribcage #(_ e m1 m2) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                              (list (list '#(syntax-object t ((top) #(ribcage #(body) #((top)) #("i")) #(ribcage #(_ e m1 m2) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                          e2287))
                              body2318))
                      tmp2291))
                   ((letrec ((f2292
                              (lambda (clause2294 clauses2293)
                                (if (null? clauses2293)
                                    ((lambda (tmp2295)
                                       ((lambda (tmp2296)
                                          (if tmp2296
                                              (apply
                                                (lambda (e12298 e22297)
                                                  (cons '#(syntax-object begin ((top) #(ribcage #(e1 e2) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ e m1 m2) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                        (cons e12298
                                                              e22297)))
                                                tmp2296)
                                              ((lambda (tmp2300)
                                                 (if tmp2300
                                                     (apply
                                                       (lambda (k2303
                                                                e12301
                                                                e22302)
                                                         (list '#(syntax-object if ((top) #(ribcage #(k e1 e2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ e m1 m2) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                               (list '#(syntax-object memv ((top) #(ribcage #(k e1 e2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ e m1 m2) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                     '#(syntax-object t ((top) #(ribcage #(k e1 e2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ e m1 m2) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                     (list '#(syntax-object quote ((top) #(ribcage #(k e1 e2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ e m1 m2) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                           k2303))
                                                               (cons '#(syntax-object begin ((top) #(ribcage #(k e1 e2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ e m1 m2) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                     (cons e12301
                                                                           e22302))))
                                                       tmp2300)
                                                     ((lambda (_2306)
                                                        (syntax-error
                                                          x2284))
                                                      tmp2295)))
                                               ($syntax-dispatch
                                                 tmp2295
                                                 '(each-any
                                                    any
                                                    .
                                                    each-any)))))
                                        ($syntax-dispatch
                                          tmp2295
                                          '(#(free-id
                                              #(syntax-object else ((top) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ e m1 m2) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ()))))
                                             any
                                             .
                                             each-any))))
                                     clause2294)
                                    ((lambda (tmp2307)
                                       ((lambda (rest2308)
                                          ((lambda (tmp2309)
                                             ((lambda (tmp2310)
                                                (if tmp2310
                                                    (apply
                                                      (lambda (k2313
                                                               e12311
                                                               e22312)
                                                        (list '#(syntax-object if ((top) #(ribcage #(k e1 e2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ e m1 m2) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                              (list '#(syntax-object memv ((top) #(ribcage #(k e1 e2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ e m1 m2) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                    '#(syntax-object t ((top) #(ribcage #(k e1 e2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ e m1 m2) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                    (list '#(syntax-object quote ((top) #(ribcage #(k e1 e2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ e m1 m2) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                          k2313))
                                                              (cons '#(syntax-object begin ((top) #(ribcage #(k e1 e2) #((top) (top) (top)) #("i" "i" "i")) #(ribcage #(rest) #((top)) #("i")) #(ribcage () () ()) #(ribcage #(clause clauses) #((top) (top)) #("i" "i")) #(ribcage #(f) #((top)) #("i")) #(ribcage #(_ e m1 m2) #((top) (top) (top) (top)) #("i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                    (cons e12311
                                                                          e22312))
                                                              rest2308))
                                                      tmp2310)
                                                    ((lambda (_2316)
                                                       (syntax-error
                                                         x2284))
                                                     tmp2309)))
                                              ($syntax-dispatch
                                                tmp2309
                                                '(each-any
                                                   any
                                                   .
                                                   each-any))))
                                           clause2294))
                                        tmp2307))
                                     (f2292
                                       (car clauses2293)
                                       (cdr clauses2293)))))))
                      f2292)
                    m12289
                    m22288)))
                tmp2286)
              (syntax-error tmp2285)))
        ($syntax-dispatch tmp2285 '(any any any . each-any))))
     x2284)))
($sc-put-cte
  'identifier-syntax
  (lambda (x2319)
    ((lambda (tmp2320)
       ((lambda (tmp2321)
          (if tmp2321
              (apply
                (lambda (_2323 e2322)
                  (list '#(syntax-object lambda ((top) #(ribcage #(_ e) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                        '#(syntax-object (x) ((top) #(ribcage #(_ e) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                        (list '#(syntax-object syntax-case ((top) #(ribcage #(_ e) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                              '#(syntax-object x ((top) #(ribcage #(_ e) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                              '()
                              (list '#(syntax-object id ((top) #(ribcage #(_ e) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                    '#(syntax-object (identifier? (syntax id)) ((top) #(ribcage #(_ e) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                    (list '#(syntax-object syntax ((top) #(ribcage #(_ e) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                          e2322))
                              (list (cons _2323
                                          '(#(syntax-object x ((top) #(ribcage #(_ e) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                             #(syntax-object ... ((top) #(ribcage #(_ e) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))))
                                    (list '#(syntax-object syntax ((top) #(ribcage #(_ e) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                          (cons e2322
                                                '(#(syntax-object x ((top) #(ribcage #(_ e) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                   #(syntax-object ... ((top) #(ribcage #(_ e) #((top) (top)) #("i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ()))))))))))
                tmp2321)
              ((lambda (tmp2324)
                 (if (if tmp2324
                         (apply
                           (lambda (_2330
                                    id2325
                                    exp12329
                                    var2326
                                    val2328
                                    exp22327)
                             (if (identifier? id2325)
                                 (identifier? var2326)
                                 '#f))
                           tmp2324)
                         '#f)
                     (apply
                       (lambda (_2336
                                id2331
                                exp12335
                                var2332
                                val2334
                                exp22333)
                         (list '#(syntax-object cons ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                               '#(syntax-object (quote macro!) ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                               (list '#(syntax-object lambda ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                     '#(syntax-object (x) ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                     (list '#(syntax-object syntax-case ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                           '#(syntax-object x ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                           '#(syntax-object (set!) ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                           (list (list '#(syntax-object set! ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                       var2332
                                                       val2334)
                                                 (list '#(syntax-object syntax ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                       exp22333))
                                           (list (cons id2331
                                                       '(#(syntax-object x ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                          #(syntax-object ... ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))))
                                                 (list '#(syntax-object syntax ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                       (cons exp12335
                                                             '(#(syntax-object x ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                                #(syntax-object ... ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))))))
                                           (list id2331
                                                 (list '#(syntax-object identifier? ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                       (list '#(syntax-object syntax ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                             id2331))
                                                 (list '#(syntax-object syntax ((top) #(ribcage #(_ id exp1 var val exp2) #((top) (top) (top) (top) (top) (top)) #("i" "i" "i" "i" "i" "i")) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ())))
                                                       exp12335))))))
                       tmp2324)
                     (syntax-error tmp2320)))
               ($syntax-dispatch
                 tmp2320
                 '(any (any any)
                       ((#(free-id
                           #(syntax-object set! ((top) #(ribcage () () ()) #(ribcage #(x) #((top)) #("i")) #(ribcage (#(import-token *top*)) () ()))))
                          any
                          any)
                        any))))))
        ($syntax-dispatch tmp2320 '(any any))))
     x2319)))
